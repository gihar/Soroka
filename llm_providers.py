"""
–ú–æ–¥—É–ª—å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
"""

import json
import asyncio
import httpx
from abc import ABC, abstractmethod
from typing import Dict, Any, Optional, Tuple, List, TYPE_CHECKING
from loguru import logger
from config import settings

import openai
from anthropic import Anthropic

# –ò–º–ø–æ—Ä—Ç –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
from src.services.meeting_classifier import meeting_classifier
from src.prompts.specialized_prompts import (
    get_specialized_system_prompt, 
    get_specialized_extraction_instructions
)

# –ò–º–ø–æ—Ä—Ç –¥–ª—è retry –ª–æ–≥–∏–∫–∏
from src.reliability.retry import RetryManager, LLM_RETRY_CONFIG

# –ò–º–ø–æ—Ä—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π
from src.exceptions.processing import LLMInsufficientCreditsError

# –ò–º–ø–æ—Ä—Ç JSON Schema –¥–ª—è structured outputs
from src.models.llm_schemas import (
    PROTOCOL_SCHEMA, TWO_STAGE_EXTRACTION_SCHEMA, TWO_STAGE_REFLECTION_SCHEMA,
    SEGMENT_SCHEMA, SYNTHESIS_SCHEMA
)

# –ò–º–ø–æ—Ä—Ç —É—Ç–∏–ª–∏—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
from src.utils.context_extraction import (
    extract_relevant_excerpts,
    build_structure_summary,
    add_prompt_caching_markers
)

if TYPE_CHECKING:
    from src.services.segmentation_service import TranscriptionSegment


# -------------------------------------------------------------
# –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
# -------------------------------------------------------------
def safe_json_parse(content: str, context: str = "LLM response") -> Dict[str, Any]:
    """
    –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ JSON —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö edge cases.
    
    Args:
        content: –°—Ç—Ä–æ–∫–∞ —Å JSON –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
        context: –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "OpenAI response")
        
    Returns:
        –†–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–π JSON —Å–ª–æ–≤–∞—Ä—å
        
    Raises:
        ValueError: –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
    """
    if not content or not content.strip():
        raise ValueError(f"–ü–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –≤ {context}")
    
    original_content = content
    content_length = len(content)
    
    # –®–∞–≥ 1: –£–¥–∞–ª—è–µ–º BOM (Byte Order Mark) –∏ –Ω–µ–≤–∏–¥–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã
    content = content.strip()
    if content.startswith('\ufeff'):
        content = content[1:]
        logger.debug(f"–£–¥–∞–ª–µ–Ω BOM –∏–∑ {context}")
    
    # –®–∞–≥ 2: –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä—è–º–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
    try:
        result = json.loads(content)
        logger.debug(f"–ü—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥ JSON —É—Å–ø–µ—à–µ–Ω –¥–ª—è {context}")
        return result
    except json.JSONDecodeError as e:
        logger.warning(f"–ü—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥ JSON –Ω–µ —É–¥–∞–ª—Å—è –¥–ª—è {context}: {e}")
    
    # –®–∞–≥ 3: –£–¥–∞–ª—è–µ–º markdown –±–ª–æ–∫–∏ (```json ... ``` –∏–ª–∏ ``` ... ```)
    import re
    markdown_pattern = r'```(?:json)?\s*\n?(.*?)\n?```'
    markdown_match = re.search(markdown_pattern, content, re.DOTALL)
    if markdown_match:
        content = markdown_match.group(1).strip()
        logger.debug(f"–ò–∑–≤–ª–µ—á–µ–Ω JSON –∏–∑ markdown –±–ª–æ–∫–∞ –≤ {context}")
        try:
            result = json.loads(content)
            logger.info(f"–ü–∞—Ä—Å–∏–Ω–≥ JSON –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è markdown —É—Å–ø–µ—à–µ–Ω –¥–ª—è {context}")
            return result
        except json.JSONDecodeError as e:
            logger.warning(f"–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è markdown –Ω–µ —É–¥–∞–ª—Å—è –¥–ª—è {context}: {e}")
    
    # –®–∞–≥ 4: –ò—â–µ–º JSON –æ–±—ä–µ–∫—Ç –≤ —Ç–µ–∫—Å—Ç–µ (–º–µ–∂–¥—É –ø–µ—Ä–≤–æ–π { –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π })
    start_idx = content.find('{')
    end_idx = content.rfind('}') + 1
    
    if start_idx != -1 and end_idx > start_idx:
        json_str = content[start_idx:end_idx]
        logger.debug(f"–ò–∑–≤–ª–µ—á–µ–Ω JSON –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ {start_idx} –¥–æ {end_idx} –≤ {context}")
        try:
            result = json.loads(json_str)
            logger.info(f"–ü–∞—Ä—Å–∏–Ω–≥ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ JSON —É—Å–ø–µ—à–µ–Ω –¥–ª—è {context}")
            return result
        except json.JSONDecodeError as e:
            logger.warning(f"–ü–∞—Ä—Å–∏–Ω–≥ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ JSON –Ω–µ —É–¥–∞–ª—Å—è –¥–ª—è {context}: {e}")
    
    # –®–∞–≥ 5: –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ JSON –º–∞—Å—Å–∏–≤ (–º–µ–∂–¥—É –ø–µ—Ä–≤–æ–π [ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π ])
    start_idx = content.find('[')
    end_idx = content.rfind(']') + 1
    
    if start_idx != -1 and end_idx > start_idx:
        json_str = content[start_idx:end_idx]
        logger.debug(f"–ò–∑–≤–ª–µ—á–µ–Ω JSON –º–∞—Å—Å–∏–≤ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ {start_idx} –¥–æ {end_idx} –≤ {context}")
        try:
            result = json.loads(json_str)
            logger.info(f"–ü–∞—Ä—Å–∏–Ω–≥ JSON –º–∞—Å—Å–∏–≤–∞ —É—Å–ø–µ—à–µ–Ω –¥–ª—è {context}")
            return result
        except json.JSONDecodeError as e:
            logger.warning(f"–ü–∞—Ä—Å–∏–Ω–≥ JSON –º–∞—Å—Å–∏–≤–∞ –Ω–µ —É–¥–∞–ª—Å—è –¥–ª—è {context}: {e}")
    
    # –®–∞–≥ 6: –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ - —É–¥–∞–ª—è–µ–º –≤—Å–µ –¥–æ –ø–µ—Ä–≤–æ–π { –∏ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π }
    # –∏ –ø—ã—Ç–∞–µ–º—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å common issues
    try:
        # –£–¥–∞–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å—Ç–∏–ª–µ // –∏ /* */
        content_no_comments = re.sub(r'//.*?$', '', content, flags=re.MULTILINE)
        content_no_comments = re.sub(r'/\*.*?\*/', '', content_no_comments, flags=re.DOTALL)
        
        # –£–¥–∞–ª—è–µ–º trailing commas
        content_no_comments = re.sub(r',(\s*[}\]])', r'\1', content_no_comments)
        
        result = json.loads(content_no_comments)
        logger.info(f"–ü–∞—Ä—Å–∏–Ω–≥ JSON –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —É—Å–ø–µ—à–µ–Ω –¥–ª—è {context}")
        return result
    except json.JSONDecodeError:
        pass
    
    # –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã - –ª–æ–≥–∏—Ä—É–µ–º –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
    logger.error(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –≤ {context}")
    logger.error(f"–î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞: {content_length} —Å–∏–º–≤–æ–ª–æ–≤")
    logger.error(f"–ü–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤: {original_content[:500]}")
    logger.error(f"–ü–æ—Å–ª–µ–¥–Ω–∏–µ 500 —Å–∏–º–≤–æ–ª–æ–≤: {original_content[-500:] if len(original_content) > 500 else ''}")
    
    # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –æ—à–∏–±–∫–∏
    try:
        json.loads(original_content)
    except json.JSONDecodeError as final_error:
        error_pos = getattr(final_error, 'pos', None)
        if error_pos and error_pos < len(original_content):
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ –æ—à–∏–±–∫–∏
            start = max(0, error_pos - 50)
            end = min(len(original_content), error_pos + 50)
            context_str = original_content[start:end]
            logger.error(f"–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ (–ø–æ–∑–∏—Ü–∏—è {error_pos}): ...{context_str}...")
        
        raise ValueError(
            f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –≤ {context}: {final_error}. "
            f"–î–ª–∏–Ω–∞: {content_length} —Å–∏–º–≤–æ–ª–æ–≤. "
            f"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π."
        )
    
    raise ValueError(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –≤ {context}. –î–ª–∏–Ω–∞: {content_length} —Å–∏–º–≤–æ–ª–æ–≤.")


# -------------------------------------------------------------
# –°–ª–æ–≤–∞—Ä—å —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π —à–∞–±–ª–æ–Ω–∞
# -------------------------------------------------------------
FIELD_SPECIFIC_RULES: Dict[str, str] = {
    "participants": """üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ (participants):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª—é–¥–µ–π, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–≤—à–∏—Ö –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞–≤—à–∏—Ö –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –í—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —è–≤–Ω–æ —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –æ–±—Ä–∞—â–µ–Ω–∏—è, —É–ø–æ–º–∏–Ω–∞–Ω–∏—è)
  * –ò–º–µ–Ω–∞ –∏–∑ –Ω–∞—á–∞–ª–∞ –≤—Å—Ç—Ä–µ—á–∏ (–µ—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è)
  * –ê–≤—Ç–æ—Ä–æ–≤ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞–∑–≤–∞–Ω—ã
  * –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ–±—Ä–∞—â–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –£–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü, –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ
  * –†–æ–ª–∏ –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ)
  * –û–±—â–∏–µ —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ "–∫–æ–º–∞–Ω–¥–∞", "–∫–æ–ª–ª–µ–≥–∏" –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏–º–µ–Ω
- –§–û–†–ú–ê–¢: –ö–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ \\n, —Ñ–æ—Ä–º–∞—Ç "–ò–º—è –§–∞–º–∏–ª–∏—è" –ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –ò—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –ï—Å–ª–∏ –Ω–µ—Ç - –∏–∑–≤–ª–µ–∫–∞–π –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤\\n–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: ["–ò–≤–∞–Ω", "–ú–∞—Ä–∏—è"], "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (–ú–µ–Ω–µ–¥–∂–µ—Ä)", "–ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –∏–º–µ–Ω–∞ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—ã: –∏—Å–ø–æ–ª—å–∑—É–π –º–µ—Ç–∫–∏ "–°–ø–∏–∫–µ—Ä 1\\n–°–ø–∏–∫–µ—Ä 2\\n–°–ø–∏–∫–µ—Ä 3"
  * –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ –≤ –ø–æ–ª–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π
  * –ï—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç–∞ —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è - –Ω–∞–π–¥–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤""",

    "date": """üìÖ –î–∞—Ç–∞ (date):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –∫–æ–Ω—Ü–µ –≤—Å—Ç—Ä–µ—á–∏
  * –î–∞—Ç—É –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ("—Å–µ–≥–æ–¥–Ω—è 15 –æ–∫—Ç—è–±—Ä—è", "–≤—Å—Ç—Ä–µ—á–∞ –ø—Ä–æ—à–ª–∞ 20 —á–∏—Å–ª–∞")
  * –î–∞—Ç—É –∏–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Å—Ç—Ä–µ—á–µ, –µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—ã –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ ("—Å–∫–æ—Ä–æ", "–Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ" - —ç—Ç–æ –¥–ª—è next_steps)
  * –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –¥–∞—Ç—ã –±—É–¥—É—â–∏—Ö –≤—Å—Ç—Ä–µ—á
- –§–û–†–ú–ê–¢: –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä "20 –æ–∫—Ç—è–±—Ä—è 2024" –∏–ª–∏ "15.12.2024"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "20 –æ–∫—Ç—è–±—Ä—è 2024", "15 –¥–µ–∫–∞–±—Ä—è 2024"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: {"day": 20, "month": "–æ–∫—Ç—è–±—Ä—å"}, "—Å–∫–æ—Ä–æ", "–Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ"
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –¥–∞—Ç–∞ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç–∞ —è–≤–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–π –¥–∞—Ç—É –∏–∑ meeting_date, –µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞
  * –°–æ—Ö—Ä–∞–Ω—è–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏""",

    "time": """üïê –í—Ä–µ–º—è (time):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞/–æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å—Ç—Ä–µ—á–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –≤—Å—Ç—Ä–µ—á–∏ (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç–æ)
  * –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç–æ)
  * –î–∏–∞–ø–∞–∑–æ–Ω –≤—Ä–µ–º–µ–Ω–∏ ("—Å 14:00 –¥–æ 15:30")
  * –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ("–≤—Å—Ç—Ä–µ—á–∞ –¥–ª–∏–ª–∞—Å—å 1,5 —á–∞—Å–∞")
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ü–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –≤—Ä–µ–º—è –±—É–¥—É—â–∏—Ö –≤—Å—Ç—Ä–µ—á
  * –í—Ä–µ–º—è –¥–µ–¥–ª–∞–π–Ω–æ–≤ –∑–∞–¥–∞—á
- –§–û–†–ú–ê–¢: –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä "14:30" –∏–ª–∏ "—Å 14:00 –¥–æ 15:30"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "14:30", "—Å 14:00 –¥–æ 15:30", "1,5 —á–∞—Å–∞"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: {"start": "14:00", "end": "15:30"}, "–ø–æ—Å–ª–µ –æ–±–µ–¥–∞"
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ —É–ø–æ–º—è–Ω—É—Ç–æ - –∏—Å–ø–æ–ª—å–∑—É–π –≤—Ä–µ–º—è –∏–∑ meeting_time, –µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
  * –°–æ—Ö—Ä–∞–Ω—è–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ""",

    "agenda": """üìã –ü–æ–≤–µ—Å—Ç–∫–∞ –¥–Ω—è (agenda):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ç–µ–º—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –¢–µ–º—ã, –∑–∞—è–≤–ª–µ–Ω–Ω—ã–µ –≤ –Ω–∞—á–∞–ª–µ –≤—Å—Ç—Ä–µ—á–∏ –∫–∞–∫ –ø–æ–≤–µ—Å—Ç–∫–∞
  * –í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å –æ–±—Å—É–¥–∏—Ç—å
  * –ü—É–Ω–∫—Ç—ã –ø–æ–≤–µ—Å—Ç–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –æ–∑–≤—É—á–µ–Ω—ã —è–≤–Ω–æ
  * –¶–µ–ª–∏ –≤—Å—Ç—Ä–µ—á–∏, –µ—Å–ª–∏ –æ–Ω–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –ø–ª–∞–Ω –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –¢–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å, –Ω–æ –Ω–µ –±—ã–ª–∏ –≤ –ø–æ–≤–µ—Å—Ç–∫–µ (—ç—Ç–æ –¥–ª—è discussion)
  * –°–ø–æ–Ω—Ç–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –≤–æ–∑–Ω–∏–∫—à–∏–µ –≤–æ –≤—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –û–±—Å—É–∂–¥–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º—ã\\n- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∏–Ω—Ç–∞\\n- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ü–æ–≤–µ—Å—Ç–∫–∞: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", "1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –ø–æ–≤–µ—Å—Ç–∫–∞ –Ω–µ –æ–∑–≤—É—á–µ–Ω–∞ —è–≤–Ω–æ, –Ω–æ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–º—ã - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –∫–∞–∫ –ø–æ–≤–µ—Å—Ç–∫—É
  * –°–æ—Ö—Ä–∞–Ω—è–π –ø–æ—Ä—è–¥–æ–∫ –ø—É–Ω–∫—Ç–æ–≤ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ""",

    "discussion": """üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ (discussion):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≤—Å—Ç—Ä–µ—á–∏ - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å, –≤–∫–ª—é—á–∞—è –ø–æ–∑–∏—Ü–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –ø—Ä–∏–º–µ—Ä—ã
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –í–°–ï –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –æ–±—Å—É–∂–¥–µ–Ω–∏—è –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞ –≤—Å—Ç—Ä–µ—á–∏
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –∞—Ç—Ä–∏–±—É—Ü–∏–µ–π (–ö–¢–û —á—Ç–æ —Å–∫–∞–∑–∞–ª)
  * –ò–¥–µ–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –º–Ω–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  * –ü—Ä–∏–º–µ—Ä—ã, –∫–µ–π—Å—ã, –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —É–ø–æ–º–∏–Ω–∞–ª–∏—Å—å
  * –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–ó–ê–ß–ï–ú –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å, –≤ —Ä–∞–º–∫–∞—Ö —á–µ–≥–æ)
  * –†–µ–∞–∫—Ü–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (—Å–æ–≥–ª–∞—Å–∏–µ, –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è, —É—Ç–æ—á–Ω–µ–Ω–∏—è)
  * –¶–∏—Ñ—Ä—ã, –º–µ—Ç—Ä–∏–∫–∏, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
  * –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –æ—Ç–≤–µ—Ç–∞
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ú–µ–∂–¥–æ–º–µ—Ç–∏—è, –∑–∞–ø–∏–Ω–∫–∏, –ø–æ–≤—Ç–æ—Ä—ã
  * –í–≤–æ–¥–Ω—ã–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ —Å–º—ã—Å–ª–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ("–Ω–µ —Å–ª—ã—à–Ω–æ", "–ø–æ–≤—Ç–æ—Ä–∏—Ç–µ")
  * –†–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–µ –ø–æ —Ç–µ–º–µ –≤—Å—Ç—Ä–µ—á–∏
- –§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —Ç–µ–º–∞–º. –§–æ—Ä–º–∞—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è: "–ò–º—è –ê–≤—Ç–æ—Ä–∞: —Ç–µ–∫—Å—Ç" (–±–µ–∑ —Å–ª–æ–≤–∞ "–ò–¥–µ—è", –±–µ–∑ —Å–∫–æ–±–æ–∫)
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∑—ã–≤–∞–π –∞–≤—Ç–æ—Ä–∞ –∫–∞–∂–¥–æ–≥–æ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –∏–º–µ–Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã). –§–æ—Ä–º–∞—Ç: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã"
- –°–¢–†–£–ö–¢–£–†–ê:
  * –ì—Ä—É–ø–ø–∏—Ä—É–π –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–∞–º/–∫–ª–∞—Å—Ç–µ—Ä–∞–º
  * –ù–ï –ø–∏—à–∏ —Å–ª–æ–≤–æ "–ö–ª–∞—Å—Ç–µ—Ä", —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º: "‚Ä¢ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã**"
  * –ö–∞–∂–¥—É—é –∏–¥–µ—é/–≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ/–ø–æ–∑–∏—Ü–∏—é —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
  * –ú–µ–∂–¥—É —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
  ‚Ä¢ **–í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

  –ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

  –ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞: –ø–æ–¥–¥–µ—Ä–∂–∞–ª–∞ –∏–¥–µ—é, –¥–æ–±–∞–≤–∏–ª–∞ –ø—Ä–æ –≤–∞–∂–Ω–æ—Å—Ç—å API gateway

  ‚Ä¢ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

  –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤: –æ—Ç–º–µ—Ç–∏–ª –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ —Ç–µ–∫—É—â—É—é —Å–∏—Å—Ç–µ–º—É

  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
  ‚Ä¢ –ö–ª–∞—Å—Ç–µ—Ä ¬´–í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã¬ª: –ò–¥–µ—è (–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ): –ø—Ä–µ–¥–ª–æ–∂–∏–ª...
  ‚Ä¢ –û–±—Å—É–¥–∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (–±–µ–∑ –¥–µ—Ç–∞–ª–µ–π –∏ –∞—Ç—Ä–∏–±—É—Ü–∏–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ü–û–õ–ù–û–¢–ê: –ö–∞–∂–¥–∞—è —É–ø–æ–º—è–Ω—É—Ç–∞—è —Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç—Ä–∞–∂–µ–Ω–∞
  * –î–ï–¢–ê–õ–ò–ó–ê–¶–ò–Ø –ë–ï–ó –ü–û–¢–ï–†–¨: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã, —Ü–∏—Ñ—Ä—ã, –∏–º–µ–Ω–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∞–π
  * –°–û–•–†–ê–ù–ï–ù–ò–ï –ö–û–ù–¢–ï–ö–°–¢–ê: –§–∏–∫—Å–∏—Ä—É–π –Ω–µ —Ç–æ–ª—å–∫–æ –ß–¢–û —Å–∫–∞–∑–∞–Ω–æ, –Ω–æ –∏ –ö–ê–ö –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å (—Ç–æ–Ω, —É—Ä–æ–≤–µ–Ω—å —Å–æ–≥–ª–∞—Å–∏—è)
  * –•–†–û–ù–û–õ–û–ì–ò–Ø: –°–æ—Ö—Ä–∞–Ω—è–π –ø–æ—Ä—è–¥–æ–∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ç–µ–º –∫–∞–∫ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏""",

    "key_points": """‚≠ê –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã (key_points):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –í–∞–∂–Ω—ã–µ –≤—ã–≤–æ–¥—ã, –∏–Ω—Å–∞–π—Ç—ã, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤—Å—Ç—Ä–µ—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
  * –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è
  * –í–∞–∂–Ω—ã–µ —Ñ–∞–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—é—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏
  * –ö–ª—é—á–µ–≤—ã–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã
  * –ó–Ω–∞—á–∏–º—ã–µ —Ü–∏—Ñ—Ä—ã, –º–µ—Ç—Ä–∏–∫–∏, –¥–∞–Ω–Ω—ã–µ
  * –†–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤–ª–∏—è—é—Ç –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à—É—é —Ä–∞–±–æ—Ç—É
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û—á–µ–≤–∏–¥–Ω—ã–µ –∏–ª–∏ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç—ã
  * –î–µ—Ç–∞–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ discussion
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –±–µ–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —É–≤–µ–ª–∏—á–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ 40%\\n- –†–µ—à–µ–Ω–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã\\n- –ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 500 000 —Ä—É–±–ª–µ–π"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤—Å—Ç—Ä–µ—á–∏", "–û–±—Å—É–¥–∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Å–∞–º—ã—Ö –∑–Ω–∞—á–∏–º—ã—Ö –º–æ–º–µ–Ω—Ç–∞—Ö (–æ–±—ã—á–Ω–æ 3-7 –ø—É–Ω–∫—Ç–æ–≤)
  * –ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–º –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º
  * –ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ –æ–Ω –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è""",

    "decisions": """üìå –†–µ—à–µ–Ω–∏—è (decisions):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–∏–Ω—è—Ç—ã–µ –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –¢–æ–ª—å–∫–æ —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ü–†–ò–ù–Ø–¢–´ –∏ –°–û–ì–õ–ê–°–û–í–ê–ù–´ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
  * –ß–µ—Ç–∫–æ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —É—Ä–æ–≤–µ–Ω—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏: "–ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ" vs "–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –æ–±—Å—É–¥–∏—Ç—å"
  * –£—Å–ª–æ–≤–∏—è —Ä–µ—à–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å ("–µ—Å–ª–∏ –ø–æ–ª—É—á–∏–º –±—é–¥–∂–µ—Ç, —Ç–æ...")
  * –ö—Ç–æ –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –≤–∞–∂–Ω–æ –∏ —É–ø–æ–º—è–Ω—É—Ç–æ)
  * –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ –∑–≤—É—á–∞–ª–æ
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–ª—å–∫–æ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å, –Ω–æ –Ω–µ –±—ã–ª–∏ –ø—Ä–∏–Ω—è—Ç—ã
  * –ò–¥–µ–∏ –±–µ–∑ —á–µ—Ç–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
  * –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –ï—Å–ª–∏ –≤–∞–∂–Ω–æ –∫—Ç–æ –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ - —É–∫–∞–∂–∏: "–†–µ—à–µ–Ω–∏–µ. –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä: –ò–º—è –§–∞–º–∏–ª–∏—è"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞\\n- –£—Ç–≤–µ—Ä–∂–¥–µ–Ω –±—é–¥–∂–µ—Ç –≤ —Ä–∞–∑–º–µ—Ä–µ 500 000 —Ä—É–±–ª–µ–π\\n- –î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –Ω–∞—á–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ —Å–ª–µ–¥—É—é—â–µ–º –∫–≤–∞—Ä—Ç–∞–ª–µ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–û–±—Å—É–¥–∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É" (–Ω–µ —Ä–µ—à–µ–Ω–∏–µ), "–í–æ–∑–º–æ–∂–Ω–æ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã" (–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ß–µ—Ç–∫–æ —Ä–∞–∑–ª–∏—á–∞–π: —á—Ç–æ –†–ï–®–ï–ù–û vs —á—Ç–æ –û–ë–°–£–ñ–î–ê–õ–û–°–¨ vs —á—Ç–æ –ü–†–ï–î–õ–û–ñ–ï–ù–û
  * –§–∏–∫—Å–∏—Ä—É–π —Å—Ç–µ–ø–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ ("—Ç–æ—á–Ω–æ —Å–¥–µ–ª–∞–µ–º" vs "–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º")
  * –ï—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–µ —É—Å–ª–æ–≤–Ω–æ–µ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏ —É—Å–ª–æ–≤–∏—è""",

    "tasks": """‚úÖ –ó–∞–¥–∞—á–∏ (tasks):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ó–∞–¥–∞—á–∏ –∏ –ø–æ—Ä—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∏–ª–∏ –æ–±—Å—É–∂–¥–µ–Ω—ã –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã
  * –ü–æ—Ä—É—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º (–µ—Å–ª–∏ –±—ã–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã)
  * –ó–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π
  * –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã)
  * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–¥–∞—á (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞–¥–∞—á –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Ä—É—á–µ–Ω–∏—è
  * –ò–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—Ç–∞–ª–∏ –∑–∞–¥–∞—á–∞–º–∏
  * –û–±—â–∏–µ –ø–ª–∞–Ω—ã –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏. –§–æ—Ä–º–∞—Ç: "- –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–º—è –§–∞–º–∏–ª–∏—è" (–µ—Å–ª–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —É–∫–∞–∑–∞–Ω)
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –£–∫–∞–∑—ã–≤–∞–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –æ–Ω —è–≤–Ω–æ –Ω–∞–∑–≤–∞–Ω –∏–ª–∏ –ø–æ–Ω—è—Ç–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω - –Ω–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π.
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤\\n- –ü—Ä–æ–≤–µ—Å—Ç–∏ code review –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞\\n- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–µ —É–∫–∞–∑–∞–Ω)"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ó–∞–¥–∞—á–∏: –¢–ó, —Ä–µ–≤—å—é, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" (–±–µ–∑ –¥–µ—Ç–∞–ª–µ–π), "–ò–≤–∞–Ω –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å –¢–ó" (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–µ –Ω–∞–∑–≤–∞–Ω —è–≤–Ω–æ, –Ω–æ –ø–æ–Ω—è—Ç–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ - —É–∫–∞–∂–∏ –µ–≥–æ
  * –ï—Å–ª–∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π - –Ω–µ —É–∫–∞–∑—ã–≤–∞–π –∏–ª–∏ –ø–∏—à–∏ "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
  * –ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏""",

    "action_items": """‚úÖ –ó–∞–¥–∞—á–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é (action_items):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø–æ—Ä—É—á–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ª–∏—Ü
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ü–æ—Ä—É—á–µ–Ω–∏—è —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º
  * –î–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫—Ç–æ –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å)
  * –°—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ —É–ø–æ–º—è–Ω—É—Ç—ã
  * –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û–±—â–∏–µ –∏–¥–µ–∏ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
  * –ó–∞–¥–∞—á–∏ –±–µ–∑ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ (–µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç —è–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è)
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- ". –§–æ—Ä–º–∞—Ç: "- –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–º—è –§–∞–º–∏–ª–∏—è" (–ë–ï–ó —Ä–æ–ª–∏ –≤ —Å–∫–æ–±–∫–∞—Ö!)
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∑—ã–≤–∞–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ. –ï—Å–ª–∏ –æ–Ω –Ω–µ –Ω–∞–∑–≤–∞–Ω —è–≤–Ω–æ, –Ω–æ –ø–æ–Ω—è—Ç–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ - —É–∫–∞–∂–∏. –ï—Å–ª–∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ - –ø–∏—à–∏ "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –Ω–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫ 15 –º–∞—Ä—Ç–∞ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞\\n- –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –±—é–¥–∂–µ—Ç —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –æ—Ç–¥–µ–ª–æ–º ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤\\n- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ù–µ —É–∫–∞–∑–∞–Ω–æ"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é (–ú–∞—Ä–∏—è)", "–ú–∞—Ä–∏—è - –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è" (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç), "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞ (–ú–µ–Ω–µ–¥–∂–µ—Ä)" (—Å —Ä–æ–ª—å—é)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –ò–ú–Ø –±–µ–∑ —Ä–æ–ª–∏ –≤ —Å–∫–æ–±–∫–∞—Ö: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤", –ù–ï "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (–ú–µ–Ω–µ–¥–∂–µ—Ä)"
  * –ï—Å–ª–∏ —Å—Ä–æ–∫ —É–ø–æ–º—è–Ω—É—Ç - –≤–∫–ª—é—á–∏ –µ–≥–æ –≤ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
  * –û–ø—Ä–µ–¥–µ–ª—è–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∏—Ö –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π (–∫—Ç–æ –≤–∑—è–ª –Ω–∞ —Å–µ–±—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ)""",

    "next_steps": """üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (next_steps):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã –ø–æ—Å–ª–µ –≤—Å—Ç—Ä–µ—á–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏, –æ –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å
  * –ü–ª–∞–Ω—ã –Ω–∞ –±–ª–∏–∂–∞–π—à–µ–µ –±—É–¥—É—â–µ–µ
  * –î–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É—é—Ç –∏–∑ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π
  * –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –∏ checkpoints
  * –°—Ä–æ–∫–∏ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã)
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û–±—â–∏–µ —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ "–±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–ª—å—à–µ"
  * –°–ª–∏—à–∫–æ–º –æ—Ç–¥–∞–ª–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω—ã –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (–¥–æ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏)\\n- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤\\n- –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –≤—Å—Ç—Ä–µ—á–∏ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É", "–ë—É–¥–µ–º –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ" (—Å–ª–∏—à–∫–æ–º –æ–±—â–æ)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö, –∏–∑–º–µ—Ä–∏–º—ã—Ö —à–∞–≥–∞—Ö
  * –ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–æ–∫–∏ ("–∫ –∫–æ–Ω—Ü—É –Ω–µ–¥–µ–ª–∏", "–∫ —Å–ª–µ–¥—É—é—â–µ–π –≤—Å—Ç—Ä–µ—á–µ")
  * –ì—Ä—É–ø–ø–∏—Ä—É–π –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä–∞–º–∫–∞–º –µ—Å–ª–∏ –µ—Å—Ç—å""",

    "deadlines": """‚è∞ –°—Ä–æ–∫–∏ (deadlines):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ä–æ–∫–∏ –∏ –¥–µ–¥–ª–∞–π–Ω—ã, —É–ø–æ–º—è–Ω—É—Ç—ã–µ –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã –¥–µ–¥–ª–∞–π–Ω–æ–≤ –¥–ª—è –∑–∞–¥–∞—á –∏–ª–∏ —Å–æ–±—ã—Ç–∏–π
  * –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–ª–∏ —ç—Ç–∞–ø–æ–≤
  * –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç—ã (—Ä–µ–ª–∏–∑—ã, –∑–∞–ø—É—Å–∫–∏, –º–∏—Ç–∏–Ω–≥–∏)
  * –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–æ–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ("–∫ –∫–æ–Ω—Ü—É –Ω–µ–¥–µ–ª–∏", "—á–µ—Ä–µ–∑ –º–µ—Å—è—Ü")
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –†–∞—Å–ø–ª—ã–≤—á–∞—Ç—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ ("—Å–∫–æ—Ä–æ", "–∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å")
  * –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –¥–∞—Ç—ã –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–æ–±—ã—Ç–∏—é
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- ". –§–æ—Ä–º–∞—Ç: "- –°–æ–±—ã—Ç–∏–µ/–∑–∞–¥–∞—á–∞: –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ä–æ–∫"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: 15 –º–∞—Ä—Ç–∞ 2024\\n- –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞: –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏\\n- –†–µ–ª–∏–∑ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏: –∫ –∫–æ–Ω—Ü—É –∫–≤–∞—Ä—Ç–∞–ª–∞"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–°—Ä–æ—á–Ω–æ", "–ö–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏), {"date": "15.03.2024"} (–Ω–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –°–æ—Ö—Ä–∞–Ω—è–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
  * –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–æ–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–π –∫–∞–∫ –µ—Å—Ç—å: "–∫ –∫–æ–Ω—Ü—É –Ω–µ–¥–µ–ª–∏", "–∫ —Å–ª–µ–¥—É—é—â–µ–π –≤—Å—Ç—Ä–µ—á–µ"
  * –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–∞—Ç–∞ - –∏—Å–ø–æ–ª—å–∑—É–π –µ—ë""",

    "risks_and_blockers": """‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –±–ª–æ–∫–µ—Ä—ã (risks_and_blockers):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏, –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –±–ª–æ–∫–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–ª–∞–Ω–æ–≤
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–∏—Å–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
  * –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –∏ –±–ª–æ–∫–µ—Ä—ã, —É–ø–æ–º—è–Ω—É—Ç—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
  * –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å
  * –ü–ª–∞–Ω—ã –º–∏—Ç–∏–≥–∞—Ü–∏–∏ —Ä–∏—Å–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω–∏ –æ–±—Å—É–∂–¥–∞–ª–∏—Å—å
  * –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ì–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –±–µ–∑ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è
  * –û–±—â–∏–µ –æ–ø–∞—Å–µ–Ω–∏—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- ". –§–æ—Ä–º–∞—Ç: "- **–†–∏—Å–∫/–ë–ª–æ–∫–µ—Ä**: –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∏—Å–∫–∞ –∏ –ø–ª–∞–Ω –º–∏—Ç–∏–≥–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- **–ù–µ—Ö–≤–∞—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–∏—Å–∫ –Ω–µ —É—Å–ø–µ—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ —Ä–µ–ª–∏–∑—É. –ü–ª–∞–Ω: –ø—Ä–∏–≤–ª–µ—á—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö QA\\n- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ API**: –ë–ª–æ–∫–µ—Ä - –∑–∞–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–µ—Ç —Å–¥–≤–∏–Ω—É—Ç—å —Å—Ä–æ–∫–∏"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã", "–ß—Ç–æ-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç –ø–ª–∞–Ω –º–∏—Ç–∏–≥–∞—Ü–∏–∏ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏ –µ–≥–æ
  * –†–∞–∑–ª–∏—á–∞–π —Ä–∏—Å–∫–∏ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã) –∏ –±–ª–æ–∫–µ—Ä—ã (—Ç–µ–∫—É—â–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è)
  * –ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏""",

    "speakers_summary": """üë• –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–æ–≤–æ—Ä—è—â–∏—Ö (speakers_summary):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö—Ä–∞—Ç–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—Å—Ç—Ä–µ—á–∏, –∏—Ö —Ä–æ–ª–µ–π –∏ –≤–∫–ª–∞–¥–∞
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –†–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–µ—Å–ª–∏ –æ–Ω–∏ —É–ø–æ–º—è–Ω—É—Ç—ã –∏–ª–∏ –ø–æ–Ω—è—Ç–Ω—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
  * –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —É—á–∞—Å—Ç–∏—è –∫–∞–∂–¥–æ–≥–æ (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–µ–¥—É—â–∞—è —Ä–æ–ª—å)
  * –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –∫–∞–∂–¥—ã–π
  * –≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–µ—Å–ª–∏ –≤–∏–¥–Ω–∞ –∏–∑ –æ–±—Å—É–∂–¥–µ–Ω–∏—è)
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –õ–∏—á–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –≤—Å—Ç—Ä–µ—á–µ
  * –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è (—ç—Ç–æ –¥–ª—è speaker_contributions)
- –§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç: "–ò–º—è –§–∞–º–∏–ª–∏—è (—Ä–æ–ª—å): –∫—Ä–∞—Ç–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —É—á–∞—Å—Ç–∏—è"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä): –ø—Ä–∏–Ω–∏–º–∞–ª –∫–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–µ–¥–ª–æ–∂–∏–ª –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥. –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ (–¢–∏–º–ª–∏–¥): –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞–ª–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ, –∑–∞–¥–∞–≤–∞–ª–∞ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã."
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ë—ã–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∏", "–ö–æ–º–∞–Ω–¥–∞ –æ–±—Å—É–¥–∏–ª–∞ –≤–æ–ø—Ä–æ—Å—ã" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ —Ä–æ–ª–∏ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—ã —è–≤–Ω–æ - –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å
  * –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –∏—Ö –≤–∫–ª–∞–¥–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤—Å—Ç—Ä–µ—á—É, –∞ –Ω–µ –æ–±—â–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö""",

    "speaker_contributions": """üíº –í–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (speaker_contributions):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Ö –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–¥–µ–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –º–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
  * –ò—Ö –æ—Å–Ω–æ–≤–Ω—ã–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ
  * –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  * –ò–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –≤—ã–¥–≤–∏–Ω—É–ª–∏
  * –í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –∑–∞–¥–∞–≤–∞–ª–∏
  * –ò—Ö –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –æ–±—Å—É–∂–¥–∞–µ–º—ã–º –≤–æ–ø—Ä–æ—Å–∞–º
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ú–µ–∂–¥–æ–º–µ—Ç–∏—è –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
  * –ü–æ–≤—Ç–æ—Ä—ã —Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ä–∞–Ω–µ–µ
- –§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º. –§–æ—Ä–º–∞—Ç: "**–ò–º—è –§–∞–º–∏–ª–∏—è**:\\n- –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∏–¥–µ—è/–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ\\n- –î—Ä—É–≥–∞—è –∏–¥–µ—è"
- –ê–¢–†–ò–ë–£–¶–ò–Ø: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∑—ã–≤–∞–π –∫–∞–∂–¥–æ–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
  **–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ**:
  - –ü—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
  - –û—Ç–º–µ—Ç–∏–ª –≤–∞–∂–Ω–æ—Å—Ç—å API gateway –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - –í—ã—Å–∫–∞–∑–∞–ª –æ–ø–∞—Å–µ–Ω–∏—è –ø–æ –ø–æ–≤–æ–¥—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

  **–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞**:
  - –ü–æ–¥–¥–µ—Ä–∂–∞–ª–∞ –∏–¥–µ—é –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
  - –ü—Ä–µ–¥–ª–æ–∂–∏–ª–∞ –Ω–∞—á–∞—Ç—å —Å –ø–∏–ª–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ê–ª–µ–∫—Å–µ–π –∏ –ú–∞—Ä–∏—è –æ–±—Å—É–∂–¥–∞–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è - –≥—Ä—É–ø–ø–∏—Ä—É–π –ø–æ SPEAKER_N, –∑–∞—Ç–µ–º –∑–∞–º–µ–Ω—è–π –Ω–∞ –∏–º–µ–Ω–∞ –∏–∑ –º–∞–ø–ø–∏–Ω–≥–∞
  * –°–æ—Ö—Ä–∞–Ω—è–π —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—é –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π
  * –§–∏–∫—Å–∏—Ä—É–π –º–æ–º–µ–Ω—Ç—ã —Å–æ–≥–ª–∞—Å–∏—è –∏ –Ω–µ—Å–æ–≥–ª–∞—Å–∏—è –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏""",

    "dialogue_analysis": """üó£Ô∏è –ê–Ω–∞–ª–∏–∑ –¥–∏–∞–ª–æ–≥–∞ –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ (dialogue_analysis):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ê–Ω–∞–ª–∏–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏, –¥–∏–Ω–∞–º–∏–∫–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–∫—Ç–æ —Å –∫–µ–º —á–∞—â–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç)
  * –î–∏–Ω–∞–º–∏–∫—É –æ–±—Å—É–∂–¥–µ–Ω–∏—è (—Å–æ–≥–ª–∞—Å–∏–µ, –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è, —É—Ç–æ—á–Ω–µ–Ω–∏—è)
  * –†–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –¥–∏–∞–ª–æ–≥–µ (–≤–µ–¥—É—â–∏–π, –∫—Ä–∏—Ç–∏–∫, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π)
  * –ú–æ–º–µ–Ω—Ç—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏–ª–∏ –Ω–µ—Å–æ–≥–ª–∞—Å–∏—è
  * –ú–æ–º–µ–Ω—Ç—ã –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ –∏ —Å–æ–≥–ª–∞—Å–∏—è
  * –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è discussion
  * –õ–∏—á–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –≤—Å—Ç—Ä–µ—á–µ
- –§–û–†–ú–ê–¢: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –∞–Ω–∞–ª–∏–∑–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –∏ –¥–∏–Ω–∞–º–∏–∫–∏
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "–û–±—Å—É–∂–¥–µ–Ω–∏–µ –±—ã–ª–æ –∞–∫—Ç–∏–≤–Ω—ã–º –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–º. –ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ –∏ –ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞ –≤–µ–ª–∏ –æ—Å–Ω–æ–≤–Ω—É—é –¥–∏—Å–∫—É—Å—Å–∏—é –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏–¥–µ—è–º–∏. –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ –∑–∞–¥–∞–≤–∞–ª —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤—ã—Ä–∞–∂–∞–ª –æ–ø–∞—Å–µ–Ω–∏—è, —á—Ç–æ —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞–ª–æ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–π –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–µ —Ä–µ—à–µ–Ω–∏–π. –í –∫–æ–Ω—Ü–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∏—à–ª–∏ –∫ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É –ø–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –≤–æ–ø—Ä–æ—Å–æ–≤."
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–±—â–∞–ª–∏—Å—å" (–±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞), –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ–≤ –∏–∑ discussion
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –ö–ê–ö –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å, –∞ –Ω–µ –Ω–∞ –ß–¢–û –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å
  * –í—ã—è–≤–ª—è–π –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –¥–∏–Ω–∞–º–∏–∫—É, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—á–∏—Å–ª—è–π —Ñ–∞–∫—Ç—ã
  * –û—Ç–º–µ—á–∞–π –º–æ–º–µ–Ω—Ç—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è""",

    "technical_issues": """üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã (technical_issues):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –≤–æ–ø—Ä–æ—Å—ã, –±–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ–¥–Ω—è—Ç—ã –∏–ª–∏ –æ–±—Å—É–∂–¥–µ–Ω—ã
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
  * –ë–∞–≥–∏ –∏–ª–∏ –æ—à–∏–±–∫–∏, —É–ø–æ–º—è–Ω—É—Ç—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
  * –í–æ–ø—Ä–æ—Å—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, —Ç—Ä–µ–±—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  * –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –ù–µ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (—ç—Ç–æ –¥–ª—è issues)
  * –û–±—â–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ\\n- –û—à–∏–±–∫–∞ –≤ API –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –±–æ–ª—å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤\\n- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã", "–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ—Ä–º—É–ª–∏—Ä—É–π —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∫—Ä–∞—Ç–∫–æ, –Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω–æ
  * –£–∫–∞–∑—ã–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã, –µ—Å–ª–∏ –æ–Ω–∏ —É–ø–æ–º—è–Ω—É—Ç—ã
  * –ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, –µ—Å–ª–∏ –æ–Ω –≤–∞–∂–µ–Ω –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã""",

    "architecture_decisions": """üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (architecture_decisions):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –≤—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  * –†–µ—à–µ–Ω–∏—è –ø–æ –≤—ã–±–æ—Ä—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
  * –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π ("–ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫")
  * –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ –ø—Ä–∏—á–∏–Ω—ã –∏—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
  * –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û–±—â–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
  * –ò–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—Ç–∞–ª–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –§–æ—Ä–º–∞—Ç: "- –†–µ—à–µ–Ω–∏–µ: –æ–ø–∏—Å–∞–Ω–∏–µ. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –ø–æ—á–µ–º—É —Ç–∞–∫ —Ä–µ—à–∏–ª–∏"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤\\n- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ë—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã" (–±–µ–∑ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è), "–û–±—Å—É–¥–∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É" (–Ω–µ —Ä–µ—à–µ–Ω–∏–µ)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–∏–∫—Å–∏—Ä—É–π –Ω–µ —Ç–æ–ª—å–∫–æ –ß–¢–û —Ä–µ—à–µ–Ω–æ, –Ω–æ –∏ –ü–û–ß–ï–ú–£
  * –û—Ç–º–µ—á–∞–π —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ, –Ω–æ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
  * –£–∫–∞–∑—ã–≤–∞–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–µ—à–µ–Ω–∏—è–º–∏""",

    "technical_tasks": """‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (technical_tasks):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ó–∞–¥–∞—á–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
  * –ó–∞–¥–∞—á–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  * –ó–∞–¥–∞—á–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –±–∞–≥–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –ø–æ–¥—Ö–æ–¥–æ–≤
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –û–±—â–∏–µ –∑–∞–¥–∞—á–∏ –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ (—ç—Ç–æ –¥–ª—è tasks)
  * –û–±—Å—É–∂–¥–µ–Ω–∏—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏. –§–æ—Ä–º–∞—Ç: "- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏"
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–æ–π\\n- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö\\n- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD pipeline –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å", "–ù—É–∂–Ω–æ —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞—Ç—å" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
  * –£–∫–∞–∑—ã–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –µ—Å–ª–∏ –æ–Ω–∏ —É–ø–æ–º—è–Ω—É—Ç—ã
  * –ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏""",

    "next_sprint_plans": """üìÖ –ü–ª–∞–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç (next_sprint_plans):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –ü–ª–∞–Ω—ã –∏ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–ø—Ä–∏–Ω—Ç–µ –∏–ª–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç
  * –¶–µ–ª–∏ —Å–ø—Ä–∏–Ω—Ç–∞
  * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –ø–µ—Ä–∏–æ–¥
  * –†–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–¥–µ–ª–µ–Ω—ã
  * –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ —Å–ø—Ä–∏–Ω—Ç–∞
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Å–ø—Ä–∏–Ω—Ç—É
  * –û–±—â–∏–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- " –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –ø–ª–∞–Ω–∞
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏\\n- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π\\n- –î–æ—Ä–∞–±–æ—Ç–∫–∞ API –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ë—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º", "–ü–ª–∞–Ω—ã –Ω–∞ —Å–ø—Ä–∏–Ω—Ç –µ—Å—Ç—å" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö, –∏–∑–º–µ—Ä–∏–º—ã—Ö –∑–∞–¥–∞—á–∞—Ö —Å–ø—Ä–∏–Ω—Ç–∞
  * –°–æ—Ö—Ä–∞–Ω—è–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ —É–∫–∞–∑–∞–Ω—ã
  * –ú–æ–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–µ–º–∞–º –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º —Å–∏—Å—Ç–µ–º—ã""",

    "issues": """‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã/–≤–æ–ø—Ä–æ—Å—ã (issues/questions):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –≤–æ–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ–¥–Ω—è—Ç—ã
  * –í–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞ –∏–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞
  * –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–±—É—é—â–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
  * –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
  * –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –£–∂–µ —Ä–µ—à–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (—ç—Ç–æ –¥–ª—è technical_issues)
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- ". –§–æ—Ä–º—É–ª–∏—Ä—É–π —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∫—Ä–∞—Ç–∫–æ
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –æ—Ö–≤–∞—Ç —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ —Ç–µ–∫—É—â–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏\\n- –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞\\n- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—Ä–µ–∞—Ç–∏–≤–æ–≤"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã", "–ß—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ—Ä–º—É–ª–∏—Ä—É–π —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∫—Ä–∞—Ç–∫–æ, —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏
  * –£–±–∏—Ä–∞–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É, –æ—Å—Ç–∞–≤–ª—è–π —Ñ–∞–∫—Ç—ã
  * –ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ–¥–∏–Ω –ø—É–Ω–∫—Ç
  * –†–∞–∑–ª–∏—á–∞–π —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏""",

    "questions": """‚ùì –í–æ–ø—Ä–æ—Å—ã (questions):
- –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï: –í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–æ–¥–Ω—è—Ç—ã –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ –∏ —Ç—Ä–µ–±—É—é—Ç –æ—Ç–≤–µ—Ç–∞ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏
- –ß–¢–û –ò–ó–í–õ–ï–ö–ê–¢–¨:
  * –í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–¥–∞–≤–∞–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∏
  * –í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –æ—Ç–≤–µ—Ç–∞
  * –í–æ–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è
  * –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –±—É–¥—É—â–∏—Ö –≤—Å—Ç—Ä–µ—á
  * –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—è—Å–Ω–∏—Ç—å
- –ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:
  * –í–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–∞–ª–∏ –æ—Ç–≤–µ—Ç –≤–æ –≤—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á–∏
  * –†–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –±–µ–∑ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
  * –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã (—ç—Ç–æ –¥–ª—è technical_issues)
- –§–û–†–ú–ê–¢: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ "- ". –§–æ—Ä–º—É–ª–∏—Ä—É–π –≤–æ–ø—Ä–æ—Å –∫—Ä–∞—Ç–∫–æ –∏ —è—Å–Ω–æ
- –ü–†–ò–ú–ï–†–´:
  ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: "- –ö–∞–∫–æ–π –±—é–¥–∂–µ—Ç –≤—ã–¥–µ–ª–µ–Ω –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—É—é –∫–∞–º–ø–∞–Ω–∏—é?\\n- –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ?\\n- –ö–∞–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ –ø—Ä–æ–µ–∫—Ç–∞?"
  ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: "–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã" (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏), "–ß—Ç–æ –¥–µ–ª–∞—Ç—å?" (—Å–ª–∏—à–∫–æ–º –æ–±—â–æ)
- –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
  * –§–æ—Ä–º—É–ª–∏—Ä—É–π –≤–æ–ø—Ä–æ—Å—ã –∫–∞–∫ –æ–Ω–∏ –∑–≤—É—á–∞–ª–∏ –∏–ª–∏ –≤ –≤–∏–¥–µ –∫—Ä–∞—Ç–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é
  * –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –∑–∞–¥–∞–Ω —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º - –≤–∫–ª—é—á–∏ –µ–≥–æ
  * –ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ª–æ–≥–∏—á–µ—Å–∫–∏"""
}


def _build_field_specific_rules(template_variables: Dict[str, str]) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π —à–∞–±–ª–æ–Ω–∞.
    
    Args:
        template_variables: –°–ª–æ–≤–∞—Ä—å —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞ (–∫–ª—é—á–∏ - –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π)
        
    Returns:
        –°—Ç—Ä–æ–∫–∞ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª–µ–π, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤ template_variables
    """
    if not template_variables:
        return ""
    
    rules_parts = []
    
    # –ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π –¥–ª—è –ª–æ–≥–∏—á–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    field_order = [
        "participants", "date", "time",  # –ë–∞–∑–æ–≤—ã–µ
        "agenda", "discussion", "key_points",  # –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
        "decisions", "tasks", "action_items", "next_steps",  # –†–µ—à–µ–Ω–∏—è –∏ –¥–µ–π—Å—Ç–≤–∏—è
        "speakers_summary", "speaker_contributions", "dialogue_analysis",  # –ê–Ω–∞–ª–∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        "technical_issues", "architecture_decisions", "technical_tasks",  # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ
        "risks_and_blockers", "next_sprint_plans", "deadlines", "issues", "questions"  # –†–∏—Å–∫–∏ –∏ –ø–ª–∞–Ω—ã
    ]
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ–ª–µ–π –≤ –ø–æ—Ä—è–¥–∫–µ field_order
    for field_name in field_order:
        if field_name in template_variables:
            rule = FIELD_SPECIFIC_RULES.get(field_name)
            if rule:
                rules_parts.append(rule)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ field_order (–Ω–∞ —Å–ª—É—á–∞–π –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π)
    for field_name in template_variables.keys():
        if field_name not in field_order:
            rule = FIELD_SPECIFIC_RULES.get(field_name)
            if rule:
                rules_parts.append(rule)
    
    if not rules_parts:
        return ""
    
    return "\n\n".join(rules_parts)


class LLMProvider(ABC):
    """–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤"""
    
    @abstractmethod
    async def generate_protocol(self, transcription: str, template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∏ —à–∞–±–ª–æ–Ω–∞"""
        pass
    
    @abstractmethod
    def is_available(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞"""
        pass


# -------------------------------------------------------------
# –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–ª–¥–µ—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
# -------------------------------------------------------------
def _build_system_prompt(
    transcription: Optional[str] = None,
    diarization_analysis: Optional[Dict[str, Any]] = None
) -> str:
    """
    –°—Ç—Ä–æ–≥–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è.
    
    Args:
        transcription: –¢–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
        diarization_analysis: –ê–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
        
    Returns:
        –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–±–∞–∑–æ–≤—ã–π –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
    """
    # –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –µ—Å—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
    if settings.meeting_type_detection and transcription:
        try:
            # –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –≤—Å—Ç—Ä–µ—á—É
            meeting_type, _ = meeting_classifier.classify(
                transcription, 
                diarization_analysis
            )
            
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç
            specialized_prompt = get_specialized_system_prompt(meeting_type)
            logger.info(f"–ò—Å–ø–æ–ª—å–∑—É—é —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ç–∏–ø–∞ –≤—Å—Ç—Ä–µ—á–∏: {meeting_type}")
            return specialized_prompt
            
        except Exception as e:
            logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Å—Ç—Ä–µ—á–∏: {e}. –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç")
    
    # –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç (–¥–ª—è –æ–±—â–∏—Ö –≤—Å—Ç—Ä–µ—á –∏–ª–∏ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
    return (
        "–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Å—Ç –≤—ã—Å—à–µ–π –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –æ–ø—ã—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è "
        "–¥–µ–ª–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á, —Å–æ–≤–µ—â–∞–Ω–∏–π –∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤.\n\n"
        
        "–¢–í–û–Ø –†–û–õ–¨:\n"
        "- –ò–∑–≤–ª–µ–∫–∞—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Å—Ç–µ–Ω–æ–≥—Ä–∞–º–º –≤—Å—Ç—Ä–µ—á\n"
        "- –°–æ–∑–¥–∞–≤–∞—Ç—å —á–µ—Ç–∫–∏–µ, –ª–∞–∫–æ–Ω–∏—á–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã\n"
        "- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å\n\n"
        
        "–§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´ –¢–û–ß–ù–û–°–¢–ò:\n"
        "- –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ü–û–õ–ù–û–¢–ê: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–°–Æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ–≤–∞. "
        "–ö–∞–∂–¥–∞—è —É–ø–æ–º—è–Ω—É—Ç–∞—è —Ç–µ–º–∞, –∏–¥–µ—è, –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç—Ä–∞–∂–µ–Ω—ã –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ\n"
        "- –§–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –¢–û–ß–ù–û–°–¢–¨: –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —è–≤–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â—É—é –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏. "
        "–ù–ï –¥–æ–±–∞–≤–ª—è–π, –ù–ï –¥–æ–º—ã—Å–ª–∏–≤–∞–π, –ù–ï –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π —Å–≤–µ—Ä—Ö —Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ\n"
        "- –°–û–•–†–ê–ù–ï–ù–ò–ï –ö–û–ù–¢–ï–ö–°–¢–ê: –§–∏–∫—Å–∏—Ä—É–π –Ω–µ —Ç–æ–ª—å–∫–æ –ß–¢–û –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ, –Ω–æ –∏ –ö–ê–ö –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å "
        "(—Ç–æ–Ω –¥–∏—Å–∫—É—Å—Å–∏–∏, —É—Ä–æ–≤–µ–Ω—å —Å–æ–≥–ª–∞—Å–∏—è/–Ω–µ—Å–æ–≥–ª–∞—Å–∏—è, —Å—Ç–µ–ø–µ–Ω—å –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–ø—Ä–æ—Å–∞)\n"
        "- –î–ï–¢–ê–õ–ò–ó–ê–¶–ò–Ø –ë–ï–ó –ü–û–¢–ï–†–¨: –ï—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ —É–ø–æ–º—è–Ω—É–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —Ü–∏—Ñ—Ä—É, –¥–∞—Ç—É, –∏–º—è, "
        "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –∏–ª–∏ –ª—é–±—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫—É—é –¥–µ—Ç–∞–ª—å ‚Äî —ç—Ç–æ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ\n"
        "- –ê–¢–†–ò–ë–£–¶–ò–Ø –í–´–°–ö–ê–ó–´–í–ê–ù–ò–ô: –ï—Å–ª–∏ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —É–∫–∞–∑–∞–Ω—ã –∏–º–µ–Ω–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –í–°–ï–ì–î–ê —É–∫–∞–∑—ã–≤–∞–π, "
        "–∫—Ç–æ —á—Ç–æ —Å–∫–∞–∑–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä: \"–ò–≤–∞–Ω –ø—Ä–µ–¥–ª–æ–∂–∏–ª...\", \"–ú–∞—Ä–∏—è –æ—Ç–º–µ—Ç–∏–ª–∞...\")\n"
        "- –û–¢–ö–†–´–¢–´–ï –í–û–ü–†–û–°–´: –§–∏–∫—Å–∏—Ä—É–π –í–°–ï –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã, —Ç–µ–º—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è, "
        "–∏ –º–æ–º–µ–Ω—Ç—ã –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏\n\n"
        
        "–ü–†–ê–í–ò–õ–ê –û–ë–†–ê–ë–û–¢–ö–ò –°–ü–ï–¶–ò–§–ò–ß–ï–°–ö–û–ô –ò–ù–§–û–†–ú–ê–¶–ò–ò:\n"
        "- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—Ü–∞: –£–∫–∞–∑—ã–≤–∞–π –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–∞–∑–≤–∞–Ω—ã –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏. "
        "–ï—Å–ª–∏ —Å–∫–∞–∑–∞–Ω–æ \"–∫—Ç–æ-—Ç–æ –¥–æ–ª–∂–µ–Ω —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å\" –±–µ–∑ –∏–º–µ–Ω–∏ ‚Äî –ø–∏—à–∏ \"–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω\" –∏–ª–∏ \"–ù–µ —É–∫–∞–∑–∞–Ω–æ\"\n"
        "- –°—Ä–æ–∫–∏ –∏ –¥–∞—Ç—ã: –£–∫–∞–∑—ã–≤–∞–π –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —è–≤–Ω–æ —É–ø–æ–º—è–Ω—É—Ç—ã. –ï—Å–ª–∏ —Å–∫–∞–∑–∞–Ω–æ \"—Å–∫–æ—Ä–æ\" –∏–ª–∏ \"–≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è\" ‚Äî "
        "—Å–æ—Ö—Ä–∞–Ω—è–π —ç—Ç—É —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É\n"
        "- –†–µ—à–µ–Ω–∏—è: –ß–µ—Ç–∫–æ —Ä–∞–∑–ª–∏—á–∞–π –º–µ–∂–¥—É \"–ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ\" –∏ \"–æ–±—Å—É–∂–¥–∞–ª–∞—Å—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å\". "
        "–§–∏–∫—Å–∏—Ä—É–π —É—Ä–æ–≤–µ–Ω—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏\n"
        "- –¶–∏—Ñ—Ä—ã –∏ –º–µ—Ç—Ä–∏–∫–∏: –ó–∞–ø–∏—Å—ã–≤–∞–π –≤—Å–µ —É–ø–æ–º—è–Ω—É—Ç—ã–µ —á–∏—Å–ª–∞, –ø—Ä–æ—Ü–µ–Ω—Ç—ã, –±—é–¥–∂–µ—Ç—ã, —Å—Ä–æ–∫–∏ —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n\n"
        
        "–ü–†–ò–ù–¶–ò–ü–´ –†–ê–ë–û–¢–´:\n"
        "1. –¢–û–ß–ù–û–°–¢–¨: –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, —è–≤–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ —Å—Ç–µ–Ω–æ–≥—Ä–∞–º–º–µ\n"
        "2. –ù–ï–¢ –î–û–ú–´–°–õ–û–í: –ù–µ –¥–æ–¥—É–º—ã–≤–∞–π, –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π, –Ω–µ –¥–æ–±–∞–≤–ª—è–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç —Å–µ–±—è\n"
        "3. –ö–û–ù–¢–ï–ö–°–¢: –ï—Å–ª–∏ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è —Ä–æ–ª—å/–¥–æ–ª–∂–Ω–æ—Å—Ç—å/—Å—Ä–æ–∫/—Å—É–º–º–∞ ‚Äî —É–∫–∞–∂–∏ –∏—Ö; –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –Ω–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π\n"
        "4. –ö–†–ê–¢–ö–û–°–¢–¨: –ò–∑–ª–∞–≥–∞–π —Å—É—Ç—å –±–µ–∑ –≤–æ–¥—ã, –∏–∑–±–µ–≥–∞–π –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π\n"
        "5. –¢–ï–†–ú–ò–ù–û–õ–û–ì–ò–Ø: –°–æ—Ö—Ä–∞–Ω—è–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ\n"
        "6. –°–¢–ò–õ–¨: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ-–¥–µ–ª–æ–≤–æ–π —è–∑—ã–∫ –±–µ–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤\n\n"
        
        "üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –§–û–†–ú–ê–¢ –ò–ú–ï–ù –£–ß–ê–°–¢–ù–ò–ö–û–í –í –ü–†–û–¢–û–ö–û–õ–ï:\n"
        "–í —Å–µ–∫—Ü–∏–∏ '–£—á–∞—Å—Ç–Ω–∏–∫–∏' –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π –∏–º–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ '–ò–º—è –§–∞–º–∏–ª–∏—è' –ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞!\n"
        "–ï—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - –ö–û–ü–ò–†–£–ô –∏–º–µ–Ω–∞ –¢–û–ß–ù–û –∫–∞–∫ –æ–Ω–∏ —É–∫–∞–∑–∞–Ω—ã –≤ —Å–ø–∏—Å–∫–µ.\n\n"
        "‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: —Ç–æ–ª—å–∫–æ –∏–º—è ('–°–æ—Ñ—å—è', '–ì–∞–ª–∏–Ω–∞') –∏–ª–∏ —Å –æ—Ç—á–µ—Å—Ç–≤–æ–º ('–°–æ—Ñ—å—è –Æ—Ä—å–µ–≤–Ω–∞ –û—Å–∏–ø–æ–≤–∞')\n"
        "‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: '–°–æ—Ñ—å—è –û—Å–∏–ø–æ–≤–∞', '–ì–∞–ª–∏–Ω–∞ –Ø–º–∫–∏–Ω–∞', '–í–ª–∞–¥–∏–º–∏—Ä –ì–æ–ª–∏–∫–æ–≤'\n\n"
        "–û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –£–ß–ê–°–¢–ù–ò–ö–û–í –ò–ó –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò:\n"
        "‚ö†Ô∏è –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —è–≤–Ω–æ:\n"
        "- –ò–∑–≤–ª–µ–∫–∞–π –∏–º–µ–Ω–∞ –¢–û–õ–¨–ö–û –∏–∑ —è–≤–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        "- –ò—Å—Ç–æ—á–Ω–∏–∫–∏: –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è ('–ú–µ–Ω—è –∑–æ–≤—É—Ç...'), –æ–±—Ä–∞—â–µ–Ω–∏—è ('–°–≤–µ—Ç–∞, –∫–∞–∫ –¥—É–º–∞–µ—à—å?')\n"
        "- –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ –≤ –ø–æ–ª–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π\n"
        "- –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç '–ò–º—è –§–∞–º–∏–ª–∏—è' –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ\n"
        "- –ï–°–õ–ò –∏–º—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å - –æ—Å—Ç–∞–≤–ª—è–π –º–µ—Ç–∫—É —Å–ø–∏–∫–µ—Ä–∞ (SPEAKER_1, SPEAKER_2)\n"
        "- ‚ùå –ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞! –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π '–£—á–∞—Å—Ç–Ω–∏–∫ 1', '–ö–æ–ª–ª–µ–≥–∞'\n"
        "- ‚ùå –ù–ï –¥—É–±–ª–∏—Ä—É–π: –µ—Å–ª–∏ –°–≤–µ—Ç–∞ = SPEAKER_1, –Ω–µ –¥–æ–±–∞–≤–ª—è–π –°–≤–µ—Ç–ª–∞–Ω—É –æ—Ç–¥–µ–ª—å–Ω–æ\n\n"
        "–°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù –ò–ó –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò:\n"
        "–í —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –ª—é–¥–∏ –≥–æ–≤–æ—Ä—è—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ/–Ω–µ–ø–æ–ª–Ω–æ. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –Ω–∞–π—Ç–∏\n"
        "—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ü–û–õ–ù–û–ï –ò–ú–Ø –≤ —Ñ–æ—Ä–º–∞—Ç–µ '–ò–º—è –§–∞–º–∏–ª–∏—è'.\n\n"
        "–ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–∏–º–µ–Ω—è–π –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º):\n\n"
        "1. –£–ú–ï–ù–¨–®–ò–¢–ï–õ–¨–ù–´–ï –ò–ú–ï–ù–ê:\n"
        "   - –°–≤–µ—Ç–∞, –°–≤–µ—Ç–æ—á–∫–∞ ‚Üí –∏—â–∏ '–°–≤–µ—Ç–ª–∞–Ω–∞' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π '–°–≤–µ—Ç–ª–∞–Ω–∞ –§–∞–º–∏–ª–∏—è'\n"
        "   - –õ–µ—à–∞, –õ—ë—à–∞, –ê–ª—ë—à–∞ ‚Üí –∏—â–∏ '–ê–ª–µ–∫—Å–µ–π' ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π '–ê–ª–µ–∫—Å–µ–π –§–∞–º–∏–ª–∏—è'\n"
        "   - –°–∞—à–∞ ‚Üí –∏—â–∏ '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä' –∏–ª–∏ '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞'\n"
        "   - –ñ–µ–Ω—è ‚Üí –∏—â–∏ '–ï–≤–≥–µ–Ω–∏–π' –∏–ª–∏ '–ï–≤–≥–µ–Ω–∏—è'\n"
        "   - –ö–æ–ª—è ‚Üí –∏—â–∏ '–ù–∏–∫–æ–ª–∞–π'\n"
        "   - –î–∏–º–∞ ‚Üí –∏—â–∏ '–î–º–∏—Ç—Ä–∏–π'\n"
        "   ‚ö° –≠—Ç–æ –ü–†–ò–ú–ï–†–´ –ª–æ–≥–∏–∫–∏! –ü—Ä–∏–º–µ–Ω—è–π —Ç–∞–∫–æ–π –∂–µ –ø–æ–¥—Ö–æ–¥ –¥–ª—è –õ–Æ–ë–´–• —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–º–µ–Ω\n\n"
        "2. –£–ü–û–ú–ò–ù–ê–ù–ò–ï –ü–û –§–ê–ú–ò–õ–ò–ò:\n"
        "   - –ï—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç–∞ —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è ‚Üí –Ω–∞–π–¥–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n"
        "   - –ü—Ä–∏–º–µ—Ä: '–¢–∏–º—á–µ–Ω–∫–æ' –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ ‚Üí '–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ' –∏–∑ —Å–ø–∏—Å–∫–∞\n"
        "   - –ü—Ä–∏–º–µ—Ä: '–ö–æ—Ä–æ—Ç–∫–æ–≤–∞' –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ ‚Üí '–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞' –∏–∑ —Å–ø–∏—Å–∫–∞\n"
        "   ‚ö° –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• —Ñ–∞–º–∏–ª–∏–π –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n\n"
        "3. –£–ü–û–ú–ò–ù–ê–ù–ò–ï –¢–û–õ–¨–ö–û –ò–ú–ï–ù–ò:\n"
        "   - –ï—Å–ª–∏ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –∏–º—è ‚Üí –¥–æ–ø–æ–ª–Ω–∏ —Ñ–∞–º–∏–ª–∏–µ–π –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n"
        "   - –ü—Ä–∏–º–µ—Ä: '–ê–ª–µ–∫—Å–µ–π' –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ ‚Üí '–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ' –∏–∑ —Å–ø–∏—Å–∫–∞\n"
        "   - –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏\n"
        "   ‚ö° –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è\n\n"
        "4. –í–ê–ñ–ù–û:\n"
        "   - –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–û–ï –ò–ú–Ø –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n"
        "   - –ü—Ä–∏–º–µ—Ä—ã –≤—ã—à–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –õ–û–ì–ò–ö–£ - –ø—Ä–∏–º–µ–Ω—è–π –µ—ë –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º\n"
        "   - –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–∞–º–∏ - —Ä–∞–±–æ—Ç–∞–π —Å–æ –í–°–ï–ú–ò —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞\n"
        "   - –ü—Ä–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ –≤—ã–±–∏—Ä–∞–π –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É\n\n"
        
        "–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–ë–°–£–ñ–î–ï–ù–ò–Ø:\n"
        "–ï—Å–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—à—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–∞–º/–∫–ª–∞—Å—Ç–µ—Ä–∞–º:\n"
        "- –ù–ï –ø–∏—à–∏ —Å–ª–æ–≤–æ '–ö–ª–∞—Å—Ç–µ—Ä', —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º: '‚Ä¢ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã**'\n"
        "- –ö–∞–∂–¥—É—é –∏–¥–µ—é/–≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ/–ø–æ–∑–∏—Ü–∏—é —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏\n"
        "- –§–æ—Ä–º–∞—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è: '–ò–º—è –ê–≤—Ç–æ—Ä–∞: —Ç–µ–∫—Å—Ç' (–±–µ–∑ —Å–ª–æ–≤–∞ '–ò–¥–µ—è', –±–µ–∑ —Å–∫–æ–±–æ–∫)\n"
        "- –ú–µ–∂–¥—É —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è\n\n"
        "–ü—Ä–∏–º–µ—Ä—ã:\n"
        "‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:\n"
        "‚Ä¢ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**\n\n"
        "–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É\n\n"
        "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞: –ø–æ–¥–¥–µ—Ä–∂–∞–ª–∞, –¥–æ–±–∞–≤–∏–ª–∞ –ø—Ä–æ –≤–∞–∂–Ω–æ—Å—Ç—å API gateway\n\n"
        "‚úó –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:\n"
        "‚Ä¢ –ö–ª–∞—Å—Ç–µ—Ä ¬´–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è¬ª: –ò–¥–µ—è (–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ): –ø—Ä–µ–¥–ª–æ–∂–∏–ª...\n\n"
        
        "–ß–¢–û –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨:\n"
        "- –ú–µ–∂–¥–æ–º–µ—Ç–∏—è (—ç-—ç, –º-–º, –Ω—É, –≤–æ—Ç)\n"
        "- –ü–æ–≤—Ç–æ—Ä—ã –∏ –∑–∞–ø–∏–Ω–∫–∏\n"
        "- –í–≤–æ–¥–Ω—ã–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ —Å–º—ã—Å–ª–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏\n"
        "- –û—Ç–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–µ –ø–æ —Ç–µ–º–µ –≤—Å—Ç—Ä–µ—á–∏\n\n"
        
        "–ß–¢–û –í–´–î–ï–õ–Ø–¢–¨:\n"
        "- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ —Ä–µ–∑–æ–ª—é—Ü–∏–∏\n"
        "- –ü–æ—Ä—É—á–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã)\n"
        "- –°—Ä–æ–∫–∏, —Å—É–º–º—ã, –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–∞–∑–≤–∞–Ω—ã)\n"
        "- –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è\n"
        "- –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏\n"
        "- –¶–∏—Ñ—Ä—ã, –º–µ—Ç—Ä–∏–∫–∏, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∞–π –≤—Å–µ —É–ø–æ–º—è–Ω—É—Ç—ã–µ)\n"
        "- –í—Å–µ —Ç–µ–º—ã –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫—Ç–æ —á—Ç–æ —Å–∫–∞–∑–∞–ª\n"
        "- –ú–æ–º–µ–Ω—Ç—ã –Ω–µ—Å–æ–≥–ª–∞—Å–∏—è, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–Ω–µ–Ω–∏—è, –Ω–µ—Ä–µ—à–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n"
        
        "–§–û–†–ú–ê–¢ –í–´–í–û–î–ê:\n"
        "–°—Ç—Ä–æ–≥–æ –≤–∞–ª–∏–¥–Ω—ã–π JSON-–æ–±—ä–µ–∫—Ç –±–µ–∑ –æ–±—Ä–∞–º–ª–µ–Ω–∏—è –≤ markdown, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π. "
        "–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π '–ù–µ —É–∫–∞–∑–∞–Ω–æ'.\n\n"
        
        "–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π:\n"
        "- –í–°–ï –∑–Ω–∞—á–µ–Ω–∏—è –≤ JSON –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ü–†–û–°–¢–´–ú–ò –°–¢–†–û–ö–ê–ú–ò (string)\n"
        "- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã {} –∏–ª–∏ –º–∞—Å—Å–∏–≤—ã [] –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–µ–π\n"
        "- –°–ø–∏—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–π –∫–∞–∫ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ '- ' (–¥–µ—Ñ–∏—Å + –ø—Ä–æ–±–µ–ª)\n"
        "- –î–∞—Ç—ã –∏ –≤—Ä–µ–º—è: –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä '20 –æ–∫—Ç—è–±—Ä—è 2024, 14:30'\n"
        "- –£—á–∞—Å—Ç–Ω–∏–∫–∏: –∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ \\n, –ë–ï–ó —Ä–æ–ª–µ–π!, –Ω–∞–ø—Ä–∏–º–µ—Ä '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤\\n–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤'\n"
        "- –†–µ—à–µ–Ω–∏—è –∏ –∑–∞–¥–∞—á–∏: –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ —Å–ø–∏—Å–∫–æ–º —á–µ—Ä–µ–∑ \\n, –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç —Å '- '\n\n"
        
        "–ü–†–ò–ú–ï–† –ü–†–ê–í–ò–õ–¨–ù–û–ì–û JSON:\n"
        "{\n"
        '  "date": "20 –æ–∫—Ç—è–±—Ä—è 2024",\n'
        '  "time": "14:30",\n'
        '  "participants": "–û–∫—Å–∞–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞\\n–ì–∞–ª–∏–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤",\n'
        '  "decisions": "- –†–µ—à–µ–Ω–∏–µ 1\\n- –†–µ—à–µ–Ω–∏–µ 2\\n- –†–µ—à–µ–Ω–∏–µ 3"\n'
        "}\n\n"
        
        "–ü–†–ò–ú–ï–† –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ì–û JSON (–ù–ï –î–ï–õ–ê–ô –¢–ê–ö):\n"
        "{\n"
        '  "date": {"day": 20, "month": "–æ–∫—Ç—è–±—Ä—å"},  ‚ùå –≤–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç\n'
        '  "participants": ["–û–∫—Å–∞–Ω–∞", "–ì–∞–ª—è"],  ‚ùå –º–∞—Å—Å–∏–≤\n'
        '  "decisions": [{"decision": "–†–µ—à–µ–Ω–∏–µ 1"}]  ‚ùå –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤\n'
        "}"
    )


def _build_user_prompt(
    transcription: str,
    template_variables: Dict[str, str],
    diarization_data: Optional[Dict[str, Any]] = None,
    speaker_mapping: Optional[Dict[str, str]] = None,
    meeting_topic: Optional[str] = None,
    meeting_date: Optional[str] = None,
    meeting_time: Optional[str] = None,
    participants: Optional[List[Dict[str, str]]] = None,
    meeting_structure = None,  # MeetingStructure, –Ω–æ –∏–∑–±–µ–≥–∞–µ–º circular import
) -> str:
    """
    –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Ñ–æ—Ä–º–∞—Ç—É.
    
    –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è formatted_transcript –∏–∑ diarization_data, –∫–æ—Ç–æ—Ä—ã–π:
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è —Å–ø–∏–∫–µ—Ä–æ–≤
    - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∏ –æ–¥–Ω–æ–≥–æ —Å–ø–∏–∫–µ—Ä–∞
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç LLM –ø–æ–Ω—è—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –¥–∏–∞–ª–æ–≥–∞
    - –≠–∫–æ–Ω–æ–º–∏—Ç —Ç–æ–∫–µ–Ω—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏—Å—Ö–æ–¥–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
    
    –ò—Å—Ö–æ–¥–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞
    —á–µ—Ä–µ–∑ settings.include_raw_transcription_in_prompts –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–µ–π.
    """
    # –ë–ª–æ–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å —É—á—ë—Ç–æ–º –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏)
    if diarization_data and diarization_data.get("formatted_transcript"):
        transcription_text = (
            "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –≥–æ–≤–æ—Ä—è—â–∏—Ö:\n"
            f"{diarization_data['formatted_transcript']}\n\n"
            "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n"
            f"- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–≤–æ—Ä—è—â–∏—Ö: {diarization_data.get('total_speakers', '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
            f"- –°–ø–∏—Å–æ–∫ –≥–æ–≤–æ—Ä—è—â–∏—Ö: {', '.join(diarization_data.get('speakers', []))}\n\n"
        )
        
        # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        if settings.include_raw_transcription_in_prompts:
            transcription_text += (
                "\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
                "–ò–°–•–û–î–ù–ê–Ø –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–Ø (–î–õ–Ø –û–¢–õ–ê–î–ö–ò):\n"
                "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
                f"{transcription}\n\n"
            )
    else:
        transcription_text = (
            "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è:\n"
            f"{transcription}\n\n"
            "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–∏–∞—Ä–∏–∑–∞—Ü–∏—è (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≥–æ–≤–æ—Ä—è—â–∏—Ö) –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏.\n"
        )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å–ø–∏–∫–µ—Ä–æ–≤ —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
    participants_info = ""
    if speaker_mapping:
        participants_info = "\n\n" + "‚ïê" * 63 + "\n"
        participants_info += "–£–ß–ê–°–¢–ù–ò–ö–ò –í–°–¢–†–ï–ß–ò (–° –†–û–õ–Ø–ú–ò)\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        participants_info += "–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥–æ–≤–æ—Ä—è—â–∏—Ö —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏:\n"
        for speaker_id, participant_name in speaker_mapping.items():
            participants_info += f"- {speaker_id} = {participant_name}\n"
        participants_info += "\n"
        participants_info += "‚ö†Ô∏è –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –†–ê–ë–û–¢–ï –° –£–ß–ê–°–¢–ù–ò–ö–ê–ú–ò:\n"
        participants_info += "1. –ò—Å–ø–æ–ª—å–∑—É–π –†–ï–ê–õ–¨–ù–´–ï –ò–ú–ï–ù–ê –≤–º–µ—Å—Ç–æ –º–µ—Ç–æ–∫ —Å–ø–∏–∫–µ—Ä–æ–≤ (SPEAKER_1 ‚Üí –ò–º—è)\n"
        participants_info += "2. –ü—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—á–∏—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n"
        participants_info += "3. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ: –¢–û–õ–¨–ö–û –ò–ú–Ø, –±–µ–∑ —Ä–æ–ª–∏ –≤ —Å–∫–æ–±–∫–∞—Ö\n"
        participants_info += "   ‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤'\n"
        participants_info += "   ‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (–ú–µ–Ω–µ–¥–∂–µ—Ä)'\n"
        participants_info += "üìå –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù:\n"
        participants_info += "–í —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ/—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–º–µ–Ω.\n"
        participants_info += "–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–π –∏—Ö —Å –ø–æ–ª–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ:\n\n"
        participants_info += "–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–∏–º–µ–Ω—è–π –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º):\n"
        participants_info += "   ‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π, –°–∞—à–∞‚Üí–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –ü–æ —Ñ–∞–º–∏–ª–∏–∏: –¢–∏–º—á–µ–Ω–∫–æ‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ, –ö–æ—Ä–æ—Ç–∫–æ–≤–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞ –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–º—è: –ê–ª–µ–∫—Å–µ–π‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ (–µ—Å–ª–∏ –æ–¥–∏–Ω —Ç–∞–∫–æ–π –≤ —Å–ø–∏—Å–∫–µ)\n\n"
        participants_info += "   ‚ö° –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Å—è –ø—Ä–∏–º–µ—Ä–∞–º–∏! –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ.\n"
        participants_info += "   ‚ö° –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–û–ï –ò–ú–Ø –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤!\n"
    elif participants:
        # –ï—Å–ª–∏ –Ω–µ—Ç speaker_mapping, –Ω–æ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
        participants_info = "\n\n" + "‚ïê" * 63 + "\n"
        participants_info += "üéØ –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í –í–°–¢–†–ï–ß–ò (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ)\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        from src.services.participants_service import participants_service
        participants_info += participants_service.format_participants_for_llm(participants)
        participants_info += "\n\n"
        participants_info += "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
        participants_info += "‚ïë  üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø     ‚ïë\n"
        participants_info += "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
        participants_info += "1Ô∏è‚É£ –ò–°–ü–û–õ–¨–ó–£–ô –¢–û–õ–¨–ö–û –ò–ú–ï–ù–ê –ò–ó –°–ü–ò–°–ö–ê –í–´–®–ï!\n"
        participants_info += "   –ó–ê–ü–†–ï–©–ï–ù–û –¥–æ–±–∞–≤–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ —Å–ø–∏—Å–∫–µ!\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–ö–æ–ª–ª–µ–≥–∞ –∏–∑ –û–†–¢', '–ö–æ–ª–ª–µ–≥–∏ –∏–∑ ERP', '–ö–æ–º–∞–Ω–¥–∞'\n"
        participants_info += "   ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞\n\n"
        participants_info += "2Ô∏è‚É£ –§–û–†–ú–ê–¢ –ò–ú–ï–ù: '–ò–º—è –§–∞–º–∏–ª–∏—è' (–ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞)!\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–°–æ—Ñ—å—è' (—Ç–æ–ª—å–∫–æ –∏–º—è)\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–í–∏–∫—É–ª–∏–Ω' (—Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è)\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–û—Å–∏–ø–æ–≤–∞ –°–æ—Ñ—å—è –Æ—Ä—å–µ–≤–Ω–∞' (—Å –æ—Ç—á–µ—Å—Ç–≤–æ–º)\n"
        participants_info += "   ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: '–°–æ—Ñ—å—è –û—Å–∏–ø–æ–≤–∞', '–ì–∞–ª–∏–Ω–∞ –Ø–º–∫–∏–Ω–∞', '–í–ª–∞–¥–∏–º–∏—Ä –ì–æ–ª–∏–∫–æ–≤'\n\n"
        participants_info += "3Ô∏è‚É£ –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –°–û–ö–†–ê–©–ï–ù–ù–´–• –ò–ú–ï–ù:\n"
        participants_info += "   –í —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–º–∏.\n"
        participants_info += "   –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –≤—ã—à–µ –ü–û–õ–ù–û–ï —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:\n\n"
        participants_info += "   üìã –ü–†–ê–í–ò–õ–ê –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø:\n"
        participants_info += "   ‚Ä¢ '–°–≤–µ—Ç–∞', '–°–≤–µ—Ç–æ—á–∫–∞' ‚Üí –Ω–∞–π–¥–∏ '–°–≤–µ—Ç–ª–∞–Ω–∞' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–õ–µ—à–∞', '–ê–ª—ë—à–∞' ‚Üí –Ω–∞–π–¥–∏ '–ê–ª–µ–∫—Å–µ–π' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–ì–∞–ª—è' ‚Üí –Ω–∞–π–¥–∏ '–ì–∞–ª–∏–Ω–∞' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–í–æ–ª–æ–¥—å', '–í–æ–≤–∞' ‚Üí –Ω–∞–π–¥–∏ '–í–ª–∞–¥–∏–º–∏—Ä' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–°—Ç–∞—Å' ‚Üí –Ω–∞–π–¥–∏ '–°—Ç–∞–Ω–∏—Å–ª–∞–≤' –∏–ª–∏ '–°–≤—è—Ç–æ—Å–ª–∞–≤' –≤ —Å–ø–∏—Å–∫–µ\n"
        participants_info += "   ‚Ä¢ '–í–∏–∫—É–ª–∏–Ω', '–¢–∏–º—á–µ–Ω–∫–æ' (—Ñ–∞–º–∏–ª–∏—è) ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –ø–æ —Ñ–∞–º–∏–ª–∏–∏\n"
        participants_info += "   ‚Ä¢ '–ú–∞—Ä–∞—Ç' (–∏–º—è) ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –ø–æ –∏–º–µ–Ω–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n\n"
        participants_info += "4Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –î–û–ë–ê–í–õ–ï–ù–ò–ï–ú –í –ü–†–û–¢–û–ö–û–õ:\n"
        participants_info += "   –î–ª—è –ö–ê–ñ–î–û–ì–û —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏:\n"
        participants_info += "   ‚úì –ù–∞–π–¥–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Å–ø–∏—Å–∫–µ –≤—ã—à–µ\n"
        participants_info += "   ‚úì –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–û–ï –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ (–ò–º—è –§–∞–º–∏–ª–∏—è)\n"
        participants_info += "   ‚úì –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ - –ù–ï –≤–∫–ª—é—á–∞–π –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª\n\n"
        participants_info += "‚ö° –í–ê–ñ–ù–û: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ!\n"
        participants_info += "‚ö° –ù–ï –≤—ã–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞! –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –∏–∑ —Å–ø–∏—Å–∫–∞!\n"
        participants_info += "‚ö° –ü—Ä–∏ –º–∞–ª–µ–π—à–µ–º —Å–æ–º–Ω–µ–Ω–∏–∏ - —Å–æ–ø–æ—Å—Ç–∞–≤—å —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º!\n\n"
    else:
        # –ù–µ—Ç –Ω–∏ speaker_mapping, –Ω–∏ participants - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        participants_info = "\n\n" + "‚ïê" * 63 + "\n"
        participants_info += "‚öôÔ∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –£–ß–ê–°–¢–ù–ò–ö–û–í –ò–ó –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        participants_info += "–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –û–ø—Ä–µ–¥–µ–ª–∏ –∏–º–µ–Ω–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.\n\n"
        participants_info += "üìã –ü–†–ê–í–ò–õ–ê –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø:\n\n"
        participants_info += "1Ô∏è‚É£ –ò–©–ò –Ø–í–ù–´–ï –£–ü–û–ú–ò–ù–ê–ù–ò–Ø:\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è: '–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', '–Ø ‚Äî –ú–∞—Ä–∏—è'\n"
        participants_info += "   ‚Ä¢ –û–±—Ä–∞—â–µ–Ω–∏—è: '–°–≤–µ—Ç–∞, –∫–∞–∫ –¥—É–º–∞–µ—à—å?', '–ü–µ—Ç—Ä–æ–≤, —Ä–∞—Å—Å–∫–∞–∂–∏ –æ –∑–∞–¥–∞—á–µ'\n"
        participants_info += "   ‚Ä¢ –£–ø–æ–º–∏–Ω–∞–Ω–∏—è: '–ö–∞–∫ —Å–∫–∞–∑–∞–ª –ò–≤–∞–Ω...', '–ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å —É –ú–∞—Ä–∏–∏'\n\n"
        participants_info += "2Ô∏è‚É£ –§–û–†–ú–ê–¢ –ò–ú–ï–ù:\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ: '–ò–º—è –§–∞–º–∏–ª–∏—è' (–ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞)\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ —Ç–æ–ª—å–∫–æ –∏–º—è: '–ò–≤–∞–Ω'\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è: '–ü–µ—Ç—Ä–æ–≤'\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π, –í–æ–ª–æ–¥—è‚Üí–í–ª–∞–¥–∏–º–∏—Ä\n\n"
        participants_info += "3Ô∏è‚É£ –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –°–û –°–ü–ò–ö–ï–†–ê–ú–ò:\n"
        participants_info += "   ‚Ä¢ –°–æ–ø–æ—Å—Ç–∞–≤—å –∫–∞–∂–¥—É—é –º–µ—Ç–∫—É (SPEAKER_1, SPEAKER_2...) —Å –∏–º–µ–Ω–µ–º –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–º—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ù–ï–í–û–ó–ú–û–ñ–ù–û - –æ—Å—Ç–∞–≤—å –º–µ—Ç–∫—É —Å–ø–∏–∫–µ—Ä–∞ –∫–∞–∫ –µ—Å—Ç—å\n"
        participants_info += "   ‚Ä¢ –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤\\n–°–ü–ï–ê–ö–ïR_2\\n–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞\\n–°–ü–ï–ê–ö–ïR_4'\n\n"
        participants_info += "4Ô∏è‚É£ –°–¢–†–û–ì–ò–ï –ó–ê–ü–†–ï–¢–´:\n"
        participants_info += "   ‚ùå –ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "   ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π '–£—á–∞—Å—Ç–Ω–∏–∫ 1', '–ö–æ–ª–ª–µ–≥–∞', '–ß–µ–ª–æ–≤–µ–∫ –ê', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π'\n"
        participants_info += "   ‚ùå –ù–ï –¥—É–±–ª–∏—Ä—É–π: –µ—Å–ª–∏ –°–≤–µ—Ç–∞ = SPEAKER_1, –Ω–µ –¥–æ–±–∞–≤–ª—è–π –°–≤–µ—Ç–ª–∞–Ω—É –æ—Ç–¥–µ–ª—å–Ω–æ\n"
        participants_info += "   ‚ùå –ù–ï –∑–∞–º–µ–Ω—è–π SPEAKER_N –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–∏–ø–∞ '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –≤—Å—Ç—Ä–µ—á–∏'\n\n"
        participants_info += "üí° –ü–û–î–°–ö–ê–ó–ö–ò:\n"
        participants_info += "   ‚Ä¢ –ù–∞—á–∞–ª–æ –≤—Å—Ç—Ä–µ—á–∏ - —á–∞—Å—Ç–æ —Ç–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è\n"
        participants_info += "   ‚Ä¢ –û–±—Ä–∞—â–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏ - —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫\n"
        participants_info += "   ‚Ä¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç: '–Ω–∞—à —Ç–∏–º–ª–∏–¥ –ê–ª–µ–∫—Å–µ–π', '–º–µ–Ω–µ–¥–∂–µ—Ä –ú–∞—Ä–∏—è'\n"
        participants_info += "   ‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ—Ç? ‚Üí –û—Å—Ç–∞–≤—å SPEAKER_N\n\n"

    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å—Ç—Ä–µ—á–µ
    meeting_info = ""
    if meeting_topic or meeting_date or meeting_time:
        meeting_info = "\n\n" + "‚ïê" * 63 + "\n"
        meeting_info += "–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–°–¢–†–ï–ß–ï\n"
        meeting_info += "‚ïê" * 63 + "\n\n"

        if meeting_topic:
            meeting_info += f"üìã –¢–µ–º–∞: {meeting_topic}\n"
        if meeting_date:
            meeting_info += f"üìÖ –î–∞—Ç–∞: {meeting_date}\n"
        if meeting_time:
            meeting_info += f"üïê –í—Ä–µ–º—è: {meeting_time}\n"
        meeting_info += "\n"

    # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
    structure_info = ""
    if meeting_structure:
        structure_text = meeting_structure.format_for_llm_prompt()
        if structure_text:
            structure_info = structure_text
    
    variables_str = "\n".join([f"- {key}: {desc}" for key, desc in template_variables.items()])

    # –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç
    user_prompt = (
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        "–ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        f"{transcription_text}\n"
        f"{structure_info}"
        f"{participants_info}"
        f"{meeting_info}"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        "–ü–û–õ–Ø –î–õ–Ø –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        f"{variables_str}\n\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        "–ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ò–ó–í–õ–ï–ß–ï–ù–ò–Æ\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        
        "üìã –°–¢–†–£–ö–¢–£–†–ê –í–´–í–û–î–ê:\n"
        "- –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–π JSON-–æ–±—ä–µ–∫—Ç (–±–µ–∑ ```json, –±–µ–∑ markdown)\n"
        "- –ò—Å–ø–æ–ª—å–∑—É–π –°–¢–†–û–ì–û —ç—Ç–∏ –∫–ª—é—á–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–ª–µ–π\n"
        "- –°–æ—Ö—Ä–∞–Ω—è–π –ø–æ—Ä—è–¥–æ–∫ –∫–ª—é—á–µ–π –∫–∞–∫ –≤ —Å–ø–∏—Å–∫–µ –≤—ã—à–µ\n"
        "- –ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Å—Ç—Ä–æ–∫–∞ (UTF-8), –ë–ï–ó –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏–ª–∏ –º–∞—Å—Å–∏–≤–æ–≤\n\n"
        
        "üìù –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –¢–ï–ö–°–¢–ê:\n"
        "- –î–ª—è —Å–ø–∏—Å–∫–æ–≤/–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–π: –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞–π —Å '- ' (–¥–µ—Ñ–∏—Å + –ø—Ä–æ–±–µ–ª)\n"
        "- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –Ω—É–º–µ—Ä–∞—Ü–∏—é (1. 2. 3.), —Ç–æ–ª—å–∫–æ –¥–µ—Ñ–∏—Å—ã\n"
        "- –ù–ï —Å—Ç–∞–≤—å —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ –ø—É–Ω–∫—Ç–∞ —Å–ø–∏—Å–∫–∞\n"
        "- –î–ª—è –∏–º–µ–Ω/—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: —Ä–∞–∑–¥–µ–ª—è–π —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π (;)\n"
        "- –î–ª—è –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏: —Å–æ—Ö—Ä–∞–Ω—è–π —Ñ–æ—Ä–º–∞—Ç –∫–∞–∫ —É–ø–æ–º—è–Ω—É—Ç –≤ —Ç–µ–∫—Å—Ç–µ\n\n"
        
        "üéØ –ò–ó–í–õ–ï–ß–ï–ù–ò–ï –î–ê–ù–ù–´–•:\n"
        "- –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û —Ñ–∞–∫—Ç—ã –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        "- –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É–ø–æ–º—è–Ω—É—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (—Ä–æ–ª—å, —Å—Ä–æ–∫, —Å—É–º–º–∞) ‚Äî —É–∫–∞–∂–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é\n"
        "- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã –∏–ª–∏ –Ω–µ—è—Å–Ω—ã ‚Äî –ø–∏—à–∏ '–ù–µ —É–∫–∞–∑–∞–Ω–æ'\n"
        "- –£–±–∏—Ä–∞–π –¥—É–±–ª–∏–∫–∞—Ç—ã, –æ–±—ä–µ–¥–∏–Ω—è–π –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –ø—É–Ω–∫—Ç—ã\n"
        "- –°–æ—Ö—Ä–∞–Ω—è–π —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—é: –ø–æ—Ä—è–¥–æ–∫ –ø—É–Ω–∫—Ç–æ–≤ = –ø–æ—Ä—è–¥–æ–∫ –≤ —Ç–µ–∫—Å—Ç–µ\n\n"
        
        "üîç –û–ë–†–ê–ë–û–¢–ö–ê –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –ì–û–í–û–†–Ø–©–ò–•:\n"
        "- –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–π –º–µ—Ç–∫–∏ '–°–ø–∏–∫–µ—Ä 1:', '–°–ø–∏–∫–µ—Ä 2:' –∏ —Ç.–¥.\n"
        "- –û–ø—Ä–µ–¥–µ–ª—è–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∏—Ö –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π\n"
        "- –£–∫–∞–∑—ã–≤–∞–π –∫—Ç–æ –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –≤–∑—è–ª –Ω–∞ —Å–µ–±—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ\n"
        "- –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã –∏–º–µ–Ω–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –ò–•, –∞ –Ω–µ –º–µ—Ç–∫–∏ —Å–ø–∏–∫–µ—Ä–æ–≤\n"
        "- –§–æ—Ä–º–∞—Ç –∑–∞–¥–∞—á–∏: '–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–º—è –§–∞–º–∏–ª–∏—è' (–±–µ–∑ —Ä–æ–ª–∏!)\n"
        "- –§–æ—Ä–º–∞—Ç —Ä–µ—à–µ–Ω–∏—è: '–†–µ—à–µ–Ω–∏–µ. –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä: –ò–º—è –§–∞–º–∏–ª–∏—è' (–µ—Å–ª–∏ –≤–∞–∂–Ω–æ –∫—Ç–æ –ø—Ä–∏–Ω—è–ª)\n\n"
        
        "üßπ –ß–¢–û –û–¢–§–ò–õ–¨–¢–†–û–í–´–í–ê–¢–¨:\n"
        "- –ú–µ–∂–¥–æ–º–µ—Ç–∏—è, –∑–∞–ø–∏–Ω–∫–∏, –ø–æ–≤—Ç–æ—Ä—ã —Å–ª–æ–≤\n"
        "- –í–≤–æ–¥–Ω—ã–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ —Å–º—ã—Å–ª–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏\n"
        "- –†–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–µ –ø–æ —Ç–µ–º–µ –≤—Å—Ç—Ä–µ—á–∏\n"
        "- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ('–Ω–µ —Å–ª—ã—à–Ω–æ', '–ø–æ–≤—Ç–æ—Ä–∏—Ç–µ' –∏ —Ç.–¥.)\n\n"
        
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        "–ü–†–ò–ú–ï–†–´ –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        
        "‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:\n"
        "{\n"
        "  \"participants\": \"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤\\n–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –°–∏–¥–æ—Ä–æ–≤\",\n"
        "  \"main_topic\": \"–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞ Q2 2024\",\n"
        "  \"decisions\": \"- –£–≤–µ–ª–∏—á–∏—Ç—å –±—é–¥–∂–µ—Ç –Ω–∞ digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–∞ 30%\\n- –£—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö\\n- –û—Ç–ª–æ–∂–∏—Ç—å –∑–∞–ø—É—Å–∫ —Ä–µ–∫–ª–∞–º—ã –Ω–∞ –¢–í –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–≤–∞—Ä—Ç–∞–ª–∞\",\n"
        "  \"action_items\": \"- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –Ω–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫ 15 –º–∞—Ä—Ç–∞ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞\\n- –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –±—é–¥–∂–µ—Ç —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –æ—Ç–¥–µ–ª–æ–º ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤\\n- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ê–ª–µ–∫—Å–µ–π –°–∏–¥–æ—Ä–æ–≤\",\n"
        "  \"deadlines\": \"- –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: 15 –º–∞—Ä—Ç–∞ 2024\\n- –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞: –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏\\n- –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤: –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ–≤–µ—â–∞–Ω–∏—é\",\n"
        "  \"issues\": \"- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –æ—Ö–≤–∞—Ç —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ —Ç–µ–∫—É—â–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏\\n- –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞\\n- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—Ä–µ–∞—Ç–∏–≤–æ–≤\"\n"
        "}\n\n"
        "–û–ë–†–ê–¢–ò–¢–ï –í–ù–ò–ú–ê–ù–ò–ï: –í action_items —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ò–ú–ï–ù–ê –±–µ–∑ —Ä–æ–ª–µ–π –≤ —Å–∫–æ–±–∫–∞—Ö!\n\n"
        
        "‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:\n"
        "{\n"
        "  \"participants\": [\"–ò–≤–∞–Ω\", \"–ú–∞—Ä–∏—è\"],  ‚ùå –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏\n"
        "  \"decisions\": \"1) –†–µ—à–µ–Ω–∏–µ –æ–¥–∏–Ω 2) –†–µ—à–µ–Ω–∏–µ –¥–≤–∞.\",  ‚ùå –Ω—É–º–µ—Ä–∞—Ü–∏—è + —Ç–æ—á–∫–∏\n"
        "  \"action_items\": \"–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é (–ú–∞—Ä–∏—è)\",  ‚ùå –±–µ–∑ –¥–µ—Ñ–∏—Å–∞, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç\n"
        "  \"deadlines\": \"–°—Ä–æ—á–Ω–æ, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ\",  ‚ùå –Ω–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏, —Ö–æ—Ç—è –æ–Ω–∞ –º–æ–≥–ª–∞ –±—ã—Ç—å\n"
        "  \"extra_field\": \"...\",  ‚ùå –ø–æ–ª–µ –Ω–µ –∏–∑ —Å–ø–∏—Å–∫–∞\n"
        "  \"budget\": \"50000 —Ä—É–±–ª–µ–π (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)\"  ‚ùå –¥–æ–º—ã—Å–ª—ã –≤ —Å–∫–æ–±–∫–∞—Ö\n"
        "}\n\n"
        
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        "–°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ü–†–ê–í–ò–õ–ê –ü–û –¢–ò–ü–ê–ú –ü–û–õ–ï–ô\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        f"{_build_field_specific_rules(template_variables)}\n\n"
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        
        "–ù–ê–ß–ò–ù–ê–ô –ê–ù–ê–õ–ò–ó. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ JSON –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.\n"
    )
    return user_prompt


class OpenAIProvider(LLMProvider):
    """–ü—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è OpenAI GPT"""
    
    def __init__(self):
        self.client = None
        self.http_client = None
        if settings.openai_api_key:
            openai.api_key = settings.openai_api_key
            # –°–æ–∑–¥–∞–µ–º HTTP –∫–ª–∏–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SSL –∏ —Ç–∞–π–º–∞—É—Ç–æ–º –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            import httpx
            self.http_client = httpx.Client(verify=settings.ssl_verify, timeout=settings.llm_timeout_seconds)
            self.client = openai.OpenAI(
                api_key=settings.openai_api_key,
                base_url=settings.openai_base_url,
                http_client=self.http_client
            )
    
    def is_available(self) -> bool:
        return self.client is not None and settings.openai_api_key is not None
    
    async def generate_protocol(self, transcription: str, template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø–æ–ª—å–∑—É—è OpenAI GPT"""
        if not self.is_available():
            raise ValueError("OpenAI API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")

        # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
        speaker_mapping = kwargs.get('speaker_mapping')
        meeting_topic = kwargs.get('meeting_topic')
        meeting_date = kwargs.get('meeting_date')
        meeting_time = kwargs.get('meeting_time')
        participants = kwargs.get('participants')

        # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç—ã
        system_prompt = _build_system_prompt()
        meeting_structure = kwargs.get('meeting_structure')
        user_prompt = _build_user_prompt(
            transcription,
            template_variables,
            diarization_data,
            speaker_mapping,
            meeting_topic,
            meeting_date,
            meeting_time,
            participants,
            meeting_structure
        )
        
        try:
            # –í—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –º–æ–¥–µ–ª–∏, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –∫–ª—é—á
            selected_model = settings.openai_model
            selected_base_url = settings.openai_base_url or "https://api.openai.com/v1"
            model_key = kwargs.get("openai_model_key")
            if model_key:
                try:
                    preset = next((p for p in settings.openai_models if p.key == model_key), None)
                except Exception:
                    preset = None
                if preset:
                    selected_model = preset.model
                    if getattr(preset, 'base_url', None):
                        selected_base_url = preset.base_url
            
            # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ base_url (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º self.client)
            client = self.client
            if client is None or (selected_base_url and getattr(client, 'base_url', None) != selected_base_url):
                client = openai.OpenAI(
                    api_key=settings.openai_api_key,
                    base_url=selected_base_url,
                    http_client=self.http_client
                )

            # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (–±–µ–∑ —É—Ç–µ—á–∫–∏ –ø–æ–ª–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏)
            base_url = selected_base_url or "https://api.openai.com/v1"
            sys_msg = "–¢—ã - —Å—Ç—Ä–æ–≥–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –≤—Å—Ç—Ä–µ—á..."
            user_len = len(user_prompt)
            transcript_len = len(transcription)
            vars_count = len(template_variables)
            logger.info(
                f"OpenAI –∑–∞–ø—Ä–æ—Å: model={selected_model}, base_url={base_url}, "
                f"vars={vars_count}, transcription_chars={transcript_len}, prompt_chars={user_len}"
            )
            _snippet = user_prompt[:400].replace("\n", " ")
            logger.debug(f"OpenAI prompt (—Ñ—Ä–∞–≥–º–µ–Ω—Ç 400): {_snippet}...")

            # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
            if settings.llm_debug_log:
                logger.debug("=" * 80)
                logger.debug("[DEBUG] OpenAI REQUEST - generate_protocol")
                logger.debug("=" * 80)
                logger.debug(f"Model: {selected_model}")
                logger.debug(f"Base URL: {selected_base_url}")
                logger.debug(f"Temperature: 0.1")
                logger.debug(f"Extra headers: {extra_headers}")
                logger.debug("-" * 80)
                logger.debug(f"System prompt:\n{system_prompt}")
                logger.debug("-" * 80)
                logger.debug(f"User prompt:\n{user_prompt}")
                logger.debug("=" * 80)

            logger.info(f"–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –≤ OpenAI —Å –º–æ–¥–µ–ª—å—é {selected_model}")
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º extra_headers –¥–ª—è –∞—Ç—Ä–∏–±—É—Ü–∏–∏
            extra_headers = {}
            if settings.http_referer:
                extra_headers["HTTP-Referer"] = settings.http_referer
            if settings.x_title:
                extra_headers["X-Title"] = settings.x_title
            
            # –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å event loop
            async def _call_openai():
                return await asyncio.to_thread(
                    client.chat.completions.create,
                    model=selected_model,
                    messages=[
                        {"role": "system", "content": system_prompt},
                        {"role": "user", "content": user_prompt}
                    ],
                    temperature=0.1,
                    response_format={"type": "json_schema", "json_schema": PROTOCOL_SCHEMA},
                    extra_headers=extra_headers
                )
            
            try:
                response = await _call_openai()
            except openai.APIStatusError as e:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫—É 402 - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
                if e.status_code == 402:
                    error_message = e.message
                    # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞
                    if hasattr(e, 'response') and e.response:
                        try:
                            error_body = e.response.json()
                            if 'error' in error_body and 'message' in error_body['error']:
                                error_message = error_body['error']['message']
                        except:
                            pass
                    logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM: {error_message}")
                    raise LLMInsufficientCreditsError(
                        message=error_message,
                        provider="openai",
                        model=selected_model
                    )
                # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ API –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–ª—å—à–µ
                raise
            
            logger.info("–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç OpenAI API")
            
            content = response.choices[0].message.content
            
            # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
            if settings.llm_debug_log:
                logger.debug("=" * 80)
                logger.debug("[DEBUG] OpenAI RESPONSE - generate_protocol")
                logger.debug("=" * 80)
                if hasattr(response, 'usage'):
                    logger.debug(f"Usage: {response.usage}")
                finish_reason = response.choices[0].finish_reason
                logger.debug(f"Finish reason: {finish_reason}")
                logger.debug("-" * 80)
                logger.debug(f"Content:\n{content}")
                logger.debug("=" * 80)
            logger.info(f"–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç OpenAI (–¥–ª–∏–Ω–∞: {len(content) if content else 0}): {content[:200] if content else 'None'}...")
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä JSON
            return safe_json_parse(content, context="OpenAI API response")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å OpenAI API: {e}")
            raise


class AnthropicProvider(LLMProvider):
    """–ü—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è Anthropic Claude"""
    
    def __init__(self):
        self.client = None
        if settings.anthropic_api_key:
            # –°–æ–∑–¥–∞–µ–º HTTP –∫–ª–∏–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SSL –∏ —Ç–∞–π–º–∞—É—Ç–æ–º –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            import httpx
            http_client = httpx.Client(verify=settings.ssl_verify, timeout=settings.llm_timeout_seconds)
            self.client = Anthropic(
                api_key=settings.anthropic_api_key,
                http_client=http_client
            )
    
    def is_available(self) -> bool:
        return self.client is not None and settings.anthropic_api_key is not None
    
    async def generate_protocol(self, transcription: str, template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø–æ–ª—å–∑—É—è Anthropic Claude"""
        if not self.is_available():
            raise ValueError("Anthropic API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")

        # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
        speaker_mapping = kwargs.get('speaker_mapping')
        meeting_topic = kwargs.get('meeting_topic')
        meeting_date = kwargs.get('meeting_date')
        meeting_time = kwargs.get('meeting_time')
        participants = kwargs.get('participants')

        # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç—ã
        system_prompt = _build_system_prompt()
        meeting_structure = kwargs.get('meeting_structure')
        prompt = _build_user_prompt(
            transcription,
            template_variables,
            diarization_data,
            speaker_mapping,
            meeting_topic,
            meeting_date,
            meeting_time,
            participants,
            meeting_structure
        )
        
        try:
            base_url = "Anthropic SDK"
            user_len = len(prompt)
            transcript_len = len(transcription)
            vars_count = len(template_variables)
            logger.info(
                f"Anthropic –∑–∞–ø—Ä–æ—Å: model=claude-3-haiku-20240307, base={base_url}, "
                f"vars={vars_count}, transcription_chars={transcript_len}, prompt_chars={user_len}"
            )
            _a_snippet = prompt[:400].replace("\n", " ")
            logger.debug(f"Anthropic prompt (—Ñ—Ä–∞–≥–º–µ–Ω—Ç 400): {_a_snippet}...")
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º extra_headers –¥–ª—è –∞—Ç—Ä–∏–±—É—Ü–∏–∏
            extra_headers = {}
            if settings.http_referer:
                extra_headers["HTTP-Referer"] = settings.http_referer
            if settings.x_title:
                extra_headers["X-Title"] = settings.x_title
            
            # –í—ã–ø–æ–ª–Ω—è–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ Anthropic –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
            async def _call_anthropic():
                return await asyncio.to_thread(
                    self.client.messages.create,
                    model="claude-3-haiku-20240307",
                    max_tokens=2000,
                    temperature=0.1,
                    system=system_prompt,
                    messages=[
                        {"role": "user", "content": prompt}
                    ],
                    extra_headers=extra_headers
                )
            response = await _call_anthropic()
            
            content = response.content[0].text
            logger.info(f"–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç Anthropic (–¥–ª–∏–Ω–∞: {len(content) if content else 0}): {content[:200] if content else 'None'}...")
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä JSON
            return safe_json_parse(content, context="Anthropic API response")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Anthropic API: {e}")
            raise


class YandexGPTProvider(LLMProvider):
    """–ü—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è Yandex GPT"""
    
    def __init__(self):
        self.api_key = settings.yandex_api_key
        self.folder_id = settings.yandex_folder_id
    
    def is_available(self) -> bool:
        return self.api_key is not None and self.folder_id is not None
    
    async def generate_protocol(self, transcription: str, template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø–æ–ª—å–∑—É—è Yandex GPT"""
        if not self.is_available():
            raise ValueError("Yandex GPT API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")

        # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
        speaker_mapping = kwargs.get('speaker_mapping')
        meeting_topic = kwargs.get('meeting_topic')
        meeting_date = kwargs.get('meeting_date')
        meeting_time = kwargs.get('meeting_time')
        participants = kwargs.get('participants')

        # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç—ã
        system_prompt = _build_system_prompt()
        meeting_structure = kwargs.get('meeting_structure')
        prompt = _build_user_prompt(
            transcription,
            template_variables,
            diarization_data,
            speaker_mapping,
            meeting_topic,
            meeting_date,
            meeting_time,
            participants,
            meeting_structure
        )
        
        headers = {
            "Authorization": f"Api-Key {self.api_key}",
            "Content-Type": "application/json"
        }
        
        if settings.http_referer:
            headers["Referer"] = settings.http_referer
        if settings.x_title:
            headers["X-Title"] = settings.x_title
        
        data = {
            "modelUri": f"gpt://{self.folder_id}/yandexgpt-lite",
            "completionOptions": {
                "stream": False,
                "temperature": 0.1,
                "maxTokens": 2000
            },
            "messages": [
                {
                    "role": "system",
                    "text": system_prompt
                },
                {
                    "role": "user", 
                    "text": prompt
                }
            ]
        }
        
        try:
            async with httpx.AsyncClient(verify=settings.ssl_verify) as client:
                response = await client.post(
                    "https://llm.api.cloud.yandex.net/foundationModels/v1/completion",
                    headers=headers,
                    json=data,
                    timeout=settings.llm_timeout_seconds
                )
                response.raise_for_status()
                
                result = response.json()
                content = result["result"]["alternatives"][0]["message"]["text"]
                logger.info(f"–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç Yandex GPT (–¥–ª–∏–Ω–∞: {len(content) if content else 0}): {content[:200] if content else 'None'}...")
                
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä JSON
                return safe_json_parse(content, context="Yandex GPT API response")
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Yandex GPT API: {e}")
            raise


class LLMManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏"""
    
    def __init__(self):
        self.providers = {
            "openai": OpenAIProvider(),
            "anthropic": AnthropicProvider(),
            "yandex": YandexGPTProvider()
        }
    
    def get_available_providers(self) -> Dict[str, str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤"""
        available = {}
        provider_names = {
            "openai": "OpenAI GPT",
            "anthropic": "Anthropic Claude",
            "yandex": "Yandex GPT"
        }
        
        for key, provider in self.providers.items():
            if provider.is_available():
                available[key] = provider_names[key]
        
        return available
    
    async def generate_protocol(self, provider_name: str, transcription: str, 
                              template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –∏—Å–ø–æ–ª—å–∑—É—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞"""
        if provider_name not in self.providers:
            raise ValueError(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä: {provider_name}")
        
        provider = self.providers[provider_name]
        if not provider.is_available():
            raise ValueError(f"–ü—Ä–æ–≤–∞–π–¥–µ—Ä {provider_name} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
        
        # –ü–µ—Ä–µ–¥–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, openai_model_key)
        return await provider.generate_protocol(transcription, template_variables, diarization_data, **kwargs)
    
    async def generate_protocol_with_fallback(self, preferred_provider: str, transcription: str, 
                                            template_variables: Dict[str, str], diarization_data: Optional[Dict[str, Any]] = None, **kwargs) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏"""
        available_providers = list(self.get_available_providers().keys())
        
        if not available_providers:
            raise ValueError("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤")
        
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
        providers_to_try = [preferred_provider] if preferred_provider in available_providers else []
        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ
        for provider in available_providers:
            if provider not in providers_to_try:
                providers_to_try.append(provider)
        
        last_error = None
        for provider_name in providers_to_try:
            try:
                logger.info(f"–ü–æ–ø—ã—Ç–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º: {provider_name}")
                result = await self.generate_protocol(provider_name, transcription, template_variables, diarization_data, **kwargs)
                logger.info(f"–£—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º: {provider_name}")
                return result
            except Exception as e:
                last_error = e
                logger.warning(f"–û—à–∏–±–∫–∞ —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º {provider_name}: {e}")
                continue
        
        # –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏
        raise ValueError(f"–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏. –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: {last_error}")


# ===================================================================
# –î–í–£–•–≠–¢–ê–ü–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–†–û–¢–û–ö–û–õ–ê
# ===================================================================

def _build_extraction_prompt(
    transcription: str,
    template_variables: Dict[str, str],
    diarization_data: Optional[Dict[str, Any]] = None,
    speaker_mapping: Optional[Dict[str, str]] = None,
    meeting_topic: Optional[str] = None,
    meeting_date: Optional[str] = None,
    meeting_time: Optional[str] = None,
    participants: Optional[List[Dict[str, str]]] = None,
    meeting_structure = None,  # MeetingStructure, –Ω–æ –∏–∑–±–µ–≥–∞–µ–º circular import
) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    """
    # –ë–ª–æ–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å —É—á—ë—Ç–æ–º –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏)
    if diarization_data and diarization_data.get("formatted_transcript"):
        transcription_text = (
            "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –≥–æ–≤–æ—Ä—è—â–∏—Ö:\n"
            f"{diarization_data['formatted_transcript']}\n\n"
            "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n"
            f"- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–≤–æ—Ä—è—â–∏—Ö: {diarization_data.get('total_speakers', '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
            f"- –°–ø–∏—Å–æ–∫ –≥–æ–≤–æ—Ä—è—â–∏—Ö: {', '.join(diarization_data.get('speakers', []))}\n\n"
        )
    else:
        transcription_text = f"–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è:\n{transcription}\n\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å–ø–∏–∫–µ—Ä–æ–≤
    participants_info = ""
    if speaker_mapping:
        participants_info = "\n–£–ß–ê–°–¢–ù–ò–ö–ò –í–°–¢–†–ï–ß–ò:\n"
        for speaker_id, participant_name in speaker_mapping.items():
            participants_info += f"- {speaker_id} = {participant_name}\n"
        participants_info += "\n‚ö†Ô∏è –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –£–ß–ê–°–¢–ù–ò–ö–ê–ú:\n"
        participants_info += "- –ò—Å–ø–æ–ª—å–∑—É–π –†–ï–ê–õ–¨–ù–´–ï –ò–ú–ï–ù–ê –≤–º–µ—Å—Ç–æ –º–µ—Ç–æ–∫ —Å–ø–∏–∫–µ—Ä–æ–≤\n"
        participants_info += "- –ü—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–∏—à–∏ –¢–û–õ–¨–ö–û –ò–ú–Ø (–±–µ–∑ —Ä–æ–ª–∏ –≤ —Å–∫–æ–±–∫–∞—Ö)\n"
        participants_info += "- –§–æ—Ä–º–∞—Ç: '–ó–∞–¥–∞—á–∞ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–º—è –§–∞–º–∏–ª–∏—è'\n\n"
        participants_info += "üìå –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù:\n"
        participants_info += "–ï—Å–ª–∏ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è ‚Äî\n"
        participants_info += "—Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–π –∏—Ö —Å –ø–æ–ª–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ.\n\n"
        participants_info += "–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏–∫–∏ (–ø—Ä–∏–º–µ–Ω—è–π –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∏–∑ —Å–ø–∏—Å–∫–∞):\n"
        participants_info += "   ‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –ü–æ —Ñ–∞–º–∏–ª–∏–∏: –¢–∏–º—á–µ–Ω–∫–æ‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–º—è: –ê–ª–µ–∫—Å–µ–π‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ\n\n"
        participants_info += "‚ö° –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –Ω–µ —Ç–æ–ª—å–∫–æ —ç—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã!\n"
        participants_info += "‚ö° –í –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–û–ï –ò–ú–Ø –∏–∑ —Å–ø–∏—Å–∫–∞.\n\n"
    elif participants:
        # –ï—Å–ª–∏ –Ω–µ—Ç speaker_mapping, –Ω–æ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        participants_info = "\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
        participants_info += "‚ïë  üéØ –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í (–û–ë–Ø–ó–ê–¢–ï–õ–ï–ù –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ) ‚ïë\n"
        participants_info += "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n"
        from src.services.participants_service import participants_service
        participants_info += participants_service.format_participants_for_llm(participants)
        participants_info += "\n\nüö® –°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê:\n"
        participants_info += "1. –¢–û–õ–¨–ö–û –∏–º–µ–Ω–∞ –ò–ó –°–ü–ò–°–ö–ê –í–´–®–ï! –§–æ—Ä–º–∞—Ç: '–ò–º—è –§–∞–º–∏–ª–∏—è'\n"
        participants_info += "2. –ó–ê–ü–†–ï–©–ï–ù–û: '–ö–æ–ª–ª–µ–≥–∞ –∏–∑ –û–†–¢', —Ç–æ–ª—å–∫–æ –∏–º—è ('–°–æ—Ñ—å—è'), —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è ('–í–∏–∫—É–ª–∏–Ω')\n"
        participants_info += "3. –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π:\n"
        participants_info += "   ‚Ä¢ '–°–≤–µ—Ç–∞'/'–°–≤–µ—Ç–æ—á–∫–∞' ‚Üí –Ω–∞–π–¥–∏ '–°–≤–µ—Ç–ª–∞–Ω–∞' ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–õ–µ—à–∞'/'–ê–ª—ë—à–∞' ‚Üí –Ω–∞–π–¥–∏ '–ê–ª–µ–∫—Å–µ–π' ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ –§–∞–º–∏–ª–∏—è ('–í–∏–∫—É–ª–∏–Ω') ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π '–ò–º—è –§–∞–º–∏–ª–∏—è'\n"
        participants_info += "   ‚Ä¢ –ò–º—è ('–ú–∞—Ä–∞—Ç') ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π '–ò–º—è –§–∞–º–∏–ª–∏—è'\n"
        participants_info += "4. –ï—Å–ª–∏ –ù–ï –º–æ–∂–µ—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ - –ù–ï –≤–∫–ª—é—á–∞–π\n\n"
        participants_info += "‚ö° –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–û–ï –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞!\n\n"
    else:
        # –ù–µ—Ç –Ω–∏ speaker_mapping, –Ω–∏ participants - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        participants_info = "\n‚öôÔ∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –£–ß–ê–°–¢–ù–ò–ö–û–í –ò–ó –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        participants_info += "–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –û–ø—Ä–µ–¥–µ–ª–∏ –∏–º–µ–Ω–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.\n\n"
        participants_info += "üìã –ü–†–ê–í–ò–õ–ê –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø:\n\n"
        participants_info += "1Ô∏è‚É£ –ò–©–ò –Ø–í–ù–´–ï –£–ü–û–ú–ò–ù–ê–ù–ò–Ø:\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è: '–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', '–Ø ‚Äî –ú–∞—Ä–∏—è'\n"
        participants_info += "   ‚Ä¢ –û–±—Ä–∞—â–µ–Ω–∏—è: '–°–≤–µ—Ç–∞, –∫–∞–∫ –¥—É–º–∞–µ—à—å?', '–ü–µ—Ç—Ä–æ–≤, —Ä–∞—Å—Å–∫–∞–∂–∏ –æ –∑–∞–¥–∞—á–µ'\n"
        participants_info += "   ‚Ä¢ –£–ø–æ–º–∏–Ω–∞–Ω–∏—è: '–ö–∞–∫ —Å–∫–∞–∑–∞–ª –ò–≤–∞–Ω...', '–ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å —É –ú–∞—Ä–∏–∏'\n\n"
        participants_info += "2Ô∏è‚É£ –§–û–†–ú–ê–¢ –ò–ú–ï–ù:\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ: '–ò–º—è –§–∞–º–∏–ª–∏—è' (–ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞)\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ —Ç–æ–ª—å–∫–æ –∏–º—è: '–ò–≤–∞–Ω'\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è: '–ü–µ—Ç—Ä–æ–≤'\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π, –í–æ–ª–æ–¥—è‚Üí–í–ª–∞–¥–∏–º–∏—Ä\n\n"
        participants_info += "3Ô∏è‚É£ –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –°–û –°–ü–ò–ö–ï–†–ê–ú–ò:\n"
        participants_info += "   ‚Ä¢ –°–æ–ø–æ—Å—Ç–∞–≤—å –∫–∞–∂–¥—É—é –º–µ—Ç–∫—É (SPEAKER_1, SPEAKER_2...) —Å –∏–º–µ–Ω–µ–º –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–º—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ù–ï–í–û–ó–ú–û–ñ–ù–û - –æ—Å—Ç–∞–≤—å –º–µ—Ç–∫—É —Å–ø–∏–∫–µ—Ä–∞ –∫–∞–∫ –µ—Å—Ç—å\n"
        participants_info += "   ‚Ä¢ –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤\\n–°–ü–ï–ê–ö–ïR_2\\n–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞\\n–°–ü–ï–ê–ö–ïR_4'\n\n"
        participants_info += "4Ô∏è‚É£ –°–¢–†–û–ì–ò–ï –ó–ê–ü–†–ï–¢–´:\n"
        participants_info += "   ‚ùå –ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "   ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π '–£—á–∞—Å—Ç–Ω–∏–∫ 1', '–ö–æ–ª–ª–µ–≥–∞', '–ß–µ–ª–æ–≤–µ–∫ –ê', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π'\n"
        participants_info += "   ‚ùå –ù–ï –¥—É–±–ª–∏—Ä—É–π: –µ—Å–ª–∏ –°–≤–µ—Ç–∞ = SPEAKER_1, –Ω–µ –¥–æ–±–∞–≤–ª—è–π –°–≤–µ—Ç–ª–∞–Ω—É –æ—Ç–¥–µ–ª—å–Ω–æ\n"
        participants_info += "   ‚ùå –ù–ï –∑–∞–º–µ–Ω—è–π SPEAKER_N –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–∏–ø–∞ '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –≤—Å—Ç—Ä–µ—á–∏'\n\n"
        participants_info += "üí° –ü–û–î–°–ö–ê–ó–ö–ò:\n"
        participants_info += "   ‚Ä¢ –ù–∞—á–∞–ª–æ –≤—Å—Ç—Ä–µ—á–∏ - —á–∞—Å—Ç–æ —Ç–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è\n"
        participants_info += "   ‚Ä¢ –û–±—Ä–∞—â–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏ - —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫\n"
        participants_info += "   ‚Ä¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç: '–Ω–∞—à —Ç–∏–º–ª–∏–¥ –ê–ª–µ–∫—Å–µ–π', '–º–µ–Ω–µ–¥–∂–µ—Ä –ú–∞—Ä–∏—è'\n"
        participants_info += "   ‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ—Ç? ‚Üí –û—Å—Ç–∞–≤—å SPEAKER_N\n\n"

    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å—Ç—Ä–µ—á–µ
    meeting_info = ""
    if meeting_topic or meeting_date or meeting_time:
        meeting_info = "\n–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–°–¢–†–ï–ß–ï:\n"
        if meeting_topic:
            meeting_info += f"- –¢–µ–º–∞: {meeting_topic}\n"
        if meeting_date:
            meeting_info += f"- –î–∞—Ç–∞: {meeting_date}\n"
        if meeting_time:
            meeting_info += f"- –í—Ä–µ–º—è: {meeting_time}\n"
        meeting_info += "\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
    structure_info = ""
    if meeting_structure:
        structure_text = meeting_structure.format_for_llm_prompt()
        if structure_text:
            structure_info = structure_text
    
    variables_str = "\n".join([f"- {key}: {desc}" for key, desc in template_variables.items()])
    
    prompt = f"""–≠–¢–ê–ü 1: –ò–ó–í–õ–ï–ß–ï–ù–ò–ï –ò–ù–§–û–†–ú–ê–¶–ò–ò

{transcription_text}{structure_info}{participants_info}{meeting_info}

–ó–ê–î–ê–ß–ê:
–ò–∑–≤–ª–µ–∫–∏ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ–ª–µ–π:
{variables_str}

–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–ë–°–£–ñ–î–ï–ù–ò–Ø:
–ï—Å–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—à—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–∞–º/–∫–ª–∞—Å—Ç–µ—Ä–∞–º:
- –ù–ï –ø–∏—à–∏ —Å–ª–æ–≤–æ "–ö–ª–∞—Å—Ç–µ—Ä", —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º: "‚Ä¢ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã**"
- –ö–∞–∂–¥—É—é –∏–¥–µ—é/–≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ/–ø–æ–∑–∏—Ü–∏—é —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
- –§–æ—Ä–º–∞—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è: "–ò–º—è –ê–≤—Ç–æ—Ä–∞: —Ç–µ–∫—Å—Ç" (–±–µ–∑ —Å–ª–æ–≤–∞ "–ò–¥–µ—è", –±–µ–∑ —Å–∫–æ–±–æ–∫)
- –ú–µ–∂–¥—É —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

–ü—Ä–∏–º–µ—Ä—ã:
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ **–í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞: –ø–æ–¥–¥–µ—Ä–∂–∞–ª–∞ –∏–¥–µ—é

‚úó –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ –ö–ª–∞—Å—Ç–µ—Ä ¬´–í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã¬ª: –ò–¥–µ—è (–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ): –ø—Ä–µ–¥–ª–æ–∂–∏–ª...

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
1. –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û —Ñ–∞–∫—Ç—ã –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
2. –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ —è–≤–Ω–æ - –ø–∏—à–∏ "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
3. –°–æ—Ö—Ä–∞–Ω—è–π —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫
4. –ù–ï –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π –∏ –ù–ï –¥–æ–±–∞–≤–ª—è–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–≤–æ–¥—ã
5. –î–ª—è —Å–ø–∏—Å–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç: "- –ø—É–Ω–∫—Ç1\\n- –ø—É–Ω–∫—Ç2"
6. –î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: –∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ \\n, –ë–ï–ó —Ä–æ–ª–µ–π!

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ü–†–ê–í–ò–õ–ê –ü–û –¢–ò–ü–ê–ú –ü–û–õ–ï–ô
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

{_build_field_specific_rules(template_variables)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –í–°–ï –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ü–†–û–°–¢–´–ú–ò –°–¢–†–û–ö–ê–ú–ò (string)
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã {{}} –∏–ª–∏ –º–∞—Å—Å–∏–≤—ã [] –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π
- –î–∞—Ç—ã: "20 –æ–∫—Ç—è–±—Ä—è 2024", –ù–ï {{"day": 20, "month": "–æ–∫—Ç—è–±—Ä—å"}}
- –£—á–∞—Å—Ç–Ω–∏–∫–∏: "–ò–º—è1\\n–ò–º—è2\\n–ò–º—è3", –ù–ï [{{"name": "–ò–º—è"}}], –ù–ï "–ò–º—è, —Ä–æ–ª—å; –ò–º—è2"
- –°–ø–∏—Å–∫–∏: "- —ç–ª–µ–º–µ–Ω—Ç1\\n- —ç–ª–µ–º–µ–Ω—Ç2", –ù–ï ["—ç–ª–µ–º–µ–Ω—Ç1", "—ç–ª–µ–º–µ–Ω—Ç2"]

–ü–†–ò–ú–ï–† –ü–†–ê–í–ò–õ–¨–ù–û–ì–û JSON:
{{
  "date": "20 –æ–∫—Ç—è–±—Ä—è 2024",
  "participants": "–û–∫—Å–∞–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞\\n–ì–∞–ª–∏–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤",
  "decisions": "- –†–µ—à–µ–Ω–∏–µ 1\\n- –†–µ—à–µ–Ω–∏–µ 2"
}}

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –°–¢–†–£–ö–¢–£–†–ê –û–¢–í–ï–¢–ê:
–¢–≤–æ–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å JSON —Å –¢–†–ï–ú–Ø –ø–æ–ª—è–º–∏:
{{
  "extracted_data": {{
    "–ø–æ–ª–µ1": "–∑–Ω–∞—á–µ–Ω–∏–µ1",
    "–ø–æ–ª–µ2": "–∑–Ω–∞—á–µ–Ω–∏–µ2",
    ...–≤—Å–µ –ø–æ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ...
  }},
  "confidence_score": 0.85,
  "extraction_notes": "–∫—Ä–∞—Ç–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è"
}}

–ì–î–ï:
- extracted_data: –æ–±—ä–µ–∫—Ç —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–∫–ª—é—á–∏ = –ø–æ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ)
- confidence_score: —Ç–≤–æ—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ (—á–∏—Å–ª–æ –æ—Ç 0.0 –¥–æ 1.0)
- extraction_notes: –∫—Ä–∞—Ç–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏ –æ —Å–ª–æ–∂–Ω–æ—Å—Ç—è—Ö –∏–ª–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö

–í–ê–ñ–ù–û: –ü–æ–ª–µ extracted_data –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –í–°–ï –∫–ª—é—á–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–ª–µ–π!
–ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ - –ø–∏—à–∏ "–ù–µ —É–∫–∞–∑–∞–Ω–æ", –Ω–æ –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å!

–í—ã–≤–µ–¥–∏ –¢–û–õ–¨–ö–û JSON –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."""

    return prompt


def _build_reflection_prompt(
    extracted_data: Dict[str, Any],
    transcription: str,
    template_variables: Dict[str, str],
    diarization_analysis: Optional[Dict[str, Any]] = None
) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–ø–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É–ª—É—á—à–µ–Ω–∏–µ
    –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
    """
    from src.utils.context_extraction import extract_relevant_excerpts
    
    extracted_json = json.dumps(extracted_data, ensure_ascii=False, indent=2)
    
    # –°–æ–∫—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
    max_context_tokens = settings.max_context_tokens_stage2
    relevant_context = extract_relevant_excerpts(
        transcription,
        extracted_data,
        max_tokens=max_context_tokens
    )
    
    logger.info(f"Stage 2: —Å–æ–∫—Ä–∞—â–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å {len(transcription)} –¥–æ {len(relevant_context)} —Å–∏–º–≤–æ–ª–æ–≤")
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
    diarization_context = ""
    if diarization_analysis:
        speakers_info = diarization_analysis.get('speakers', {})
        if speakers_info:
            diarization_context = "\n\n–ê–ù–ê–õ–ò–ó –£–ß–ê–°–¢–ù–ò–ö–û–í:\n"
            for speaker_id, info in speakers_info.items():
                role = info.get('role', '—É—á–∞—Å—Ç–Ω–∏–∫')
                time_percent = info.get('speaking_time_percent', 0)
                diarization_context += f"- {speaker_id} ({role}): {time_percent:.1f}% –≤—Ä–µ–º–µ–Ω–∏\n"
    
    prompt = f"""–≠–¢–ê–ü 2: –ü–†–û–í–ï–†–ö–ê –ò –£–õ–£–ß–®–ï–ù–ò–ï

–ò–ó–í–õ–ï–ß–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï (—ç—Ç–∞–ø 1):
{extracted_json}
{diarization_context}

–†–ï–õ–ï–í–ê–ù–¢–ù–´–ï –§–†–ê–ì–ú–ï–ù–¢–´ –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò:
{relevant_context}


–ó–ê–î–ê–ß–ê:
–ü—Ä–æ–≤–µ—Ä—å –∏ —É–ª—É—á—à–∏ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è –∏—Å—Ö–æ–¥–Ω—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é:

1. –ü–†–û–í–ï–†–ö–ê –ü–û–õ–ù–û–¢–´:
   - –í—Å–µ –ª–∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –æ—Ç—Ä–∞–∂–µ–Ω—ã?
   - –ù–µ—Ç –ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –∑–∞–¥–∞—á –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º?
   - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–ª—è?

2. –ü–†–û–í–ï–†–ö–ê –¢–û–ß–ù–û–°–¢–ò:
   - –í—Å–µ –ª–∏ —Ñ–∞–∫—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏?
   - –ù–µ—Ç –ª–∏ –¥–æ–º—ã—Å–ª–æ–≤ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π?
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã –ª–∏ –∏–º–µ–Ω–∞ –∏ —Ç–µ—Ä–º–∏–Ω—ã?

3. –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –î–ò–ê–†–ò–ó–ê–¶–ò–ò:
   - –£–∫–∞–∑–∞–Ω—ã –ª–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –∑–∞–¥–∞—á–∏ –∏–∑ —á–∏—Å–ª–∞ —Å–ø–∏–∫–µ—Ä–æ–≤?
   - –û—Ç—Ä–∞–∂–µ–Ω –ª–∏ –≤–∫–ª–∞–¥ —Ä–∞–∑–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤?
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–æ–ª—è—Ö —Å–ø–∏–∫–µ—Ä–æ–≤?

4. –°–¢–†–£–ö–¢–£–†–ê:
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å–ø–∏—Å–∫–∏ (—Å –¥–µ—Ñ–∏—Å–∞–º–∏)?
   - –ù–µ—Ç –ª–∏ –ª–∏—à–Ω–µ–π –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏?
   - –õ–æ–≥–∏—á–µ–Ω –ª–∏ –ø–æ—Ä—è–¥–æ–∫ –ø—É–Ω–∫—Ç–æ–≤?

5. –ü–†–û–í–ï–†–ö–ê –£–ß–ê–°–¢–ù–ò–ö–û–í –ò –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–´–•:
   - –£–∫–∞–∑–∞–Ω—ã –ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –≤–º–µ—Å—Ç–æ –º–µ—Ç–æ–∫ —Å–ø–∏–∫–µ—Ä–æ–≤?
   - –í –∑–∞–¥–∞—á–∞—Ö –∏ —Ä–µ—à–µ–Ω–∏—è—Ö –∏–º–µ–Ω–∞ –ë–ï–ó —Ä–æ–ª–µ–π –≤ —Å–∫–æ–±–∫–∞—Ö?
   - –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –ø–æ —Å–º—ã—Å–ª—É –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π?
   - –§–æ—Ä–º–∞—Ç: '–ó–∞–¥–∞—á–∞ ‚Äî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–º—è –§–∞–º–∏–ª–∏—è' (–ù–ï '–ò–º—è –§–∞–º–∏–ª–∏—è (—Ä–æ–ª—å)')

6. –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù:
   - –í—Å–µ –ª–∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ/—É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –ø–æ–ª–Ω—ã–µ –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤?
   - –í—Å–µ –ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ —Ñ–∞–º–∏–ª–∏–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –ø–æ–ª–Ω–æ–µ –∏–º—è –∏–∑ —Å–ø–∏—Å–∫–∞?
   - –ï—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —Ç–æ–ª—å–∫–æ –∏–º—è, –∞ –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö –ø–æ–ª–Ω–æ–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –ø–æ–ª–Ω–æ–µ?
   - –ü—Ä–æ–≤–µ—Ä—å –í–°–ï–• —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞, –Ω–µ —Ç–æ–ª—å–∫–æ –æ—á–µ–≤–∏–¥–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã!

–ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ:
- –ï—Å–ª–∏ –Ω–∞—à–µ–ª –ø—Ä–æ–ø—É—â–µ–Ω–Ω—É—é –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é - –¥–æ–±–∞–≤—å –µ—ë
- –ï—Å–ª–∏ –Ω–∞—à–µ–ª –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å - –∏—Å–ø—Ä–∞–≤—å –µ—ë
- –ï—Å–ª–∏ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É - —É–ª—É—á—à–∏
- –ï—Å–ª–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ - –¥–æ–±–∞–≤—å
- –ï—Å–ª–∏ –≤–∏–¥–∏—à—å —Ä–æ–ª—å –≤ —Å–∫–æ–±–∫–∞—Ö —É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ - –£–ë–ï–†–ò –µ—ë (–æ—Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ –∏–º—è)
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–æ–π –ù–ï–¢ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî –°–¢–†–£–ö–¢–£–†–ê –û–¢–í–ï–¢–ê:
–¢–≤–æ–π –æ—Ç–≤–µ—Ç –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å JSON —Å –¢–†–ï–ú–Ø –ø–æ–ª—è–º–∏:
{{
  "refined_data": {{
    "–ø–æ–ª–µ1": "—É–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ1",
    "–ø–æ–ª–µ2": "—É–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ2",
    ...–í–°–ï –∫–ª—é—á–∏ –∏–∑ extracted_data –≤—ã—à–µ...
  }},
  "reflection_notes": "—á—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ, –∫–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã",
  "quality_score": 0.9
}}

–ì–î–ï:
- refined_data: –æ–±—ä–µ–∫—Ç —Å –¢–ï–ú–ò –ñ–ï –∫–ª—é—á–∞–º–∏, —á—Ç–æ –≤ extracted_data, –Ω–æ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- reflection_notes: –æ–ø–∏—Å–∞–Ω–∏–µ –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- quality_score: –∏—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—á–∏—Å–ª–æ –æ—Ç 0.0 –¥–æ 1.0)

–í–ê–ñ–ù–û:
1. refined_data –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –í–°–ï –∫–ª—é—á–∏ –∏–∑ extracted_data!
2. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - —Å–∫–æ–ø–∏—Ä—É–π –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ extracted_data
3. quality_score –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 0 (–æ–±—ã—á–Ω–æ 0.7-0.95 –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)

–ü–†–ò–ú–ï–†:
{{
  "refined_data": {{
    "date": "27 –æ–∫—Ç—è–±—Ä—è 2024",
    "participants": "–ú–∞—Ä–∏–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤\\n–û–∫—Å–∞–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞",
    "decisions": "- –í–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å 27 –æ–∫—Ç—è–±—Ä—è\\n- –ü—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ–±–∏–Ω–∞—Ä –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤"
  }},
  "reflection_notes": "–ó–∞–º–µ–Ω–µ–Ω—ã –º–µ—Ç–∫–∏ SPEAKER –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞, –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤—Ç–æ—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ",
  "quality_score": 0.88
}}

–í—ã–≤–µ–¥–∏ –¢–û–õ–¨–ö–û JSON –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."""

    return prompt


async def generate_protocol_two_stage(
    manager: 'LLMManager',
    provider_name: str,
    transcription: str,
    template_variables: Dict[str, str],
    diarization_data: Optional[Dict[str, Any]] = None,
    diarization_analysis: Optional[Dict[str, Any]] = None,
    meeting_structure = None,  # MeetingStructure
    **kwargs
) -> Dict[str, Any]:
    """
    –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ + —Ä–µ—Ñ–ª–µ–∫—Å–∏—è
    
    Args:
        manager: –ú–µ–Ω–µ–¥–∂–µ—Ä LLM
        provider_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
        transcription: –¢–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        diarization_data: –î–∞–Ω–Ω—ã–µ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        diarization_analysis: –ê–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        
    Returns:
        –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
    """
    logger.info("–ù–∞—á–∞–ª–æ –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞")

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
    speaker_mapping = kwargs.get('speaker_mapping')
    meeting_topic = kwargs.get('meeting_topic')
    meeting_date = kwargs.get('meeting_date')
    meeting_time = kwargs.get('meeting_time')
    participants = kwargs.get('participants')

    # –≠–¢–ê–ü 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    logger.info("–≠—Ç–∞–ø 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏")
    extraction_prompt = _build_extraction_prompt(
        transcription,
        template_variables,
        diarization_data,
        speaker_mapping,
        meeting_topic,
        meeting_date,
        meeting_time,
        participants,
        meeting_structure
    )
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (—Å —É—á–µ—Ç–æ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)
    system_prompt = _build_system_prompt(transcription, diarization_analysis)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    if provider_name == "openai":
        provider = manager.providers[provider_name]
        openai_model_key = kwargs.get("openai_model_key")
        
        # –í—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –º–æ–¥–µ–ª–∏
        selected_model = settings.openai_model
        selected_base_url = settings.openai_base_url or "https://api.openai.com/v1"
        
        if openai_model_key:
            try:
                preset = next((p for p in settings.openai_models if p.key == openai_model_key), None)
                if preset:
                    selected_model = preset.model
                    if getattr(preset, 'base_url', None):
                        selected_base_url = preset.base_url
            except Exception:
                pass
        
        # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ base_url
        client = provider.client
        if client is None or (selected_base_url and getattr(client, 'base_url', None) != selected_base_url):
            client = openai.OpenAI(
                api_key=settings.openai_api_key,
                base_url=selected_base_url,
                http_client=provider.http_client
            )
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º extra_headers –¥–ª—è –∞—Ç—Ä–∏–±—É—Ü–∏–∏
        extra_headers = {}
        if settings.http_referer:
            extra_headers["HTTP-Referer"] = settings.http_referer
        if settings.x_title:
            extra_headers["X-Title"] = settings.x_title
        
        # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —ç—Ç–∞–ø–∞ 1
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI REQUEST - Two-Stage Extraction (Stage 1)")
            logger.debug("=" * 80)
            logger.debug(f"Model: {selected_model}")
            logger.debug(f"System prompt:\n{system_prompt}")
            logger.debug("-" * 80)
            logger.debug(f"Extraction prompt:\n{extraction_prompt}")
            logger.debug("=" * 80)
        
        # –≠—Ç–∞–ø 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ
        async def _call_openai_stage1():
            return await asyncio.to_thread(
                client.chat.completions.create,
                model=selected_model,
                messages=[
                    {"role": "system", "content": system_prompt},
                    {"role": "user", "content": extraction_prompt}
                ],
                temperature=0.1,
                response_format={"type": "json_schema", "json_schema": TWO_STAGE_EXTRACTION_SCHEMA},
                extra_headers=extra_headers
            )
        
        try:
            response1 = await _call_openai_stage1()
        except openai.APIStatusError as e:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫—É 402 - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
            if e.status_code == 402:
                error_message = e.message
                # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞
                if hasattr(e, 'response') and e.response:
                    try:
                        error_body = e.response.json()
                        if 'error' in error_body and 'message' in error_body['error']:
                            error_message = error_body['error']['message']
                    except:
                        pass
                logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM (—ç—Ç–∞–ø 1): {error_message}")
                raise LLMInsufficientCreditsError(
                    message=error_message,
                    provider="openai",
                    model=selected_model
                )
            # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ API –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–ª—å—à–µ
            raise
        
        content1 = response1.choices[0].message.content
        
        # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —ç—Ç–∞–ø–∞ 1
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI RESPONSE - Two-Stage Extraction (Stage 1)")
            logger.debug("=" * 80)
            if hasattr(response1, 'usage'):
                logger.debug(f"Usage: {response1.usage}")
            logger.debug(f"Content:\n{content1}")
            logger.debug("=" * 80)
        
        try:
            extracted_data = json.loads(content1)
        except json.JSONDecodeError as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –Ω–∞ —ç—Ç–∞–ø–µ 1: {e}")
            # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å JSON –∏–∑ —Ç–µ–∫—Å—Ç–∞
            start_idx = content1.find('{')
            end_idx = content1.rfind('}') + 1
            json_str = content1[start_idx:end_idx] if start_idx != -1 and end_idx > start_idx else content1
            extracted_data = json.loads(json_str)
        
        logger.info(f"–≠—Ç–∞–ø 1 –∑–∞–≤–µ—Ä—à–µ–Ω, –∏–∑–≤–ª–µ—á–µ–Ω–æ {len(extracted_data)} –ø–æ–ª–µ–π")
        
        # –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ø—Ä–æ–≤–µ—Ä–∫–∞ reasoning tokens (–ø—Ä–∏–∑–Ω–∞–∫ –ø—Ä–æ–±–ª–µ–º—ã –µ—Å–ª–∏ > 20000)
        if hasattr(response1, 'usage') and hasattr(response1.usage, 'completion_tokens_details'):
            details = response1.usage.completion_tokens_details
            if details and hasattr(details, 'reasoning_tokens') and details.reasoning_tokens:
                reasoning_tokens = details.reasoning_tokens
                if reasoning_tokens > 20000:
                    logger.warning(
                        f"‚ö†Ô∏è –≠—Ç–∞–ø 1: –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ {reasoning_tokens} reasoning tokens "
                        f"(> 20000). –≠—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –ø—Ä–æ–º–ø—Ç–æ–º –∏–ª–∏ –∑–∞–¥–∞—á–µ–π."
                    )
        
        # –í–ê–õ–ò–î–ê–¶–ò–Ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç—Ç–∞–ø–∞ 1
        extracted_content = extracted_data.get('extracted_data', {})
        confidence_score = extracted_data.get('confidence_score', 0.0)
        extraction_notes = extracted_data.get('extraction_notes', '')
        
        # –ü–æ–¥—Å—á–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π (–Ω–µ –ø—É—Å—Ç—ã—Ö –∏ –Ω–µ "–ù–µ —É–∫–∞–∑–∞–Ω–æ")
        filled_fields = 0
        empty_fields = []
        total_fields = len(template_variables)
        
        for field_name in template_variables.keys():
            field_value = extracted_content.get(field_name, '')
            if field_value and field_value.strip() and field_value.strip() not in ['–ù–µ —É–∫–∞–∑–∞–Ω–æ', '–Ω–µ —É–∫–∞–∑–∞–Ω–æ']:
                filled_fields += 1
            else:
                empty_fields.append(field_name)
        
        fill_percentage = (filled_fields / total_fields * 100) if total_fields > 0 else 0
        
        logger.info(
            f"–≠—Ç–∞–ø 1: –∑–∞–ø–æ–ª–Ω–µ–Ω–æ {filled_fields}/{total_fields} –ø–æ–ª–µ–π ({fill_percentage:.1f}%), "
            f"confidence={confidence_score:.2f}"
        )
        
        if empty_fields:
            logger.debug(f"–≠—Ç–∞–ø 1: –ø—É—Å—Ç—ã–µ –ø–æ–ª—è: {', '.join(empty_fields)}")
        
        # FALLBACK: –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–∏—à–∫–æ–º –ø—É—Å—Ç–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–Ω–æ—ç—Ç–∞–ø–Ω—ã–π —Ä–µ–∂–∏–º
        if not extracted_content or fill_percentage < 30:
            logger.warning(
                f"‚ö†Ô∏è –≠—Ç–∞–ø 1 –≤–µ—Ä–Ω—É–ª –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–ø–æ–ª–Ω–µ–Ω–æ {fill_percentage:.1f}%). "
                f"–ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –æ–¥–Ω–æ—ç—Ç–∞–ø–Ω—ã–π —Ä–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏."
            )
            logger.debug(f"extracted_data: {extracted_content}")
            logger.debug(f"extraction_notes: {extraction_notes}")
            
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É
            return await manager.generate_protocol(
                provider_name, transcription, template_variables, diarization_data, **kwargs
            )
        
        # –≠–¢–ê–ü 2: –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ
        logger.info("–≠—Ç–∞–ø 2: –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ")
        reflection_prompt = _build_reflection_prompt(
            extracted_content, transcription, template_variables, diarization_analysis
        )
        
        # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —ç—Ç–∞–ø–∞ 2
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI REQUEST - Two-Stage Reflection (Stage 2)")
            logger.debug("=" * 80)
            logger.debug(f"Reflection prompt:\n{reflection_prompt}")
            logger.debug("=" * 80)
        
        async def _call_openai_stage2():
            return await asyncio.to_thread(
                client.chat.completions.create,
                model=selected_model,
                messages=[
                    {"role": "system", "content": system_prompt},
                    {"role": "user", "content": reflection_prompt}
                ],
                temperature=0.1,
                response_format={"type": "json_schema", "json_schema": TWO_STAGE_REFLECTION_SCHEMA},
                extra_headers=extra_headers
            )
        
        try:
            response2 = await _call_openai_stage2()
        except openai.APIStatusError as e:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫—É 402 - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
            if e.status_code == 402:
                error_message = e.message
                # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞
                if hasattr(e, 'response') and e.response:
                    try:
                        error_body = e.response.json()
                        if 'error' in error_body and 'message' in error_body['error']:
                            error_message = error_body['error']['message']
                    except:
                        pass
                logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM (—ç—Ç–∞–ø 2): {error_message}")
                raise LLMInsufficientCreditsError(
                    message=error_message,
                    provider="openai",
                    model=selected_model
                )
            # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ API –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–ª—å—à–µ
            raise
        
        content2 = response2.choices[0].message.content
        finish_reason = response2.choices[0].finish_reason
        
        # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —ç—Ç–∞–ø–∞ 2
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI RESPONSE - Two-Stage Reflection (Stage 2)")
            logger.debug("=" * 80)
            if hasattr(response2, 'usage'):
                logger.debug(f"Usage: {response2.usage}")
            logger.debug(f"Finish reason: {response2.choices[0].finish_reason}")
            logger.debug(f"Content:\n{content2}")
            logger.debug("=" * 80)
        
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
        logger.info(f"–≠—Ç–∞–ø 2: –ø–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –¥–ª–∏–Ω–æ–π {len(content2) if content2 else 0} —Å–∏–º–≤–æ–ª–æ–≤, finish_reason={finish_reason}")
        
        # –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ø—Ä–æ–≤–µ—Ä–∫–∞ reasoning tokens –¥–ª—è —ç—Ç–∞–ø–∞ 2
        if hasattr(response2, 'usage') and hasattr(response2.usage, 'completion_tokens_details'):
            details = response2.usage.completion_tokens_details
            if details and hasattr(details, 'reasoning_tokens') and details.reasoning_tokens:
                reasoning_tokens = details.reasoning_tokens
                logger.debug(f"–≠—Ç–∞–ø 2: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ {reasoning_tokens} reasoning tokens")
                if reasoning_tokens > 20000:
                    logger.warning(
                        f"‚ö†Ô∏è –≠—Ç–∞–ø 2: –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ {reasoning_tokens} reasoning tokens "
                        f"(> 20000). –≠—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É."
                    )
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç
        if not content2 or not content2.strip():
            logger.warning(f"–≠—Ç–∞–ø 2: –ø–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç API. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ 1")
            logger.debug(f"Response details: finish_reason={finish_reason}, model={selected_model}")
            return extracted_content
        
        try:
            improved_data = json.loads(content2)
        except json.JSONDecodeError as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –Ω–∞ —ç—Ç–∞–ø–µ 2: {e}")
            logger.error(f"Content preview (–ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤): {content2[:500]}")
            
            # –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–≤–ª–µ—á—å JSON –∏–∑ —Ç–µ–∫—Å—Ç–∞
            start_idx = content2.find('{')
            end_idx = content2.rfind('}') + 1
            
            if start_idx != -1 and end_idx > start_idx:
                json_str = content2[start_idx:end_idx]
                try:
                    improved_data = json.loads(json_str)
                    logger.info("JSON —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω –∏–∑ —Ç–µ–∫—Å—Ç–∞")
                except json.JSONDecodeError as e2:
                    logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å JSON: {e2}. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ 1")
                    return extracted_content
            else:
                logger.error("JSON –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ 1")
                return extracted_content
        
        # –í–ê–õ–ò–î–ê–¶–ò–Ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç—Ç–∞–ø–∞ 2
        refined_data = improved_data.get('refined_data', {})
        quality_score = improved_data.get('quality_score', 0.0)
        reflection_notes = improved_data.get('reflection_notes', '')
        
        # –ü–æ–¥—Å—á–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –≤ refined_data
        refined_filled = 0
        refined_empty = []
        for field_name in template_variables.keys():
            field_value = refined_data.get(field_name, '')
            if field_value and field_value.strip() and field_value.strip() not in ['–ù–µ —É–∫–∞–∑–∞–Ω–æ', '–Ω–µ —É–∫–∞–∑–∞–Ω–æ']:
                refined_filled += 1
            else:
                refined_empty.append(field_name)
        
        refined_percentage = (refined_filled / total_fields * 100) if total_fields > 0 else 0
        
        logger.info(
            f"–≠—Ç–∞–ø 2: –∑–∞–ø–æ–ª–Ω–µ–Ω–æ {refined_filled}/{total_fields} –ø–æ–ª–µ–π ({refined_percentage:.1f}%), "
            f"quality_score={quality_score:.2f}"
        )
        
        if refined_empty:
            logger.debug(f"–≠—Ç–∞–ø 2: –ø—É—Å—Ç—ã–µ –ø–æ–ª—è: {', '.join(refined_empty)}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ refined_data –Ω–µ —Ö—É–∂–µ —á–µ–º extracted_content
        if not refined_data or refined_percentage < fill_percentage * 0.8:
            logger.warning(
                f"‚ö†Ô∏è –≠—Ç–∞–ø 2 —É—Ö—É–¥—à–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±—ã–ª–æ {fill_percentage:.1f}%, —Å—Ç–∞–ª–æ {refined_percentage:.1f}%). "
                f"–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ 1."
            )
            logger.debug(f"reflection_notes: {reflection_notes}")
            return extracted_content
        
        logger.info(f"–≠—Ç–∞–ø 2 –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ (—É–ª—É—á—à–µ–Ω–∏–µ: +{refined_percentage - fill_percentage:.1f}%)")
        return refined_data
    
    else:
        # –î–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥
        logger.warning(f"–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è {provider_name}, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥")
        return await manager.generate_protocol(
            provider_name, transcription, template_variables, diarization_data, **kwargs
        )


# ===================================================================
# UNIFIED PROTOCOL GENERATION (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô –ü–û–î–•–û–î)
# ===================================================================

def _build_unified_prompt(
    transcription: Optional[str],
    structure_summary: str,
    template_variables: Dict[str, str],
    diarization_data: Optional[Dict[str, Any]] = None,
    speaker_mapping: Optional[Dict[str, str]] = None,
    meeting_topic: Optional[str] = None,
    meeting_date: Optional[str] = None,
    meeting_time: Optional[str] = None,
    participants: Optional[List[Dict[str, str]]] = None
) -> str:
    """
    –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–º–ø—Ç –¥–ª—è unified –ø–æ–¥—Ö–æ–¥–∞
    """
    
    # –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤—Å—Ç—Ä–µ—á–∏
    context_parts = []
    
    if meeting_topic:
        context_parts.append(f"–¢–µ–º–∞ –≤—Å—Ç—Ä–µ—á–∏: {meeting_topic}")
    if meeting_date:
        context_parts.append(f"–î–∞—Ç–∞: {meeting_date}")
    if meeting_time:
        context_parts.append(f"–í—Ä–µ–º—è: {meeting_time}")
    
    context_text = "\n".join(context_parts) if context_parts else "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å—Ç—Ä–µ—á–µ –Ω–µ —É–∫–∞–∑–∞–Ω–∞"
    
    # –£—á–∞—Å—Ç–Ω–∏–∫–∏
    participants_text = ""
    if participants:
        participants_text = "–£–ß–ê–°–¢–ù–ò–ö–ò:\n" + "\n".join([
            f"- {p.get('name', '')} ({p.get('role', '—Ä–æ–ª—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞')})"
            for p in participants
        ])
    
    # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å—Ç—Ä–µ—á–∏ (–≤–º–µ—Å—Ç–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏)
    content_text = ""
    if structure_summary:
        content_text = f"–°–¢–†–£–ö–¢–£–†–ò–†–û–í–ê–ù–ù–û–ï –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï –í–°–¢–†–ï–ß–ò:\n\n{structure_summary}"
    elif transcription:
        # Fallback: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é
        if diarization_data and diarization_data.get("formatted_transcript"):
            content_text = f"–¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–Ø –° –î–ò–ê–†–ò–ó–ê–¶–ò–ï–ô:\n\n{diarization_data['formatted_transcript']}"
        else:
            content_text = f"–¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–Ø:\n\n{transcription}"
    
    # –ú–∞–ø–ø–∏–Ω–≥ —Å–ø–∏–∫–µ—Ä–æ–≤
    mapping_text = ""
    if speaker_mapping:
        mapping_text = "–°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –°–ü–ò–ö–ï–†–û–í:\n" + "\n".join([
            f"- {speaker_id} = {name}"
            for speaker_id, name in speaker_mapping.items()
        ])
    
    # –ü–æ–ª—è —à–∞–±–ª–æ–Ω–∞
    fields_text = "–ü–û–õ–Ø –î–õ–Ø –ó–ê–ü–û–õ–ù–ï–ù–ò–Ø:\n" + "\n".join([
        f"- {field_name}: {field_description}"
        for field_name, field_description in template_variables.items()
    ])
    
    # –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç
    prompt = f"""–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –≤—Å—Ç—Ä–µ—á. –¢–≤–æ—è –∑–∞–¥–∞—á–∞:

1. –ò–ó–í–õ–ï–ß–¨ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Å—Ç—Ä–µ—á–µ
2. –ó–ê–ü–û–õ–ù–ò–¢–¨ –≤—Å–µ –ø–æ–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
3. –ü–†–û–í–ï–†–ò–¢–¨ —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –Ω–∞ –ø–æ–ª–Ω–æ—Ç—É –∏ —Ç–æ—á–Ω–æ—Å—Ç—å (self-reflection)
4. –£–ö–ê–ó–ê–¢–¨ —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

{context_text}

{participants_text}

{content_text}

{mapping_text}

{fields_text}

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –ò–∑–≤–ª–µ–∫–∞–π –¢–û–õ–¨–ö–û —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
- –ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–º—ã/—Ä–µ—à–µ–Ω–∏—è/–∑–∞–¥–∞—á–∏, –∏—Å–ø–æ–ª—å–∑—É–π –∏—Ö –Ω–∞–ø—Ä—è–º—É—é
- –ö–∞–∂–¥–æ–µ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫–æ–π (–∏—Å–ø–æ–ª—å–∑—É–π \\n –¥–ª—è —Å–ø–∏—Å–∫–æ–≤)
- –ü–æ—Å–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å: –≤—Å–µ –ª–∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã —É—á—Ç–µ–Ω—ã?
- –£–∫–∞–∂–∏ —É—Ä–æ–≤–µ–Ω—å confidence_score (0.0-1.0)
- –í quality_notes –æ–ø–∏—à–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏

–í–µ—Ä–Ω–∏ JSON –≤ —Ñ–æ—Ä–º–∞—Ç–µ UnifiedProtocolSchema."""
    
    return prompt


async def generate_protocol_unified(
    manager: 'LLMManager',
    provider_name: str,
    transcription: str,
    template_variables: Dict[str, str],
    diarization_data: Optional[Dict[str, Any]] = None,
    diarization_analysis: Optional[Dict[str, Any]] = None,
    meeting_structure = None,
    **kwargs
) -> Dict[str, Any]:
    """
    Unified –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ + self-reflection –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
    - –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö (Stage 1 + Stage 2)
    - –ú–æ–¥–µ–ª—å –¥–µ–ª–∞–µ—Ç self-reflection –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    - –°–Ω–∏–∂–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
    
    Args:
        manager: –ú–µ–Ω–µ–¥–∂–µ—Ä LLM
        provider_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
        transcription: –¢–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        diarization_data: –î–∞–Ω–Ω—ã–µ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        diarization_analysis: –ê–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        meeting_structure: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å—Ç—Ä–µ—á–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏)
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        
    Returns:
        –ü—Ä–æ—Ç–æ–∫–æ–ª
    """
    from src.utils.context_extraction import build_structure_summary
    from src.models.llm_schemas import UNIFIED_PROTOCOL_SCHEMA
    
    logger.info("–ù–∞—á–∞–ª–æ unified –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞")
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    speaker_mapping = kwargs.get('speaker_mapping')
    meeting_topic = kwargs.get('meeting_topic')
    meeting_date = kwargs.get('meeting_date')
    meeting_time = kwargs.get('meeting_time')
    participants = kwargs.get('participants')
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
    structure_summary = ""
    if meeting_structure and settings.use_structure_only_for_protocol:
        structure_summary = build_structure_summary(meeting_structure)
        logger.info(f"–ò—Å–ø–æ–ª—å–∑—É–µ–º meeting_structure (—Å–∂–∞—Ç–æ: {len(structure_summary)} —Å–∏–º–≤–æ–ª–æ–≤)")
    
    # –°—Ç—Ä–æ–∏–º –ø—Ä–æ–º–ø—Ç
    prompt = _build_unified_prompt(
        transcription=transcription if not structure_summary else None,
        structure_summary=structure_summary,
        template_variables=template_variables,
        diarization_data=diarization_data,
        speaker_mapping=speaker_mapping,
        meeting_topic=meeting_topic,
        meeting_date=meeting_date,
        meeting_time=meeting_time,
        participants=participants
    )
    
    system_prompt = _build_system_prompt(transcription, diarization_analysis)
    
    # –í—ã–∑–æ–≤ OpenAI
    if provider_name == "openai":
        provider = manager.providers[provider_name]
        openai_model_key = kwargs.get("openai_model_key")
        
        selected_model = settings.openai_model
        selected_base_url = settings.openai_base_url or "https://api.openai.com/v1"
        
        if openai_model_key:
            try:
                preset = next((p for p in settings.openai_models if p.key == openai_model_key), None)
                if preset:
                    selected_model = preset.model
                    if getattr(preset, 'base_url', None):
                        selected_base_url = preset.base_url
            except Exception:
                pass
        
        client = provider.client
        if client is None or (selected_base_url and getattr(client, 'base_url', None) != selected_base_url):
            import openai
            client = openai.OpenAI(
                api_key=settings.openai_api_key,
                base_url=selected_base_url,
                http_client=provider.http_client
            )
        
        extra_headers = {}
        if settings.http_referer:
            extra_headers["HTTP-Referer"] = settings.http_referer
        if settings.x_title:
            extra_headers["X-Title"] = settings.x_title
        
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI REQUEST - Unified Protocol Generation")
            logger.debug("=" * 80)
            logger.debug(f"Model: {selected_model}")
            logger.debug(f"System prompt:\n{system_prompt}")
            logger.debug("-" * 80)
            logger.debug(f"User prompt:\n{prompt}")
            logger.debug("=" * 80)
        
        # –í—ã–∑–æ–≤ —Å prompt caching (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
        if settings.enable_prompt_caching and transcription:
            from src.utils.context_extraction import add_prompt_caching_markers
            messages = add_prompt_caching_markers(system_prompt, transcription, prompt)
        else:
            messages = [
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": prompt}
            ]
        
        async def _call_openai():
            import asyncio
            import openai
            return await asyncio.to_thread(
                client.chat.completions.create,
                model=selected_model,
                messages=messages,
                temperature=0.1,
                response_format={"type": "json_schema", "json_schema": UNIFIED_PROTOCOL_SCHEMA},
                extra_headers=extra_headers
            )
        
        try:
            response = await _call_openai()
        except openai.APIStatusError as e:
            if e.status_code == 402:
                error_message = e.message
                if hasattr(e, 'response') and e.response:
                    try:
                        error_body = e.response.json()
                        if 'error' in error_body and 'message' in error_body['error']:
                            error_message = error_body['error']['message']
                    except:
                        pass
                logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM: {error_message}")
                raise LLMInsufficientCreditsError(
                    message=error_message,
                    provider="openai",
                    model=selected_model
                )
            raise
        
        content = response.choices[0].message.content
        
        if settings.llm_debug_log:
            logger.debug("=" * 80)
            logger.debug("[DEBUG] OpenAI RESPONSE - Unified Protocol Generation")
            logger.debug("=" * 80)
            if hasattr(response, 'usage'):
                logger.debug(f"Usage: {response.usage}")
            logger.debug(f"Content:\n{content}")
            logger.debug("=" * 80)
        
        result = json.loads(content)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º protocol_data (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º)
        protocol_data = result.get('protocol_data', {})
        
        # –î–æ–±–∞–≤–ª—è–µ–º speaker mapping –µ—Å–ª–∏ –µ—Å—Ç—å
        if result.get('detected_speaker_mapping'):
            protocol_data['detected_speaker_mapping'] = result['detected_speaker_mapping']
        if result.get('speaker_confidence_scores'):
            protocol_data['speaker_confidence_scores'] = result['speaker_confidence_scores']
        
        logger.info(f"Unified generation –∑–∞–≤–µ—Ä—à–µ–Ω, confidence={result.get('confidence_score', 0.0):.2f}")
        
        return protocol_data
    
    else:
        raise ValueError(f"Unified –ø–æ–¥—Ö–æ–¥ –ø–æ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è OpenAI, –ø–æ–ª—É—á–µ–Ω: {provider_name}")


# ===================================================================
# CHAIN-OF-THOUGHT –î–õ–Ø –î–õ–ò–ù–ù–´–• –í–°–¢–†–ï–ß
# ===================================================================

def _build_segment_analysis_prompt(
    segment_text: str,
    segment_id: int,
    total_segments: int,
    template_variables: Dict[str, str],
    speaker_mapping: Optional[Dict[str, str]] = None,
    participants: Optional[List[Dict[str, str]]] = None
) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
    """
    variables_str = "\n".join([f"- {key}: {desc}" for key, desc in template_variables.items()])
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å–ø–∏–∫–µ—Ä–æ–≤ —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
    participants_info = ""
    if speaker_mapping:
        participants_info = "\n" + "‚ïê" * 63 + "\n"
        participants_info += "–£–ß–ê–°–¢–ù–ò–ö–ò –í–°–¢–†–ï–ß–ò (–° –†–û–õ–Ø–ú–ò)\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        participants_info += "–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥–æ–≤–æ—Ä—è—â–∏—Ö —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏:\n"
        for speaker_id, participant_name in speaker_mapping.items():
            participants_info += f"- {speaker_id} = {participant_name}\n"
        participants_info += "\n"
        participants_info += "‚ö†Ô∏è –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –†–ê–ë–û–¢–ï –° –£–ß–ê–°–¢–ù–ò–ö–ê–ú–ò:\n"
        participants_info += "1. –ò—Å–ø–æ–ª—å–∑—É–π –†–ï–ê–õ–¨–ù–´–ï –ò–ú–ï–ù–ê –≤–º–µ—Å—Ç–æ –º–µ—Ç–æ–∫ —Å–ø–∏–∫–µ—Ä–æ–≤ (SPEAKER_1 ‚Üí –ò–º—è)\n"
        participants_info += "2. –ü—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—á–∏—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n"
        participants_info += "3. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ: –¢–û–õ–¨–ö–û –ò–ú–Ø, –±–µ–∑ —Ä–æ–ª–∏ –≤ —Å–∫–æ–±–∫–∞—Ö\n"
        participants_info += "   ‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤'\n"
        participants_info += "   ‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (–ú–µ–Ω–µ–¥–∂–µ—Ä)'\n"
        participants_info += "üìå –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù:\n"
        participants_info += "–í —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ/—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–º–µ–Ω.\n"
        participants_info += "–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–π –∏—Ö —Å –ø–æ–ª–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ:\n\n"
        participants_info += "–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–∏–º–µ–Ω—è–π –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º):\n"
        participants_info += "   ‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π, –°–∞—à–∞‚Üí–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –ü–æ —Ñ–∞–º–∏–ª–∏–∏: –¢–∏–º—á–µ–Ω–∫–æ‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ, –ö–æ—Ä–æ—Ç–∫–æ–≤–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞ –∏ —Ç.–¥.\n"
        participants_info += "   ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–º—è: –ê–ª–µ–∫—Å–µ–π‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ (–µ—Å–ª–∏ –æ–¥–∏–Ω —Ç–∞–∫–æ–π –≤ —Å–ø–∏—Å–∫–µ)\n\n"
        participants_info += "   ‚ö° –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Å—è –ø—Ä–∏–º–µ—Ä–∞–º–∏! –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ.\n"
        participants_info += "   ‚ö° –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–û–ï –ò–ú–Ø –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤!\n\n"
    elif participants:
        # –ï—Å–ª–∏ –Ω–µ—Ç speaker_mapping, –Ω–æ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
        participants_info = "\n" + "‚ïê" * 63 + "\n"
        participants_info += "üéØ –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í –í–°–¢–†–ï–ß–ò (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ)\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        from src.services.participants_service import participants_service
        participants_info += participants_service.format_participants_for_llm(participants)
        participants_info += "\n\n"
        participants_info += "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n"
        participants_info += "‚ïë  üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø     ‚ïë\n"
        participants_info += "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n"
        participants_info += "1Ô∏è‚É£ –ò–°–ü–û–õ–¨–ó–£–ô –¢–û–õ–¨–ö–û –ò–ú–ï–ù–ê –ò–ó –°–ü–ò–°–ö–ê –í–´–®–ï!\n"
        participants_info += "   –ó–ê–ü–†–ï–©–ï–ù–û –¥–æ–±–∞–≤–ª—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ —Å–ø–∏—Å–∫–µ!\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–ö–æ–ª–ª–µ–≥–∞ –∏–∑ –û–†–¢', '–ö–æ–ª–ª–µ–≥–∏ –∏–∑ ERP', '–ö–æ–º–∞–Ω–¥–∞'\n"
        participants_info += "   ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞\n\n"
        participants_info += "2Ô∏è‚É£ –§–û–†–ú–ê–¢ –ò–ú–ï–ù: '–ò–º—è –§–∞–º–∏–ª–∏—è' (–ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞)!\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–°–æ—Ñ—å—è' (—Ç–æ–ª—å–∫–æ –∏–º—è)\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–í–∏–∫—É–ª–∏–Ω' (—Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è)\n"
        participants_info += "   ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: '–û—Å–∏–ø–æ–≤–∞ –°–æ—Ñ—å—è –Æ—Ä—å–µ–≤–Ω–∞' (—Å –æ—Ç—á–µ—Å—Ç–≤–æ–º)\n"
        participants_info += "   ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: '–°–æ—Ñ—å—è –û—Å–∏–ø–æ–≤–∞', '–ì–∞–ª–∏–Ω–∞ –Ø–º–∫–∏–Ω–∞', '–í–ª–∞–¥–∏–º–∏—Ä –ì–æ–ª–∏–∫–æ–≤'\n\n"
        participants_info += "3Ô∏è‚É£ –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –°–û–ö–†–ê–©–ï–ù–ù–´–• –ò–ú–ï–ù:\n"
        participants_info += "   –í —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–º–∏.\n"
        participants_info += "   –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –≤—ã—à–µ –ü–û–õ–ù–û–ï —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:\n\n"
        participants_info += "   üìã –ü–†–ê–í–ò–õ–ê –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø:\n"
        participants_info += "   ‚Ä¢ '–°–≤–µ—Ç–∞', '–°–≤–µ—Ç–æ—á–∫–∞' ‚Üí –Ω–∞–π–¥–∏ '–°–≤–µ—Ç–ª–∞–Ω–∞' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–õ–µ—à–∞', '–ê–ª—ë—à–∞' ‚Üí –Ω–∞–π–¥–∏ '–ê–ª–µ–∫—Å–µ–π' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–ì–∞–ª—è' ‚Üí –Ω–∞–π–¥–∏ '–ì–∞–ª–∏–Ω–∞' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–í–æ–ª–æ–¥—å', '–í–æ–≤–∞' ‚Üí –Ω–∞–π–¥–∏ '–í–ª–∞–¥–∏–º–∏—Ä' –≤ —Å–ø–∏—Å–∫–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n"
        participants_info += "   ‚Ä¢ '–°—Ç–∞—Å' ‚Üí –Ω–∞–π–¥–∏ '–°—Ç–∞–Ω–∏—Å–ª–∞–≤' –∏–ª–∏ '–°–≤—è—Ç–æ—Å–ª–∞–≤' –≤ —Å–ø–∏—Å–∫–µ\n"
        participants_info += "   ‚Ä¢ '–í–∏–∫—É–ª–∏–Ω', '–¢–∏–º—á–µ–Ω–∫–æ' (—Ñ–∞–º–∏–ª–∏—è) ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –ø–æ —Ñ–∞–º–∏–ª–∏–∏\n"
        participants_info += "   ‚Ä¢ '–ú–∞—Ä–∞—Ç' (–∏–º—è) ‚Üí –Ω–∞–π–¥–∏ –≤ —Å–ø–∏—Å–∫–µ –ø–æ –∏–º–µ–Ω–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ–ª–Ω–æ–µ –∏–º—è\n\n"
        participants_info += "4Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –î–û–ë–ê–í–õ–ï–ù–ò–ï–ú –í –ü–†–û–¢–û–ö–û–õ:\n"
        participants_info += "   –î–ª—è –ö–ê–ñ–î–û–ì–û —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏:\n"
        participants_info += "   ‚úì –ù–∞–π–¥–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Å–ø–∏—Å–∫–µ –≤—ã—à–µ\n"
        participants_info += "   ‚úì –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–û–ï –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ (–ò–º—è –§–∞–º–∏–ª–∏—è)\n"
        participants_info += "   ‚úì –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ - –ù–ï –≤–∫–ª—é—á–∞–π –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª\n\n"
        participants_info += "‚ö° –í–ê–ñ–ù–û: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ!\n"
        participants_info += "‚ö° –ù–ï –≤—ã–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞! –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –∏–∑ —Å–ø–∏—Å–∫–∞!\n"
        participants_info += "‚ö° –ü—Ä–∏ –º–∞–ª–µ–π—à–µ–º —Å–æ–º–Ω–µ–Ω–∏–∏ - —Å–æ–ø–æ—Å—Ç–∞–≤—å —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º!\n\n"
    else:
        # –ù–µ—Ç –Ω–∏ speaker_mapping, –Ω–∏ participants - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        participants_info = "\n" + "‚ïê" * 63 + "\n"
        participants_info += "‚öôÔ∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –£–ß–ê–°–¢–ù–ò–ö–û–í –ò–ó –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò\n"
        participants_info += "‚ïê" * 63 + "\n\n"
        participants_info += "–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –û–ø—Ä–µ–¥–µ–ª–∏ –∏–º–µ–Ω–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.\n\n"
        
        participants_info += "üéØ –ü–û–®–ê–ì–û–í–´–ô –ê–õ–ì–û–†–ò–¢–ú –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø (–ü–†–ò–û–†–ò–¢–ï–¢–´):\n\n"
        
        participants_info += "–ü–†–ò–û–†–ò–¢–ï–¢ 1 - –ü–†–Ø–ú–´–ï –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–Ø:\n"
        participants_info += "   –ï—Å–ª–∏ SPEAKER_N –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–µ–±–µ:\n"
        participants_info += "   ‚Ä¢ \"–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω\" ‚Üí SPEAKER_N = –ò–≤–∞–Ω\n"
        participants_info += "   ‚Ä¢ \"–Ø ‚Äî –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞\" ‚Üí SPEAKER_N = –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞\n"
        participants_info += "   ‚Ä¢ \"–≠—Ç–æ –ê–ª–µ–∫—Å–µ–π\" (–≤ –Ω–∞—á–∞–ª–µ) ‚Üí SPEAKER_N = –ê–ª–µ–∫—Å–µ–π\n\n"
        
        participants_info += "–ü–†–ò–û–†–ò–¢–ï–¢ 2 - –û–ë–†–ê–©–ï–ù–ò–Ø –° –û–¢–í–ï–¢–û–ú:\n"
        participants_info += "   –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫:\n"
        participants_info += "   ‚Ä¢ SPEAKER_1: \"–°–≤–µ—Ç–∞, –∫–∞–∫ –¥—É–º–∞–µ—à—å?\"\n"
        participants_info += "     SPEAKER_2: \"–î–∞, —Å–æ–≥–ª–∞—Å–Ω–∞...\"\n"
        participants_info += "     ‚Üí SPEAKER_2 = –°–≤–µ—Ç–∞ (–æ–±—Ä–∞—â–µ–Ω–∏–µ + –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç)\n\n"
        participants_info += "   ‚Ä¢ SPEAKER_2: \"–î–∞, –ê–ª–µ–∫—Å–µ–π, —Å–æ–≥–ª–∞—Å–µ–Ω —Å —Ç–æ–±–æ–π\"\n"
        participants_info += "     ‚Üí SPEAKER_1 (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥–æ–≤–æ—Ä–∏–≤—à–∏–π) = –ê–ª–µ–∫—Å–µ–π\n\n"
        
        participants_info += "–ü–†–ò–û–†–ò–¢–ï–¢ 3 - –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –ß–£–ñ–ò–• –°–õ–û–í:\n"
        participants_info += "   –ò—â–∏ –æ—Ç—Å—ã–ª–∫–∏ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è–º:\n"
        participants_info += "   ‚Ä¢ SPEAKER_2: \"–í–∏–∫—É–ª–∏–Ω –∏ –ú–∞—Ä–∞—Ç –ø—Ä–æ—Å–∏–ª–∏...\"\n"
        participants_info += "     SPEAKER_1: \"–í—Å–µ –≤–µ—Ä–Ω–æ, –ú–∞—Ä–∞—Ç —ç—Ç–æ –ø—Ä–æ—Å–∏–ª...\"\n"
        participants_info += "     ‚Üí SPEAKER_2 = –ú–∞—Ä–∞—Ç (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏–µ)\n\n"
        participants_info += "   ‚Ä¢ SPEAKER_1: \"–ö–∞–∫ —Å–∫–∞–∑–∞–ª –ò–≤–∞–Ω —Ä–∞–Ω–µ–µ...\"\n"
        participants_info += "     ‚Üí –ù–∞–π–¥–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ SPEAKER, –≥–æ–≤–æ—Ä–∏–≤—à–µ–≥–æ –Ω–∞ —ç—Ç—É —Ç–µ–º—É = –ò–≤–∞–Ω\n\n"
        
        participants_info += "–ü–†–ò–û–†–ò–¢–ï–¢ 4 - –£–ü–û–ú–ò–ù–ê–ù–ò–Ø –° –ö–û–ù–¢–ï–ö–°–¢–û–ú:\n"
        participants_info += "   –£–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü —Ç—Ä–µ–±—É—é—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏:\n"
        participants_info += "   ‚Ä¢ SPEAKER_1: \"–º—ã —Å–æ –°–≤–µ—Ç–æ–π –æ–±—Å—É–∂–¥–∞–ª–∏...\"\n"
        participants_info += "     ‚Üí –°–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä—É–≥–æ–π SPEAKER –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å\n"
        participants_info += "     ‚Üí –î–æ–±–∞–≤–ª—è–π –≤ mapping –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –°–≤–µ—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç\n\n"
        
        participants_info += "üìä –ö–û–ù–¢–ï–ö–°–¢–ù–´–ô –ê–ù–ê–õ–ò–ó –î–ò–ê–õ–û–ì–ê:\n\n"
        participants_info += "1. –ß–∏—Ç–∞–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π —Å–º–µ–Ω—É SPEAKER_N\n"
        participants_info += "2. –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ –∏–º–µ–Ω–∏ ‚Üí –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º\n"
        participants_info += "3. –ü—Ä–∏ —Ñ—Ä–∞–∑–∞—Ö \"–∫–∞–∫ —Å–∫–∞–∑–∞–ª X\" ‚Üí –∏—â–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–ø–ª–∏–∫–∞—Ö\n"
        participants_info += "4. –°–æ—Ö—Ä–∞–Ω—è–π –≥–∏–ø–æ—Ç–µ–∑—ã –∏ –ü–†–û–í–ï–†–Ø–ô –∏—Ö –ø–æ –≤—Å–µ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "5. –ï—Å–ª–∏ –∏–º—è —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö ‚Üí –ø–æ–≤—ã—à–∞–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å\n\n"
        
        participants_info += "üí° –ü–†–ò–ú–ï–†–´ –ò–ó –†–ï–ê–õ–¨–ù–´–• –î–ò–ê–õ–û–ì–û–í:\n\n"
        
        participants_info += "–ü–†–ò–ú–ï–† 1 - –û–±—Ä–∞—â–µ–Ω–∏–µ + –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ:\n"
        participants_info += "   SPEAKER_1: \"–ó–¥–µ—Å—å –Ω–∞–≤–µ—Ä–Ω–æ–µ —Ö–æ—Ä–æ—à–æ –ø–æ—Å–ª—É—à–∞—Ç—å –∫–æ–ª–ª–µ–≥—É –∏–∑ –û–†–¢. –ü–æ–¥–æ–∂–¥–∏, —è —Ç–µ–±—è\"\n"
        participants_info += "   SPEAKER_2: \"–ø–æ–ø—Ä–∞–≤–ª—é, –Ω–µ –≤—Å–µ —Ç–æ–Ω–∫–æ—Å—Ç–∏ —Ä–∞—Å–∫—Ä—ã–ª...\"\n"
        participants_info += "   –ê–Ω–∞–ª–∏–∑: SPEAKER_1 –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ SPEAKER_2 –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç —Å–ª–æ–≤–æ\n"
        participants_info += "   –î–µ–π—Å—Ç–≤–∏–µ: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–º–µ–Ω–∏, –∂–¥–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π\n\n"
        
        participants_info += "–ü–†–ò–ú–ï–† 2 - –û–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏ –≤ –æ—Ç–≤–µ—Ç–µ:\n"
        participants_info += "   SPEAKER_1: \"...—Ç–æ –µ—Å—Ç—å —Ç–∞–º –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ, —á—Ç–æ–±—ã –ª—é–¥–∏ –æ—Å–æ–∑–Ω–∞–≤–∞–ª–∏\"\n"
        participants_info += "   SPEAKER_2: \"—á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç. –õ—ë—à, —è –ø—Ä–æ—Å—Ç–æ —Ö–æ—á—É —Å–∫–∞–∑–∞—Ç—å...\"\n"
        participants_info += "   –ê–Ω–∞–ª–∏–∑: SPEAKER_2 –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ SPEAKER_1 –ø–æ –∏–º–µ–Ω–∏ \"–õ—ë—à\" (–ê–ª–µ–∫—Å–µ–π)\n"
        participants_info += "   –î–µ–π—Å—Ç–≤–∏–µ: SPEAKER_1 = –ê–ª–µ–∫—Å–µ–π (–≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)\n\n"
        
        participants_info += "–ü–†–ò–ú–ï–† 3 - –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫–æ–ª–ª–µ–≥ (–ª–æ–∂–Ω—ã–π —Å–ª–µ–¥):\n"
        participants_info += "   SPEAKER_1: \"–≤–æ—Ç –º—ã —Å–æ –°–≤–µ—Ç–æ–π –ö–æ—Ä–æ—Ç–∫–æ–≤–æ–π –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏...\"\n"
        participants_info += "   –ê–Ω–∞–ª–∏–∑: –°–≤–µ—Ç–∞ —É–ø–æ–º—è–Ω—É—Ç–∞ –∫–∞–∫ —Å–æ–∞–≤—Ç–æ—Ä, –Ω–æ –ù–ï –≥–æ–≤–æ—Ä–∏—Ç –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç\n"
        participants_info += "   –î–µ–π—Å—Ç–≤–∏–µ: –ù–ï –¥–æ–±–∞–≤–ª—è–π –°–≤–µ—Ç–∞ –≤ mapping –ø–æ–∫–∞ –æ–Ω–∞ –Ω–µ –∑–∞–≥–æ–≤–æ—Ä–∏—Ç –∏–ª–∏ –∫ –Ω–µ–π –Ω–µ –æ–±—Ä–∞—Ç—è—Ç—Å—è\n\n"
        
        participants_info += "–ü–†–ò–ú–ï–† 4 - –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ:\n"
        participants_info += "   SPEAKER_1: \"–ì–∞–ª—è, –∫–∞–∫ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å?\"\n"
        participants_info += "   SPEAKER_3: \"–Ø –¥—É–º–∞—é, —á—Ç–æ –Ω—É–∂–Ω–æ...\"\n"
        participants_info += "   –ê–Ω–∞–ª–∏–∑: –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏ —Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º\n"
        participants_info += "   –î–µ–π—Å—Ç–≤–∏–µ: SPEAKER_3 = –ì–∞–ª–∏–Ω–∞ (–≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)\n\n"
        
        participants_info += "üîç –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–ï–†–ï–î –û–¢–í–ï–¢–û–ú:\n\n"
        participants_info += "–®–∞–≥ 1: –ü–µ—Ä–µ—á–∏—Å–ª–∏ –í–°–ï —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏–º–µ–Ω –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "–®–∞–≥ 2: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–º–µ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª–∏ –ö–û–ù–¢–ï–ö–°–¢:\n"
        participants_info += "        - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (–≥–æ–≤–æ—Ä–∏—Ç –æ —Å–µ–±–µ)\n"
        participants_info += "        - –û–±—Ä–∞—â–µ–Ω–∏–µ (–∫ –Ω–µ–º—É –æ–±—Ä–∞—â–∞—é—Ç—Å—è)\n"
        participants_info += "        - –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–≥–æ–≤–æ—Ä—è—Ç –æ –Ω–µ–º)\n"
        participants_info += "–®–∞–≥ 3: –°–æ–ø–æ—Å—Ç–∞–≤—å –∏–º–µ–Ω–∞ —Å SPEAKER_N –∏—Å–ø–æ–ª—å–∑—É—è –ü–†–ò–û–†–ò–¢–ï–¢–´ –≤—ã—à–µ\n"
        participants_info += "–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–∞ –ü–†–û–¢–ò–í–û–†–ï–ß–ò–Ø –ø–æ –≤—Å–µ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "–®–∞–≥ 5: –í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û —É–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å > 70%)\n\n"
        
        participants_info += "üìù –§–û–†–ú–ê–¢ –ò–ú–ï–ù:\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ: '–ò–º—è –§–∞–º–∏–ª–∏—è' (–ë–ï–ó –æ—Ç—á–µ—Å—Ç–≤–∞)\n"
        participants_info += "   ‚Ä¢ –ü—Ä–µ–æ–±—Ä–∞–∑—É–π —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π, –í–æ–ª–æ–¥—è‚Üí–í–ª–∞–¥–∏–º–∏—Ä\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –Ω–µ —É–ø–æ–º—è–Ω—É—Ç–æ, –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ —á—Ç–æ –µ—Å—Ç—å: \"–ú–∞—Ä–∞—Ç\" –∏–ª–∏ \"–í–∏–∫—É–ª–∏–Ω\"\n\n"
        
        participants_info += "üìä –§–û–†–ú–ê–¢ –î–ï–¢–ê–õ–¨–ù–û–ì–û –ú–ê–ü–ü–ò–ù–ì–ê –í –û–¢–í–ï–¢–ï:\n\n"
        participants_info += "–î–ª—è –∫–∞–∂–¥–æ–≥–æ SPEAKER_N –∫–æ—Ç–æ—Ä—ã–π —Ç—ã —Å–æ–ø–æ—Å—Ç–∞–≤–∏–ª —Å –∏–º–µ–Ω–µ–º, —É–∫–∞–∂–∏:\n\n"
        participants_info += "1. speaker_mapping: {\"SPEAKER_1\": \"–ò–º—è –§–∞–º–∏–ª–∏—è\", ...}\n"
        participants_info += "2. confidence_scores: {\"SPEAKER_1\": 0.85, ...} –≥–¥–µ:\n"
        participants_info += "   - 0.9-1.0: –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–ø—Ä—è–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)\n"
        participants_info += "   - 0.7-0.9: –≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–æ–±—Ä–∞—â–µ–Ω–∏–µ + –æ—Ç–≤–µ—Ç)\n"
        participants_info += "   - 0.5-0.7: —Å—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —á—É–∂–∏—Ö —Å–ª–æ–≤)\n"
        participants_info += "   - < 0.5: –Ω–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–ù–ï –≤–∫–ª—é—á–∞–π –≤ –º–∞–ø–ø–∏–Ω–≥!)\n"
        participants_info += "3. unmapped_speakers: [\"SPEAKER_5\", \"SPEAKER_8\"] - —Å–ø–∏–∫–µ—Ä—ã –±–µ–∑ —É–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è\n"
        participants_info += "4. mapping_notes: \"–∫—Ä–∞—Ç–∫–æ–µ –ø–æ—è—Å–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è\"\n\n"
        participants_info += "‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:\n"
        participants_info += "   ‚Ä¢ –ù–ï –∑–∞–º–µ–Ω—è–π SPEAKER_N –Ω–∞ –∏–º–µ–Ω–∞ –≤ –ø–æ–ª—è—Ö segment_data!\n"
        participants_info += "   ‚Ä¢ –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤–µ—Ä–Ω–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è speaker_mapping, confidence_scores, unmapped_speakers\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ –∏–º—è –¥–ª—è SPEAKER_N –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - –¥–æ–±–∞–≤—å –µ–≥–æ –≤ unmapped_speakers\n"
        participants_info += "   ‚Ä¢ –ï—Å–ª–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å < 0.5 - –ù–ï –≤–∫–ª—é—á–∞–π –≤ –º–∞–ø–ø–∏–Ω–≥, –¥–æ–±–∞–≤—å –≤ unmapped_speakers\n\n"
        
        participants_info += "üö´ –°–¢–†–û–ì–ò–ï –ó–ê–ü–†–ï–¢–´:\n"
        participants_info += "   ‚ùå –ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏\n"
        participants_info += "   ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π '–£—á–∞—Å—Ç–Ω–∏–∫ 1', '–ö–æ–ª–ª–µ–≥–∞', '–ß–µ–ª–æ–≤–µ–∫ –ê'\n"
        participants_info += "   ‚ùå –ù–ï –¥—É–±–ª–∏—Ä—É–π: –µ—Å–ª–∏ –ú–∞—Ä–∞—Ç = SPEAKER_2, –¥–æ–±–∞–≤—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑\n"
        participants_info += "   ‚ùå –ù–ï –¥–æ–±–∞–≤–ª—è–π –∏–º–µ–Ω–∞ –∏–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Ö —É—á–∞—Å—Ç–∏—è\n\n"
        
        participants_info += "üí° –ü–†–ò–ú–ï–†–´ –ü–†–ê–í–ò–õ–¨–ù–´–• –û–¢–í–ï–¢–û–í:\n\n"
        
        participants_info += "–ü—Ä–∏–º–µ—Ä –ê - –ï—Å—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:\n"
        participants_info += "{\n"
        participants_info += "  \"segment_data\": {\n"
        participants_info += "    \"participants\": \"SPEAKER_1\\nSPEAKER_2\\nSPEAKER_3\",\n"
        participants_info += "    \"decisions\": \"- SPEAKER_1 –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Ä–∫–∏ –ö–ù–î–ú\"\n"
        participants_info += "  },\n"
        participants_info += "  \"speaker_mapping\": {\n"
        participants_info += "    \"SPEAKER_2\": \"–ú–∞—Ä–∞—Ç –ê–±–±–∞—Å–ª–∞–º–æ–≤\"\n"
        participants_info += "  },\n"
        participants_info += "  \"confidence_scores\": {\n"
        participants_info += "    \"SPEAKER_2\": 0.85\n"
        participants_info += "  },\n"
        participants_info += "  \"unmapped_speakers\": [\"SPEAKER_1\", \"SPEAKER_3\"],\n"
        participants_info += "  \"mapping_notes\": \"SPEAKER_2 –Ω–∞–∑–≤–∞–Ω '–ú–∞—Ä–∞—Ç' –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –æ—Ç SPEAKER_1. SPEAKER_1 –∏ SPEAKER_3 –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã.\",\n"
        participants_info += "  \"segment_confidence\": 0.85\n"
        participants_info += "}\n"
        participants_info += "–ü–æ—è—Å–Ω–µ–Ω–∏–µ: –î–ª—è SPEAKER_1 –∏ SPEAKER_3 –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö, –æ–Ω–∏ –≤ unmapped_speakers.\n\n"
        
        participants_info += "–ü—Ä–∏–º–µ—Ä –ë - –ù–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π:\n"
        participants_info += "{\n"
        participants_info += "  \"segment_data\": {\n"
        participants_info += "    \"participants\": \"SPEAKER_1\\nSPEAKER_2\",\n"
        participants_info += "    \"decisions\": \"- SPEAKER_1 –ø—Ä–µ–¥–ª–æ–∂–∏–ª –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥\"\n"
        participants_info += "  },\n"
        participants_info += "  \"speaker_mapping\": {},\n"
        participants_info += "  \"confidence_scores\": {},\n"
        participants_info += "  \"unmapped_speakers\": [\"SPEAKER_1\", \"SPEAKER_2\"],\n"
        participants_info += "  \"mapping_notes\": \"–í —Å–µ–≥–º–µ–Ω—Ç–µ –Ω–µ—Ç —è–≤–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏–º–µ–Ω –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π.\",\n"
        participants_info += "  \"segment_confidence\": 0.75\n"
        participants_info += "}\n"
        participants_info += "–ü–æ—è—Å–Ω–µ–Ω–∏–µ: –í—Å–µ —Å–ø–∏–∫–µ—Ä—ã –≤ unmapped_speakers —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.\n\n"
    
    prompt = f"""CHAIN-OF-THOUGHT: –ê–ù–ê–õ–ò–ó –°–ï–ì–ú–ï–ù–¢–ê {segment_id + 1} –ò–ó {total_segments}

–°–ï–ì–ú–ï–ù–¢ –¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–ò:
{segment_text}
{participants_info}
–ó–ê–î–ê–ß–ê:
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –≤—Å—Ç—Ä–µ—á–∏ –∏ –∏–∑–≤–ª–µ–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
{variables_str}

–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–ë–°–£–ñ–î–ï–ù–ò–Ø:
–ï—Å–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—à—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–∞–º/–∫–ª–∞—Å—Ç–µ—Ä–∞–º:
- –ù–ï –ø–∏—à–∏ —Å–ª–æ–≤–æ "–ö–ª–∞—Å—Ç–µ—Ä", —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º: "‚Ä¢ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã**"
- –ö–∞–∂–¥—É—é –∏–¥–µ—é/–≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ/–ø–æ–∑–∏—Ü–∏—é —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
- –§–æ—Ä–º–∞—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è: "–ò–º—è –ê–≤—Ç–æ—Ä–∞: —Ç–µ–∫—Å—Ç" (–±–µ–∑ —Å–ª–æ–≤–∞ "–ò–¥–µ—è", –±–µ–∑ —Å–∫–æ–±–æ–∫)
- –ú–µ–∂–¥—É —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

–ü—Ä–∏–º–µ—Ä—ã:
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è**

–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

‚úó –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ –ö–ª–∞—Å—Ç–µ—Ä ¬´–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è¬ª: –ò–¥–µ—è (–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ): –ø—Ä–µ–¥–ª–æ–∂–∏–ª...

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ü–†–ê–í–ò–õ–ê –ü–û –¢–ò–ü–ê–ú –ü–û–õ–ï–ô
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

{_build_field_specific_rules(template_variables)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–í–ê–ñ–ù–û:
- –≠—Ç–æ —Å–µ–≥–º–µ–Ω—Ç {segment_id + 1} –∏–∑ {total_segments} —á–∞—Å—Ç–µ–π –≤—Å—Ç—Ä–µ—á–∏
- –ò–∑–≤–ª–µ–∫–∞–π –¢–û–õ–¨–ö–û –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –≠–¢–û–ì–û —Å–µ–≥–º–µ–Ω—Ç–∞
- –ï—Å–ª–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∫–æ–π-—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - –ø–∏—à–∏ "–ù–µ—Ç –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ"
- –°–æ—Ö—Ä–∞–Ω—è–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: —ç—Ç–æ —á–∞—Å—Ç—å –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–æ–π –≤—Å—Ç—Ä–µ—á–∏
- –î–ª—è —Å–ø–∏—Å–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç: "- –ø—É–Ω–∫—Ç1\\n- –ø—É–Ω–∫—Ç2"

–§–û–†–ú–ê–¢ –í–´–í–û–î–ê:
JSON-–æ–±—ä–µ–∫—Ç —Å –®–ï–°–¢–¨–Æ –ø–æ–ª—è–º–∏:
- segment_data: –æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–∞–º–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–∑–Ω–∞—á–µ–Ω–∏—è - —Å—Ç—Ä–æ–∫–∏)
- speaker_mapping: –æ–±—ä–µ–∫—Ç —Å –º–∞–ø–ø–∏–Ω–≥–æ–º SPEAKER_N ‚Üí –∏–º–µ–Ω–∞ (—Ç–æ–ª—å–∫–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é ‚â• 0.5)
- confidence_scores: –æ–±—ä–µ–∫—Ç —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ SPEAKER_N –∏–∑ speaker_mapping (0.0-1.0)
- unmapped_speakers: –º–∞—Å—Å–∏–≤ —Å–æ SPEAKER_N –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å
- mapping_notes: —Å—Ç—Ä–æ–∫–∞ —Å –ø–æ—è—Å–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- segment_confidence: —á–∏—Å–ª–æ –æ—Ç 0.0 –¥–æ 1.0

–í—ã–≤–µ–¥–∏ –¢–û–õ–¨–ö–û JSON, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."""

    return prompt


def _build_synthesis_prompt(
    segment_results: List[Dict[str, Any]],
    transcription: str,
    template_variables: Dict[str, str],
    diarization_analysis: Optional[Dict[str, Any]] = None,
    participants: Optional[List[Dict[str, str]]] = None,
    meeting_topic: Optional[str] = None,
    meeting_date: Optional[str] = None,
    meeting_time: Optional[str] = None
) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    """
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    segments_summary = ""
    for i, result in enumerate(segment_results):
        segments_summary += f"\n--- –°–ï–ì–ú–ï–ù–¢ {i + 1} ---\n"
        segments_summary += json.dumps(result, ensure_ascii=False, indent=2)
        segments_summary += "\n"
    
    # –°–æ–±–∏—Ä–∞–µ–º speaker_mapping –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    all_speaker_mappings = []
    for i, result in enumerate(segment_results):
        if 'speaker_mapping' in result and result['speaker_mapping']:
            all_speaker_mappings.append(f"–°–µ–≥–º–µ–Ω—Ç {i+1}: {json.dumps(result['speaker_mapping'], ensure_ascii=False)}")
    
    speaker_mappings_context = ""
    if all_speaker_mappings:
        speaker_mappings_context = "\n\n–ú–ê–ü–ü–ò–ù–ì–ò –£–ß–ê–°–¢–ù–ò–ö–û–í –ò–ó –°–ï–ì–ú–ï–ù–¢–û–í:\n"
        speaker_mappings_context += "\n".join(all_speaker_mappings)
        speaker_mappings_context += "\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
    diarization_context = ""
    if diarization_analysis:
        speakers_info = diarization_analysis.get('speakers', {})
        if speakers_info:
            diarization_context = "\n\n–ê–ù–ê–õ–ò–ó –£–ß–ê–°–¢–ù–ò–ö–û–í –í–°–¢–†–ï–ß–ò:\n"
            for speaker_id, info in speakers_info.items():
                role = info.get('role', '—É—á–∞—Å—Ç–Ω–∏–∫')
                time_percent = info.get('speaking_time_percent', 0)
                diarization_context += f"- {speaker_id} ({role}): {time_percent:.1f}% –≤—Ä–µ–º–µ–Ω–∏\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –µ—Å–ª–∏ –µ—Å—Ç—å
    participants_context = ""
    if participants:
        participants_context = "\n\n–ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í:\n"
        from src.services.participants_service import participants_service
        participants_context += participants_service.format_participants_for_llm(participants)
        participants_context += "\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å—Ç—Ä–µ—á–µ
    meeting_info = ""
    if meeting_topic or meeting_date or meeting_time:
        meeting_info = "\n\n" + "‚ïê" * 63 + "\n"
        meeting_info += "–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–°–¢–†–ï–ß–ï\n"
        meeting_info += "‚ïê" * 63 + "\n\n"
        
        if meeting_topic:
            meeting_info += f"üìã –¢–µ–º–∞: {meeting_topic}\n"
        if meeting_date:
            meeting_info += f"üìÖ –î–∞—Ç–∞: {meeting_date}\n"
        if meeting_time:
            meeting_info += f"üïê –í—Ä–µ–º—è: {meeting_time}\n"
        meeting_info += "\n"
        meeting_info += "‚ö†Ô∏è –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞!\n\n"
    
    variables_str = "\n".join([f"- {key}: {desc}" for key, desc in template_variables.items()])
    
    prompt = f"""CHAIN-OF-THOUGHT: –°–ò–ù–¢–ï–ó –§–ò–ù–ê–õ–¨–ù–û–ì–û –ü–†–û–¢–û–ö–û–õ–ê

–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê –°–ï–ì–ú–ï–ù–¢–û–í:
{segments_summary}
{speaker_mappings_context}
{diarization_context}
{participants_context}
{meeting_info}

–ó–ê–î–ê–ß–ê:
–û–±—ä–µ–¥–∏–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –µ–¥–∏–Ω—ã–π —Å–≤—è–∑–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
{variables_str}

–ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –°–ò–ù–¢–ï–ó–£:
1. –û–ë–™–ï–î–ò–ù–ï–ù–ò–ï: –°–æ–±–µ—Ä–∏ –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ
2. –î–ï–î–£–ü–õ–ò–ö–ê–¶–ò–Ø: –£–¥–∞–ª–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏
3. –•–†–û–ù–û–õ–û–ì–ò–Ø: –°–æ—Ö—Ä–∞–Ω–∏ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π
4. –°–í–Ø–ó–ù–û–°–¢–¨: –°–æ–∑–¥–∞–π —Å–≤—è–∑–Ω–æ–µ –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, –∞ –Ω–µ —Å–ø–∏—Å–æ–∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
5. –ü–û–õ–ù–û–¢–ê: –í–∫–ª—é—á–∏ –≤—Å—é –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
6. –ö–û–ù–¢–ï–ö–°–¢: –ò—Å–ø–æ–ª—å–∑—É–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–∏–∫–µ—Ä–∞—Ö –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
7. –û–ë–™–ï–î–ò–ù–ï–ù–ò–ï SPEAKER_MAPPING:
   - –°–æ–±–µ—Ä–∏ –≤—Å–µ speaker_mapping –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
   - –°–æ–∑–¥–∞–π –µ–¥–∏–Ω—ã–π final_speaker_mapping, —Ä–∞–∑—Ä–µ—à–∏–≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã:
     * –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –¥–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –∏–º–µ–Ω–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ SPEAKER_N - –≤—ã–±–µ—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–µ/–¥–µ—Ç–∞–ª—å–Ω–æ–µ
     * –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: "–ò–º—è –§–∞–º–∏–ª–∏—è" > "–ò–º—è" > –ø–µ—Ä–≤–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π final_speaker_mapping –¥–ª—è –∑–∞–º–µ–Ω—ã SPEAKER_N –Ω–∞ –∏–º–µ–Ω–∞ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ
   - –ï—Å–ª–∏ –¥–ª—è SPEAKER_N –Ω–µ—Ç –º–∞–ø–ø–∏–Ω–≥–∞ - –æ—Å—Ç–∞–≤—å SPEAKER_N –∫–∞–∫ –µ—Å—Ç—å

8. –ê–ì–†–ï–ì–ê–¶–ò–Ø –î–ï–¢–ê–õ–¨–ù–û–ô –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –ú–ê–ü–ü–ò–ù–ì–ê–•:
   
   –ò–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å–æ–±–µ—Ä–∏:
   - speaker_mapping –∏ confidence_scores –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
   
   –°–æ–∑–¥–∞–π final_speaker_mapping (—Å–º. –ø—É–Ω–∫—Ç 7)
   
   –°–æ–∑–¥–∞–π final_confidence_scores:
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ SPEAKER_N –≤ final_speaker_mapping: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è confidence –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
   - –ï—Å–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö —Ä–∞–∑–Ω—ã–µ confidence –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–ø–∏–∫–µ—Ä–∞ - –±–µ—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é
   - –ü—Ä–∏–º–µ—Ä: SPEAKER_1 –≤ —Å–µ–≥–º–µ–Ω—Ç–µ 1 = 0.85, –≤ —Å–µ–≥–º–µ–Ω—Ç–µ 3 = 0.92 ‚Üí final = 0.92
   
   –°–æ–∑–¥–∞–π final_unmapped_speakers:
   - –í—Å–µ SPEAKER_N –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ unmapped_speakers —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ
   - –ù–û –∏—Å–∫–ª—é—á–∏ —Ç–µ—Ö, –¥–ª—è –∫–æ–≥–æ –Ω–∞–π–¥–µ–Ω –º–∞–ø–ø–∏–Ω–≥ –≤ –¥—Ä—É–≥–∏—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö (–µ—Å—Ç—å –≤ final_speaker_mapping)
   - –ü—Ä–∏–º–µ—Ä: SPEAKER_5 –≤ unmapped –≤ —Å–µ–≥–º–µ–Ω—Ç–∞—Ö 1,2,3 –∏ –Ω–µ—Ç –≤ –º–∞–ø–ø–∏–Ω–≥–∞—Ö ‚Üí –¥–æ–±–∞–≤—å –≤ final_unmapped
   
   –°–æ–∑–¥–∞–π aggregation_notes:
   - –û–ø–∏—à–∏ –∫–∞–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–µ—Å–ª–∏ –±—ã–ª–∏)
   - –£–∫–∞–∂–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –º–∞–ø–ø–∏–Ω–≥–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä "3 –∏–∑ 5 —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å–æ–¥–µ—Ä–∂–∞–ª–∏ –º–∞–ø–ø–∏–Ω–≥–∏")
   - –û—Ç–º–µ—Ç—å —Å–ø–∏–∫–µ—Ä–æ–≤ —Å –Ω–∏–∑–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é (< 0.7)
   - –ü–µ—Ä–µ—á–∏—Å–ª–∏ unmapped —Å–ø–∏–∫–µ—Ä–æ–≤ –µ—Å–ª–∏ –µ—Å—Ç—å
   - –ü—Ä–∏–º–µ—Ä: "–ù–∞–π–¥–µ–Ω—ã –º–∞–ø–ø–∏–Ω–≥–∏ –≤ 3 –∏–∑ 5 —Å–µ–≥–º–µ–Ω—Ç–æ–≤. SPEAKER_1 (confidence 0.92) –∏ SPEAKER_2 (0.85) —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã. SPEAKER_3, SPEAKER_5 –Ω–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã."

–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –ü–†–ï–î–û–°–¢–ê–í–õ–ï–ù–ù–´–• –î–ê–ù–ù–´–• –û –í–°–¢–†–ï–ß–ï:

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
1. –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤—ã—à–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–°–¢–†–ï–ß–ï (—Ç–µ–º–∞, –¥–∞—Ç–∞, –≤—Ä–µ–º—è):
   ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–∏ –¢–û–ß–ù–´–ï –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—è—Ö —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
   ‚Üí –ü–æ–ª—è: "date", "time" (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ template_variables)

2. –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤—ã—à–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í:
   ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π –í–ï–°–¨ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–∏–∫–æ–º –≤ –ø–æ–ª–µ "participants"
   ‚Üí –ù–ï –ø—ã—Ç–∞–π—Å—è –∏–∑–≤–ª–µ–∫–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
   ‚Üí –ù–ï –¥–æ–±–∞–≤–ª—è–π/—É–¥–∞–ª—è–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞
   ‚Üí –§–æ—Ä–º–∞—Ç: –∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ "–ò–º—è –§–∞–º–∏–ª–∏—è\\n–ò–º—è –§–∞–º–∏–ª–∏—è\\n...", –ë–ï–ó —Ä–æ–ª–µ–π
   ‚Üí –°–æ—Ö—Ä–∞–Ω–∏ –ø–æ—Ä—è–¥–æ–∫ –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
   
3. –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ù–ï –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω:
   ‚Üí –¢–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –∏–∑–≤–ª–µ–∫–∞–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (—Å–º. –ø—Ä–∞–≤–∏–ª–∞ –Ω–∏–∂–µ)

–°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ü–†–ê–í–ò–õ–ê:
- –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–π –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é
- –û–±—ä–µ–¥–∏–Ω—è–π –ø–æ—Ö–æ–∂–∏–µ –ø—É–Ω–∫—Ç—ã –≤ —Å–ø–∏—Å–∫–∞—Ö
- –ì—Ä—É–ø–ø–∏—Ä—É–π –∑–∞–¥–∞—á–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ —Å–º—ã—Å–ª–æ–≤—ã–º –±–ª–æ–∫–∞–º
- –î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: –µ—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –£–ß–ê–°–¢–ù–ò–ö–û–í –≤—ã—à–µ - –∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ —Ü–µ–ª–∏–∫–æ–º; –µ—Å–ª–∏ —Å–ø–∏—Å–∫–∞ –Ω–µ—Ç - –æ–±—ä–µ–¥–∏–Ω–∏ –≤—Å–µ—Ö —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, –∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –ë–ï–ó —Ä–æ–ª–µ–π
- –î–ª—è –∑–∞–¥–∞—á: —É–∫–∞–∂–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑ —á–∏—Å–ª–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ

–°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–ï –ò–ú–ï–ù:
- –ï—Å–ª–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç–∞—Ö –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –°–û–ü–û–°–¢–ê–í–õ–Ø–ô –∏—Ö —Å –ø–æ–ª–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—ã—à–µ
- –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏–∫–∏ (–ø—Ä–∏–º–µ–Ω—è–π –∫–æ –í–°–ï–ú —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∏–∑ —Å–ø–∏—Å–∫–∞):
  ‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ: –°–≤–µ—Ç–∞‚Üí–°–≤–µ—Ç–ª–∞–Ω–∞ –ö–æ—Ä–æ—Ç–∫–æ–≤–∞, –õ–µ—à–∞‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ –∏ —Ç.–¥.
  ‚Ä¢ –ü–æ —Ñ–∞–º–∏–ª–∏–∏: –¢–∏–º—á–µ–Ω–∫–æ‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ –∏ —Ç.–¥.
  ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–º—è: –ê–ª–µ–∫—Å–µ–π‚Üí–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ
- ‚ö° –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π –í–ï–°–¨ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Å—è —ç—Ç–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏!
- –í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–´–ï –ò–ú–ï–ù–ê –∏–∑ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–ë–°–£–ñ–î–ï–ù–ò–Ø:
–ï—Å–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—à—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–∞–º/–∫–ª–∞—Å—Ç–µ—Ä–∞–º:
- –ù–ï –ø–∏—à–∏ —Å–ª–æ–≤–æ "–ö–ª–∞—Å—Ç–µ—Ä", —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º: "‚Ä¢ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã**"
- –ö–∞–∂–¥—É—é –∏–¥–µ—é/–≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ/–ø–æ–∑–∏—Ü–∏—é —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
- –§–æ—Ä–º–∞—Ç –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è: "–ò–º—è –ê–≤—Ç–æ—Ä–∞: —Ç–µ–∫—Å—Ç" (–±–µ–∑ —Å–ª–æ–≤–∞ "–ò–¥–µ—è", –±–µ–∑ —Å–∫–æ–±–æ–∫)
- –ú–µ–∂–¥—É —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –æ—Å—Ç–∞–≤–ª—è–π –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

–ü—Ä–∏–º–µ—Ä—ã:
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é –ª–æ–≥–∏—Å—Ç–∏–∫—É**

–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –º–µ—Ö–∞–Ω–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è

–ì–∞–ª–∏–Ω–∞ –Ø–º–∫–∏–Ω–∞: –¥–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

‚úó –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
‚Ä¢ –ö–ª–∞—Å—Ç–µ—Ä ¬´–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é –ª–æ–≥–∏—Å—Ç–∏–∫—É¬ª: –ò–¥–µ—è (–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ): —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å...

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ü–†–ê–í–ò–õ–ê –ü–û –¢–ò–ü–ê–ú –ü–û–õ–ï–ô
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

{_build_field_specific_rules(template_variables)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π:
- –í–°–ï –∑–Ω–∞—á–µ–Ω–∏—è –≤ JSON –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ü–†–û–°–¢–´–ú–ò –°–¢–†–û–ö–ê–ú–ò (string)
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã {{}} –∏–ª–∏ –º–∞—Å—Å–∏–≤—ã [] –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π
- –°–ø–∏—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–π –∫–∞–∫ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç: "- –ø—É–Ω–∫—Ç1\\n- –ø—É–Ω–∫—Ç2\\n- –ø—É–Ω–∫—Ç3"
- –î–∞—Ç—ã: –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç —Ç–∏–ø–∞ "20 –æ–∫—Ç—è–±—Ä—è 2024", –ù–ï {{"day": 20}}
- –£—á–∞—Å—Ç–Ω–∏–∫–∏: –∫–∞–∂–¥–æ–µ –∏–º—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ "–ò–º—è1\\n–ò–º—è2\\n–ò–º—è3", –ë–ï–ó —Ä–æ–ª–µ–π!, –ù–ï [{{"name": "–ò–º—è"}}]
- –í—Ä–µ–º—è: "14:30" –∏–ª–∏ "—Å 14:00 –¥–æ 15:30", –ù–ï {{"start": "14:00"}}

–ü–†–ò–ú–ï–† –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –í–´–í–û–î–ê:
{{
  "date": "20 –æ–∫—Ç—è–±—Ä—è 2024",
  "participants": "–û–∫—Å–∞–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞\\n–ì–∞–ª–∏–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞\\n–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ\\n–î–º–∏—Ç—Ä–∏–π –°–∏–¥–æ—Ä–æ–≤",
  "decisions": "- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∞ –¥–ª—è —Å—Ç—Ä–æ–∫ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–º–∏ –º–∞—Ä–∫–∞–º–∏\\n- –ù–µ —Å—Ç–æ–ø–æ—Ä–∏—Ç—å –ø–æ—Ç–æ–∫ –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫\\n- –û—Ñ–æ—Ä–º–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ CAP-–∑–∞–¥–∞—á–∏"
}}
‚òùÔ∏è –í–ù–ò–ú–ê–ù–ò–ï: –ü–æ–ª–µ "participants" –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –í–ï–°–¨ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ!

–§–û–†–ú–ê–¢ –í–´–í–û–î–ê:
JSON-–æ–±—ä–µ–∫—Ç —Å –°–ï–ú–¨–Æ –ø–æ–ª—è–º–∏:
- synthesized_content: –æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–∞–º–∏ –∏–∑ template_variables (–∑–Ω–∞—á–µ–Ω–∏—è - —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–º–µ–Ω–æ–π SPEAKER_N –Ω–∞ –∏–º–µ–Ω–∞)
- final_speaker_mapping: –æ–±—ä–µ–∫—Ç —Å –∏—Ç–æ–≥–æ–≤—ã–º –º–∞–ø–ø–∏–Ω–≥–æ–º SPEAKER_N ‚Üí –∏–º–µ–Ω–∞
- final_confidence_scores: –æ–±—ä–µ–∫—Ç —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏–∫–µ—Ä–∞ –∏–∑ final_speaker_mapping (0.0-1.0)
- final_unmapped_speakers: –º–∞—Å—Å–∏–≤ —Å–æ SPEAKER_N –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å
- aggregation_notes: —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–º–µ—Ç–∫–∞–º–∏ –ø–æ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –º–∞–ø–ø–∏–Ω–≥–æ–≤ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- synthesis_quality: —á–∏—Å–ª–æ –æ—Ç 0.0 –¥–æ 1.0
- synthesis_notes: —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–º–µ—Ç–∫–∞–º–∏ –ø–æ —Å–∏–Ω—Ç–µ–∑—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–í—ã–≤–µ–¥–∏ –¢–û–õ–¨–ö–û JSON, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."""

    return prompt


async def _process_single_segment(
    segment: 'TranscriptionSegment',
    segment_idx: int,
    total_segments: int,
    client: openai.OpenAI,
    selected_model: str,
    system_prompt: str,
    template_variables: Dict[str, str],
    extra_headers: Dict[str, str],
    retry_manager: Optional[RetryManager],
    speaker_mapping: Optional[Dict[str, str]] = None,
    participants: Optional[List[Dict[str, str]]] = None,
    attempt_number: int = 1
) -> Tuple[int, Dict[str, Any]]:
    """
    –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω —Å–µ–≥–º–µ–Ω—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    
    Args:
        segment: –°–µ–≥–º–µ–Ω—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        segment_idx: –ò–Ω–¥–µ–∫—Å —Å–µ–≥–º–µ–Ω—Ç–∞
        total_segments: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        client: OpenAI –∫–ª–∏–µ–Ω—Ç
        selected_model: –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        system_prompt: –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        extra_headers: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
        retry_manager: –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å None)
        speaker_mapping: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏–∫–µ—Ä–æ–≤ —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
        participants: –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—Å—Ç—Ä–µ—á–∏
        attempt_number: –ù–æ–º–µ—Ä –ø–æ–ø—ã—Ç–∫–∏ (–¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã)
        
    Returns:
        –ö–æ—Ä—Ç–µ–∂ (–∏–Ω–¥–µ–∫—Å_—Å–µ–≥–º–µ–Ω—Ç–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç_–æ–±—Ä–∞–±–æ—Ç–∫–∏)
    """
    logger.info(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}/{total_segments} (–ø–æ–ø—ã—Ç–∫–∞ {attempt_number})")
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –æ–±—ã—á–Ω—ã–π
    segment_text = segment.formatted_text if segment.formatted_text else segment.text
    
    # –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 0.1 ‚Üí 0.3 ‚Üí 0.5
    temperature = 0.1 + (attempt_number - 1) * 0.2
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ —Å —É—Å–∏–ª–µ–Ω–Ω—ã–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –æ JSON –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
    segment_prompt = _build_segment_analysis_prompt(
        segment_text=segment_text,
        segment_id=segment_idx,
        total_segments=total_segments,
        template_variables=template_variables,
        speaker_mapping=speaker_mapping,
        participants=participants
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º —É—Å–∏–ª–µ–Ω–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ JSON –Ω–∞ –ø–æ–ø—ã—Ç–∫–∞—Ö 2-3
    if attempt_number > 1:
        json_reminder = f"""

‚ö†Ô∏è –í–ê–ñ–ù–û: –≠—Ç–æ –ø–æ–ø—ã—Ç–∫–∞ {attempt_number}. –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–µ—Ä–Ω–∏ –í–ê–õ–ò–î–ù–´–ô JSON!
- –ù–∞—á–∏–Ω–∞–π –æ—Ç–≤–µ—Ç —Å—Ä–∞–∑—É —Å {{ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–π }}
- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞–º–∏
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤–Ω–µ JSON
- –ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ –¥–∞–Ω–Ω—ã—Ö - –∏—Å–ø–æ–ª—å–∑—É–π "–ù–µ —É–∫–∞–∑–∞–Ω–æ"

"""
        segment_prompt = json_reminder + segment_prompt
    
    # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–µ–≥–º–µ–Ω—Ç–∞
    if settings.llm_debug_log:
        logger.debug("=" * 80)
        logger.debug(f"[DEBUG] OpenAI REQUEST - Chain-of-Thought Segment {segment_idx + 1}/{total_segments} (–ø–æ–ø—ã—Ç–∫–∞ {attempt_number})")
        logger.debug("=" * 80)
        logger.debug(f"Temperature: {temperature}")
        logger.debug(f"Segment prompt:\n{segment_prompt}")
        logger.debug("=" * 80)
    
    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ OpenAI API —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π
    async def _call_openai_api():
        return await asyncio.to_thread(
            client.chat.completions.create,
            model=selected_model,
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": segment_prompt}
            ],
            temperature=temperature,
            response_format={"type": "json_schema", "json_schema": SEGMENT_SCHEMA},
            extra_headers=extra_headers
        )
    
    # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å —Å retry –ª–æ–≥–∏–∫–æ–π (–µ—Å–ª–∏ retry_manager –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω)
    try:
        if retry_manager:
            response = await retry_manager.execute_with_retry(_call_openai_api)
        else:
            # –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –±–µ–∑ retry (retry —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—ã—à–µ)
            response = await _call_openai_api()
    except openai.APIStatusError as e:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫—É 402 - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
        if e.status_code == 402:
            error_message = e.message
            # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞
            if hasattr(e, 'response') and e.response:
                try:
                    error_body = e.response.json()
                    if 'error' in error_body and 'message' in error_body['error']:
                        error_message = error_body['error']['message']
                except:
                    pass
            logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM: {error_message}")
            raise LLMInsufficientCreditsError(
                message=error_message,
                provider="openai",
                model=selected_model
            )
        # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ API –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–ª—å—à–µ
        raise
    
    content = response.choices[0].message.content
    
    # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å–µ–≥–º–µ–Ω—Ç–∞
    if settings.llm_debug_log:
        logger.debug("=" * 80)
        logger.debug(f"[DEBUG] OpenAI RESPONSE - Chain-of-Thought Segment {segment_idx + 1}/{total_segments} (–ø–æ–ø—ã—Ç–∫–∞ {attempt_number})")
        logger.debug("=" * 80)
        if hasattr(response, 'usage'):
            logger.debug(f"Usage: {response.usage}")
        logger.debug(f"Content:\n{content}")
        logger.debug("=" * 80)
    
    # –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON —Å fallback –Ω–∞ —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    segment_result = None
    
    # –ü–æ–ø—ã—Ç–∫–∞ 1: –ü—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥ JSON
    try:
        segment_result = json.loads(content)
        logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω (–ø—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥)")
    except json.JSONDecodeError as e:
        logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –û—à–∏–±–∫–∞ –ø—Ä—è–º–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: {e}")
        
        # –ü–æ–ø—ã—Ç–∫–∞ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ JSON –∏–∑ —Ç–µ–∫—Å—Ç–∞
        start_idx = content.find('{')
        end_idx = content.rfind('}') + 1
        
        if start_idx != -1 and end_idx > start_idx:
            json_str = content[start_idx:end_idx]
            try:
                segment_result = json.loads(json_str)
                logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: JSON —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω –∏–∑ —Ç–µ–∫—Å—Ç–∞")
            except json.JSONDecodeError as e2:
                logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ JSON: {e2}")
                # –ü–æ–ø—ã—Ç–∫–∞ 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                segment_result = _extract_partial_data_from_text(content, template_variables)
                logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback –Ω–∞ —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
        else:
            logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: JSON –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ")
            # –ü–æ–ø—ã—Ç–∫–∞ 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            segment_result = _extract_partial_data_from_text(content, template_variables)
            logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback –Ω–∞ —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª—é—á–∏
    if not segment_result:
        logger.error(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –ü–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å–æ–∑–¥–∞–µ–º –∑–∞–≥–ª—É—à–∫—É")
        segment_result = {
            'segment_data': {key: "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞" for key in template_variables.keys()},
            'speaker_mapping': {},
            'confidence_scores': {},
            'unmapped_speakers': [],
            'mapping_notes': '',
            'segment_confidence': 0.0
        }
    else:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–ª–µ–π
        if 'segment_data' not in segment_result:
            # –ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–±–µ–∑ segment_data), –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º
            segment_data = {key: segment_result.get(key, "–ù–µ —É–∫–∞–∑–∞–Ω–æ") for key in template_variables.keys()}
            segment_result = {
                'segment_data': segment_data,
                'speaker_mapping': segment_result.get('speaker_mapping', {}),
                'confidence_scores': segment_result.get('confidence_scores', {}),
                'unmapped_speakers': segment_result.get('unmapped_speakers', []),
                'mapping_notes': segment_result.get('mapping_notes', ''),
                'segment_confidence': segment_result.get('segment_confidence', 0.0)
            }
        else:
            # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Å–µ –∫–ª—é—á–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ segment_data
            for key in template_variables.keys():
                if key not in segment_result['segment_data']:
                    segment_result['segment_data'][key] = "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
            
            # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
            if 'confidence_scores' not in segment_result:
                segment_result['confidence_scores'] = {}
            if 'unmapped_speakers' not in segment_result:
                segment_result['unmapped_speakers'] = []
            if 'mapping_notes' not in segment_result:
                segment_result['mapping_notes'] = ''
        
        # –õ–æ–≥–∏—Ä—É–µ–º speaker_mapping –∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –µ—Å–ª–∏ –µ—Å—Ç—å
        if segment_result.get('speaker_mapping'):
            logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: –Ω–∞–π–¥–µ–Ω speaker_mapping: {segment_result['speaker_mapping']}")
        
        if segment_result.get('confidence_scores'):
            logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: confidence_scores: {segment_result['confidence_scores']}")
        
        if segment_result.get('unmapped_speakers'):
            logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1}: unmapped_speakers: {segment_result['unmapped_speakers']}")
    
    logger.info(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1} –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ")
    
    return (segment_idx, segment_result)


async def _process_single_segment_with_adaptive_retry(
    segment: 'TranscriptionSegment',
    segment_idx: int,
    total_segments: int,
    client: openai.OpenAI,
    selected_model: str,
    system_prompt: str,
    template_variables: Dict[str, str],
    extra_headers: Dict[str, str],
    speaker_mapping: Optional[Dict[str, str]] = None,
    participants: Optional[List[Dict[str, str]]] = None
) -> Tuple[int, Dict[str, Any]]:
    """
    –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω —Å–µ–≥–º–µ–Ω—Ç —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π retry-–ª–æ–≥–∏–∫–æ–π (3 –ø–æ–ø—ã—Ç–∫–∏ —Å —Ä–∞–∑–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π)
    
    Args:
        segment: –°–µ–≥–º–µ–Ω—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        segment_idx: –ò–Ω–¥–µ–∫—Å —Å–µ–≥–º–µ–Ω—Ç–∞
        total_segments: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        client: OpenAI –∫–ª–∏–µ–Ω—Ç
        selected_model: –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        system_prompt: –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        extra_headers: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
        speaker_mapping: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏–∫–µ—Ä–æ–≤ —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
        participants: –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—Å—Ç—Ä–µ—á–∏
        
    Returns:
        –ö–æ—Ä—Ç–µ–∂ (–∏–Ω–¥–µ–∫—Å_—Å–µ–≥–º–µ–Ω—Ç–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç_–æ–±—Ä–∞–±–æ—Ç–∫–∏)
    """
    max_attempts = 3
    last_exception = None
    
    for attempt in range(1, max_attempts + 1):
        try:
            logger.debug(f"–ü–æ–ø—ã—Ç–∫–∞ {attempt}/{max_attempts} –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}")
            
            result = await _process_single_segment(
                segment=segment,
                segment_idx=segment_idx,
                total_segments=total_segments,
                client=client,
                selected_model=selected_model,
                system_prompt=system_prompt,
                template_variables=template_variables,
                extra_headers=extra_headers,
                retry_manager=None,  # –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π retry_manager
                speaker_mapping=speaker_mapping,
                participants=participants,
                attempt_number=attempt
            )
            
            if attempt > 1:
                logger.info(f"–°–µ–≥–º–µ–Ω—Ç {segment_idx + 1} —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω –ø–æ—Å–ª–µ {attempt} –ø–æ–ø—ã—Ç–æ–∫")
            
            return result
            
        except Exception as e:
            last_exception = e
            
            # –ï—Å–ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤ - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–µ–º
            if isinstance(e, LLMInsufficientCreditsError):
                logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}: {e}")
                raise
            
            # –ï—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
            if attempt == max_attempts:
                logger.warning(f"–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}: {e}")
                logger.warning(f"–ò—Å–ø–æ–ª—å–∑—É–µ–º fallback –Ω–∞ —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}")
                
                # –°–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                segment_text = segment.formatted_text if segment.formatted_text else segment.text
                fallback_result = _extract_partial_data_from_text(segment_text, template_variables)
                
                return (segment_idx, fallback_result)
            
            # –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–æ–π
            delay = 1.0 * (2 ** (attempt - 1))  # 1s, 2s, 4s
            logger.warning(f"–ü–æ–ø—ã—Ç–∫–∞ {attempt} –Ω–µ—É–¥–∞—á–Ω–∞ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞ {segment_idx + 1}: {e}. –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ {delay:.1f}—Å")
            await asyncio.sleep(delay)
    
    # –≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ –¥–æ–ª–∂–µ–Ω –¥–æ—Å—Ç–∏–≥–∞—Ç—å—Å—è, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
    if last_exception:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ {segment_idx + 1}: {last_exception}")
        # –°–æ–∑–¥–∞–µ–º –∑–∞–≥–ª—É—à–∫—É
        fallback_result = {key: "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞" for key in template_variables.keys()}
        return (segment_idx, fallback_result)


def _extract_partial_data_from_text(
    content: str,
    template_variables: Dict[str, str]
) -> Dict[str, str]:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∫–æ–≥–¥–∞ JSON –Ω–µ–≤–∞–ª–∏–¥–µ–Ω.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä.
    
    Args:
        content: –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç –æ—Ç LLM
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∫–ª—é—á–∏)
    """
    logger.warning(f"–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–∫—Å—Ç–∞ (–¥–ª–∏–Ω–∞: {len(content)})")
    
    result = {}
    content_lower = content.lower()
    
    # –ú–∞–ø–ø–∏–Ω–≥ –∫–ª—é—á–µ–π –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
    key_patterns = {
        'participants': ['—É—á–∞—Å—Ç–Ω–∏–∫–∏', '—É—á–∞—Å—Ç–Ω–∏–∫', '–ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏', '–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç', '—Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤'],
        'decisions': ['—Ä–µ—à–µ–Ω–∏—è', '—Ä–µ—à–µ–Ω–∏–µ', '–ø—Ä–∏–Ω—è—Ç–æ', '—Ä–µ—à–∏–ª–∏', '–¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å'],
        'tasks': ['–∑–∞–¥–∞—á–∏', '–∑–∞–¥–∞—á–∞', '–¥–µ–π—Å—Ç–≤–∏—è', '–ø–ª–∞–Ω', '—Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏'],
        'discussion': ['–æ–±—Å—É–∂–¥–µ–Ω–∏–µ', '–æ–±—Å—É–∂–¥–∞–ª–∏', '—Ç–µ–º—ã', '–≤–æ–ø—Ä–æ—Å—ã', '–ø—Ä–æ–±–ª–µ–º—ã'],
        'agenda': ['–ø–æ–≤–µ—Å—Ç–∫–∞', '–ø—É–Ω–∫—Ç—ã', '–≤–æ–ø—Ä–æ—Å—ã –ø–æ–≤–µ—Å—Ç–∫–∏', '–ø–ª–∞–Ω –≤—Å—Ç—Ä–µ—á–∏'],
        'time': ['–≤—Ä–µ–º—è', '–¥–∞—Ç–∞', '–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–Ω–∞—á–∞–ª–æ', '–æ–∫–æ–Ω—á–∞–Ω–∏–µ'],
        'date': ['–¥–∞—Ç–∞', '—á–∏—Å–ª–æ', '–¥–µ–Ω—å', '–º–µ—Å—è—Ü', '–≥–æ–¥'],
        'next_steps': ['—Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏', '–¥–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è', '–ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π']
    }
    
    for key in template_variables.keys():
        result[key] = "–ù–µ —É–∫–∞–∑–∞–Ω–æ"  # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
        patterns = key_patterns.get(key, [key])
        
        for pattern in patterns:
            # –ò—â–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
            pattern_pos = content_lower.find(pattern)
            if pattern_pos != -1:
                # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
                start_pos = pattern_pos + len(pattern)
                remaining_text = content[start_pos:start_pos + 500]  # –ë–µ—Ä–µ–º 500 —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Å–ª–µ
                
                # –ò—â–µ–º —Å–ø–∏—Å–æ–∫ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
                lines = remaining_text.split('\n')
                extracted_lines = []
                
                for line in lines[:10]:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫
                    line = line.strip()
                    if not line:
                        continue
                    
                    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–ª–æ–≤–∞
                    if any(skip in line.lower() for skip in ['json', '—Ñ–æ—Ä–º–∞—Ç', '–≤—ã–≤–æ–¥', '–æ—Ç–≤–µ—Ç']):
                        continue
                    
                    # –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    if len(line) > 3 and not line.startswith('{') and not line.startswith('}'):
                        # –û—á–∏—â–∞–µ–º –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
                        clean_line = line.strip('.,:;').strip()
                        if clean_line and clean_line not in ['–ù–µ —É–∫–∞–∑–∞–Ω–æ', '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö']:
                            extracted_lines.append(clean_line)
                
                if extracted_lines:
                    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                    if key in ['decisions', 'tasks', 'next_steps', 'agenda']:
                        formatted_lines = [f"- {line}" for line in extracted_lines[:5]]  # –ú–∞–∫—Å–∏–º—É–º 5 –ø—É–Ω–∫—Ç–æ–≤
                        result[key] = "\n".join(formatted_lines)
                    else:
                        result[key] = "\n".join(extracted_lines[:3])  # –ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—Ä–æ–∫–∏
                    break
    
    # –õ–æ–≥–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
    extracted_count = sum(1 for v in result.values() if v != "–ù–µ —É–∫–∞–∑–∞–Ω–æ")
    logger.info(f"–ò–∑–≤–ª–µ—á–µ–Ω–æ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {extracted_count}/{len(template_variables)} –ø–æ–ª–µ–π")
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å segment_data –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
    return {
        'segment_data': result,
        'speaker_mapping': {},
        'confidence_scores': {},
        'unmapped_speakers': [],
        'mapping_notes': 'Fallback –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ: speaker mapping –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',
        'segment_confidence': 0.5  # –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è fallback
    }


def _merge_segment_results_fallback(
    segment_results: List[Dict[str, Any]], 
    template_variables: Dict[str, str]
) -> Dict[str, Any]:
    """
    –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª (fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è).
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ —Å–∏–Ω—Ç–µ–∑ —á–µ—Ä–µ–∑ LLM –Ω–µ —É–¥–∞–ª—Å—è.
    
    Args:
        segment_results: –°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        
    Returns:
        –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
    """
    logger.warning("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
    
    # –°–æ–±–∏—Ä–∞–µ–º speaker_mapping –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    combined_speaker_mapping = {}
    combined_confidence_scores = {}
    all_unmapped_speakers = set()
    
    segments_with_mappings = 0
    
    for segment in segment_results:
        if 'speaker_mapping' in segment and segment['speaker_mapping']:
            segments_with_mappings += 1
            
            for speaker_id, name in segment['speaker_mapping'].items():
                if speaker_id not in combined_speaker_mapping:
                    combined_speaker_mapping[speaker_id] = name
                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º confidence
                    combined_confidence_scores[speaker_id] = 0.0
                elif len(name) > len(combined_speaker_mapping[speaker_id]):
                    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É
                    combined_speaker_mapping[speaker_id] = name
            
            # –°–æ–±–∏—Ä–∞–µ–º confidence_scores
            if 'confidence_scores' in segment and segment['confidence_scores']:
                for speaker_id, confidence in segment['confidence_scores'].items():
                    # –ë–µ—Ä–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é confidence –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
                    if speaker_id in combined_confidence_scores:
                        combined_confidence_scores[speaker_id] = max(
                            combined_confidence_scores[speaker_id], 
                            confidence
                        )
                    else:
                        combined_confidence_scores[speaker_id] = confidence
        
        # –°–æ–±–∏—Ä–∞–µ–º unmapped_speakers
        if 'unmapped_speakers' in segment and segment['unmapped_speakers']:
            all_unmapped_speakers.update(segment['unmapped_speakers'])
    
    # –ò—Å–∫–ª—é—á–∞–µ–º –∏–∑ unmapped —Ç–µ—Ö, –∫—Ç–æ –µ—Å—Ç—å –≤ –º–∞–ø–ø–∏–Ω–≥–µ
    final_unmapped_speakers = list(all_unmapped_speakers - set(combined_speaker_mapping.keys()))
    
    if combined_speaker_mapping:
        logger.info(f"–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π speaker_mapping: {combined_speaker_mapping}")
    
    if combined_confidence_scores:
        logger.info(f"–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ confidence scores: {combined_confidence_scores}")
    
    if final_unmapped_speakers:
        logger.warning(f"Unmapped speakers (fallback): {final_unmapped_speakers}")
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º aggregation notes
    aggregation_notes = f"Fallback –∞–≥—Ä–µ–≥–∞—Ü–∏—è: –º–∞–ø–ø–∏–Ω–≥–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ {segments_with_mappings} –∏–∑ {len(segment_results)} —Å–µ–≥–º–µ–Ω—Ç–æ–≤."
    if combined_speaker_mapping:
        low_confidence = [f"{sid} ({conf:.2f})" for sid, conf in combined_confidence_scores.items() if conf < 0.7]
        if low_confidence:
            aggregation_notes += f" –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {', '.join(low_confidence)}."
    if final_unmapped_speakers:
        aggregation_notes += f" –ù–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã: {', '.join(final_unmapped_speakers)}."
    
    logger.debug(f"Aggregation notes (fallback): {aggregation_notes}")
    
    merged = {}
    
    for key in template_variables.keys():
        # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        values = []
        for segment in segment_results:
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ segment_data
            segment_data = segment.get('segment_data', segment)  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
            if key in segment_data and segment_data[key]:
                value = segment_data[key].strip()
                # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏
                if value and value != "–ù–µ —É–∫–∞–∑–∞–Ω–æ" and value != "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö" and "–û—à–∏–±–∫–∞" not in value and value != "–ù–µ—Ç –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ":
                    values.append(value)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        if values:
            # –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã, —Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ—Ä—è–¥–æ–∫
            seen = set()
            unique_values = []
            for v in values:
                # –î–ª—è —Å–ø–∏—Å–∫–æ–≤ (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å "- ") —Ä–∞–∑–±–∏—Ä–∞–µ–º –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã
                if v.startswith("- ") or v.startswith("‚Ä¢ "):
                    items = [line.strip() for line in v.split('\n') if line.strip()]
                    for item in items:
                        if item not in seen:
                            seen.add(item)
                            unique_values.append(item)
                else:
                    if v not in seen:
                        seen.add(v)
                        unique_values.append(v)
            
            merged[key] = "\n".join(unique_values) if unique_values else "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
        else:
            merged[key] = "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
    
    # –ó–∞–º–µ–Ω—è–µ–º SPEAKER_N –Ω–∞ –∏–º–µ–Ω–∞ –∏–∑ –º–∞–ø–ø–∏–Ω–≥–∞
    if combined_speaker_mapping:
        for key, value in merged.items():
            if isinstance(value, str):
                for speaker_id, name in combined_speaker_mapping.items():
                    value = value.replace(speaker_id, name)
                merged[key] = value
    
    return merged


async def generate_protocol_chain_of_thought(
    manager: 'LLMManager',
    provider_name: str,
    transcription: str,
    template_variables: Dict[str, str],
    segments: List['TranscriptionSegment'],
    diarization_data: Optional[Dict[str, Any]] = None,
    diarization_analysis: Optional[Dict[str, Any]] = None,
    meeting_structure = None,  # MeetingStructure
    **kwargs
) -> Dict[str, Any]:
    """
    Chain-of-Thought –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á
    
    –≠—Ç–∞–ø—ã:
    1. –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
    2. –°–∏–Ω—Ç–µ–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
    
    Args:
        manager: –ú–µ–Ω–µ–¥–∂–µ—Ä LLM
        provider_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
        transcription: –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        template_variables: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω–∞
        segments: –°–ø–∏—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
        diarization_data: –î–∞–Ω–Ω—ã–µ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        diarization_analysis: –ê–Ω–∞–ª–∏–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
        **kwargs: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        
    Returns:
        –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
    """
    logger.info(f"–ù–∞—á–∞–ª–æ Chain-of-Thought –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª—è {len(segments)} —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
    speaker_mapping = kwargs.get('speaker_mapping')
    participants = kwargs.get('participants')
    meeting_topic = kwargs.get('meeting_topic')
    meeting_date = kwargs.get('meeting_date')
    meeting_time = kwargs.get('meeting_time')
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (—Å —É—á–µ—Ç–æ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)
    system_prompt = _build_system_prompt(transcription, diarization_analysis)
    
    segment_results = []
    
    # –≠–¢–ê–ü 1: –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
    logger.info("–≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
    
    if provider_name == "openai":
        provider = manager.providers[provider_name]
        openai_model_key = kwargs.get("openai_model_key")
        
        # –í—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –º–æ–¥–µ–ª–∏
        selected_model = settings.openai_model
        selected_base_url = settings.openai_base_url or "https://api.openai.com/v1"
        
        if openai_model_key:
            try:
                preset = next((p for p in settings.openai_models if p.key == openai_model_key), None)
                if preset:
                    selected_model = preset.model
                    if getattr(preset, 'base_url', None):
                        selected_base_url = preset.base_url
            except Exception:
                pass
        
        # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ base_url
        client = provider.client
        if client is None or (selected_base_url and getattr(client, 'base_url', None) != selected_base_url):
            client = openai.OpenAI(
                api_key=settings.openai_api_key,
                base_url=selected_base_url,
                http_client=provider.http_client
            )
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º extra_headers –¥–ª—è –∞—Ç—Ä–∏–±—É—Ü–∏–∏
        extra_headers = {}
        if settings.http_referer:
            extra_headers["HTTP-Referer"] = settings.http_referer
        if settings.x_title:
            extra_headers["X-Title"] = settings.x_title
        
        # –°–æ–∑–¥–∞–µ–º retry manager –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        retry_manager = RetryManager(LLM_RETRY_CONFIG)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞
        max_parallel = settings.max_parallel_segments
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π retry-–ª–æ–≥–∏–∫–æ–π
        if max_parallel:
            logger.info(
                f"–ó–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ {len(segments)} —Å–µ–≥–º–µ–Ω—Ç–æ–≤ "
                f"(–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: {max_parallel} –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π retry-–ª–æ–≥–∏–∫–æ–π"
            )
            semaphore = asyncio.Semaphore(max_parallel)
            
            async def _process_with_semaphore(segment):
                async with semaphore:
                    return await _process_single_segment_with_adaptive_retry(
                        segment=segment,
                        segment_idx=segment.segment_id,
                        total_segments=len(segments),
                        client=client,
                        selected_model=selected_model,
                        system_prompt=system_prompt,
                        template_variables=template_variables,
                        extra_headers=extra_headers,
                        speaker_mapping=speaker_mapping,
                        participants=participants
                    )
            
            tasks = [_process_with_semaphore(segment) for segment in segments]
        else:
            logger.info(f"–ó–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ {len(segments)} —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π) —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π retry-–ª–æ–≥–∏–∫–æ–π")
            
            tasks = [
                _process_single_segment_with_adaptive_retry(
                    segment=segment,
                    segment_idx=segment.segment_id,
                    total_segments=len(segments),
                    client=client,
                    selected_model=selected_model,
                    system_prompt=system_prompt,
                    template_variables=template_variables,
                    extra_headers=extra_headers,
                    speaker_mapping=speaker_mapping,
                    participants=participants
                )
                for segment in segments
            ]
        
        # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        results = await asyncio.gather(*tasks, return_exceptions=True)
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        successful_count = 0
        failed_count = 0
        partial_success_count = 0
        
        logger.info(f"–ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ {len(results)} —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
        
        # –°–æ–±–∏—Ä–∞–µ–º speaker_mapping –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        segment_mappings = []
        for i, result in enumerate(results):
            if not isinstance(result, Exception):
                segment_id, data = result
                if 'speaker_mapping' in data and data['speaker_mapping']:
                    segment_mappings.append(f"–°–µ–≥–º–µ–Ω—Ç {segment_id+1}: {data['speaker_mapping']}")
        
        if segment_mappings:
            logger.info(f"–ù–∞–π–¥–µ–Ω—ã speaker_mapping –≤ {len(segment_mappings)} —Å–µ–≥–º–µ–Ω—Ç–∞—Ö")
            logger.debug(f"Speaker mappings:\n" + "\n".join(segment_mappings))
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∏–Ω–¥–µ–∫—Å—É —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞
        for i, result in enumerate(results):
            if isinstance(result, Exception):
                # –ï—Å–ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤ - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–µ–º
                if isinstance(result, LLMInsufficientCreditsError):
                    logger.error(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ {i+1}, –ø—Ä–µ—Ä—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É")
                    raise result
                
                failed_count += 1
                logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–µ–≥–º–µ–Ω—Ç–∞ {i+1}: {result}")
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                error_result = {
                    'segment_data': {key: "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞" for key in template_variables.keys()},
                    'speaker_mapping': {},
                    'segment_confidence': 0.0
                }
                segment_results.append(error_result)
                
            else:
                segment_id, data = result
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                segment_data = data.get('segment_data', data)  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
                valid_fields = sum(1 for v in segment_data.values() if v and v not in ["–ù–µ —É–∫–∞–∑–∞–Ω–æ", "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞", "–ù–µ—Ç –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ"])
                total_fields = len(template_variables)
                
                if valid_fields == total_fields:
                    successful_count += 1
                    logger.debug(f"–°–µ–≥–º–µ–Ω—Ç {segment_id + 1}: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ({valid_fields}/{total_fields} –ø–æ–ª–µ–π)")
                elif valid_fields > 0:
                    partial_success_count += 1
                    logger.info(f"–°–µ–≥–º–µ–Ω—Ç {segment_id + 1}: –ß–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ({valid_fields}/{total_fields} –ø–æ–ª–µ–π)")
                else:
                    failed_count += 1
                    logger.warning(f"–°–µ–≥–º–µ–Ω—Ç {segment_id + 1}: –ù–µ—É–¥–∞—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (0/{total_fields} –ø–æ–ª–µ–π)")
                
                segment_results.append(data)
        
        # –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
        logger.info(
            f"–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: "
            f"–ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å–ø–µ—à–Ω–æ {successful_count}/{len(segments)}, "
            f"—á–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω–æ {partial_success_count}/{len(segments)}, "
            f"–Ω–µ—É–¥–∞—á–Ω–æ {failed_count}/{len(segments)}"
        )
        
        # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
        if failed_count > len(segments) * 0.5:  # –ë–æ–ª–µ–µ 50% –Ω–µ—É–¥–∞—á–Ω—ã—Ö
            logger.warning(f"–í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤: {failed_count}/{len(segments)} ({failed_count/len(segments)*100:.1f}%)")
        elif partial_success_count > 0:
            logger.info(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è {partial_success_count} —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
        
        # –≠–¢–ê–ü 2: –°–∏–Ω—Ç–µ–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫
        logger.info("–≠—Ç–∞–ø 2: –°–∏–Ω—Ç–µ–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
        
        try:
            synthesis_prompt = _build_synthesis_prompt(
                segment_results=segment_results,
                transcription=transcription,
                template_variables=template_variables,
                diarization_analysis=diarization_analysis,
                participants=participants,
                meeting_topic=meeting_topic,
                meeting_date=meeting_date,
                meeting_time=meeting_time
            )
            
            # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–∏–Ω—Ç–µ–∑–∞
            if settings.llm_debug_log:
                logger.debug("=" * 80)
                logger.debug(f"[DEBUG] OpenAI REQUEST - Chain-of-Thought Synthesis ({len(segment_results)} segments)")
                logger.debug("=" * 80)
                logger.debug(f"Synthesis prompt:\n{synthesis_prompt}")
                logger.debug("=" * 80)
            
            async def _call_openai_synthesis():
                return await asyncio.to_thread(
                    client.chat.completions.create,
                    model=selected_model,
                    messages=[
                        {"role": "system", "content": system_prompt},
                        {"role": "user", "content": synthesis_prompt}
                    ],
                    temperature=0.1,
                    response_format={"type": "json_schema", "json_schema": SYNTHESIS_SCHEMA},
                    extra_headers=extra_headers
                )
            
            try:
                response_synthesis = await _call_openai_synthesis()
            except openai.APIStatusError as e:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫—É 402 - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
                if e.status_code == 402:
                    error_message = e.message
                    # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞
                    if hasattr(e, 'response') and e.response:
                        try:
                            error_body = e.response.json()
                            if 'error' in error_body and 'message' in error_body['error']:
                                error_message = error_body['error']['message']
                        except:
                            pass
                    logger.error(f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è LLM (—Å–∏–Ω—Ç–µ–∑): {error_message}")
                    raise LLMInsufficientCreditsError(
                        message=error_message,
                        provider="openai",
                        model=selected_model
                    )
                # –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ API –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–ª—å—à–µ
                raise
            
            content_synthesis = response_synthesis.choices[0].message.content
            
            # DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å–∏–Ω—Ç–µ–∑–∞
            if settings.llm_debug_log:
                logger.debug("=" * 80)
                logger.debug("[DEBUG] OpenAI RESPONSE - Chain-of-Thought Synthesis")
                logger.debug("=" * 80)
                if hasattr(response_synthesis, 'usage'):
                    logger.debug(f"Usage: {response_synthesis.usage}")
                logger.debug(f"Content:\n{content_synthesis}")
                logger.debug("=" * 80)
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç
            if not content_synthesis or not content_synthesis.strip():
                logger.error("–ü–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç LLM –Ω–∞ —ç—Ç–∞–ø–µ —Å–∏–Ω—Ç–µ–∑–∞")
                logger.warning("–ò—Å–ø–æ–ª—å–∑—É–µ–º fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
                return _merge_segment_results_fallback(segment_results, template_variables)
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ JSON
            if '{' not in content_synthesis or '}' not in content_synthesis:
                logger.error(f"–û—Ç–≤–µ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –î–ª–∏–Ω–∞: {len(content_synthesis)}, –Ω–∞—á–∞–ª–æ: {content_synthesis[:200]}")
                logger.warning("–ò—Å–ø–æ–ª—å–∑—É–µ–º fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
                return _merge_segment_results_fallback(segment_results, template_variables)
            
            # –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞: –ø—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥
            try:
                final_protocol = json.loads(content_synthesis)
                logger.info("Chain-of-Thought –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ (–ø—Ä—è–º–æ–π –ø–∞—Ä—Å–∏–Ω–≥)")
                
                # –ò–∑–≤–ª–µ–∫–∞–µ–º synthesized_content –∏ final_speaker_mapping
                synthesized_content = final_protocol.get('synthesized_content', final_protocol)
                final_speaker_mapping = final_protocol.get('final_speaker_mapping', {})
                
                # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                final_confidence_scores = final_protocol.get('final_confidence_scores', {})
                final_unmapped_speakers = final_protocol.get('final_unmapped_speakers', [])
                aggregation_notes = final_protocol.get('aggregation_notes', '')
                
                if final_speaker_mapping:
                    logger.info(f"–ò—Ç–æ–≥–æ–≤—ã–π speaker_mapping: {final_speaker_mapping}")
                
                if final_confidence_scores:
                    logger.info(f"Confidence scores: {final_confidence_scores}")
                
                if final_unmapped_speakers:
                    logger.warning(f"Unmapped speakers: {final_unmapped_speakers}")
                
                if aggregation_notes:
                    logger.debug(f"Aggregation notes: {aggregation_notes}")
                
                # –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                if not isinstance(synthesized_content, dict):
                    logger.warning("–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏–Ω—Ç–µ–∑–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback")
                    return _merge_segment_results_fallback(segment_results, template_variables)
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–ª—é—á–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
                for key in template_variables.keys():
                    if key not in synthesized_content:
                        synthesized_content[key] = "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
                
                return synthesized_content
                
            except json.JSONDecodeError as e:
                logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä—è–º–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –Ω–∞ —ç—Ç–∞–ø–µ —Å–∏–Ω—Ç–µ–∑–∞: {e}")
                logger.debug(f"–ü–æ–∑–∏—Ü–∏—è –æ—à–∏–±–∫–∏: line {e.lineno}, column {e.colno}, char {e.pos}")
                
                # –í—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ JSON –∏–∑ —Ç–µ–∫—Å—Ç–∞
                start_idx = content_synthesis.find('{')
                end_idx = content_synthesis.rfind('}') + 1
                
                if start_idx != -1 and end_idx > start_idx:
                    json_str = content_synthesis[start_idx:end_idx]
                    logger.debug(f"–ü—ã—Ç–∞–µ–º—Å—è –∏–∑–≤–ª–µ—á—å JSON –∏–∑ —Ç–µ–∫—Å—Ç–∞: –¥–ª–∏–Ω–∞ {len(json_str)}, –Ω–∞—á–∞–ª–æ: {json_str[:100]}")
                    
                    try:
                        final_protocol = json.loads(json_str)
                        logger.info("Chain-of-Thought –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞)")
                        
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º synthesized_content –∏ final_speaker_mapping
                        synthesized_content = final_protocol.get('synthesized_content', final_protocol)
                        final_speaker_mapping = final_protocol.get('final_speaker_mapping', {})
                        
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                        final_confidence_scores = final_protocol.get('final_confidence_scores', {})
                        final_unmapped_speakers = final_protocol.get('final_unmapped_speakers', [])
                        aggregation_notes = final_protocol.get('aggregation_notes', '')
                        
                        if final_speaker_mapping:
                            logger.info(f"–ò—Ç–æ–≥–æ–≤—ã–π speaker_mapping (–∏–∑ —Ç–µ–∫—Å—Ç–∞): {final_speaker_mapping}")
                        
                        if final_confidence_scores:
                            logger.info(f"Confidence scores (–∏–∑ —Ç–µ–∫—Å—Ç–∞): {final_confidence_scores}")
                        
                        if final_unmapped_speakers:
                            logger.warning(f"Unmapped speakers (–∏–∑ —Ç–µ–∫—Å—Ç–∞): {final_unmapped_speakers}")
                        
                        if aggregation_notes:
                            logger.debug(f"Aggregation notes (–∏–∑ —Ç–µ–∫—Å—Ç–∞): {aggregation_notes}")
                        
                        # –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                        if not isinstance(synthesized_content, dict):
                            logger.warning("–ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback")
                            return _merge_segment_results_fallback(segment_results, template_variables)
                        
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–ª—é—á–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
                        for key in template_variables.keys():
                            if key not in synthesized_content:
                                synthesized_content[key] = "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
                        
                        return synthesized_content
                        
                    except json.JSONDecodeError as e2:
                        logger.error(f"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ JSON: {e2}")
                        logger.error(f"–ü–æ–∑–∏—Ü–∏—è –æ—à–∏–±–∫–∏: line {e2.lineno}, column {e2.colno}, char {e2.pos}")
                        logger.error(f"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞ (–ø–µ—Ä–≤—ã–µ 1000 —Å–∏–º–≤–æ–ª–æ–≤):\n{content_synthesis[:1000]}")
                        logger.error(f"–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 500 —Å–∏–º–≤–æ–ª–æ–≤):\n{content_synthesis[-500:]}")
                else:
                    logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã JSON –≤ –æ—Ç–≤–µ—Ç–µ")
                    logger.error(f"–ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç–≤–µ—Ç–∞:\n{content_synthesis}")
                
                # Fallback: –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –Ω–∞–ø—Ä—è–º—É—é
                logger.warning("–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –Ω–µ —É–¥–∞–ª–∏—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—é")
                return _merge_segment_results_fallback(segment_results, template_variables)
        
        except Exception as e:
            # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞: –ª—é–±–∞—è –æ—à–∏–±–∫–∞ –≤ —Å–∏–Ω—Ç–µ–∑–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ fallback
            logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ —Å–∏–Ω—Ç–µ–∑–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: {e}")
            logger.error(f"–¢–∏–ø –æ—à–∏–±–∫–∏: {type(e).__name__}")
            logger.warning("–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤")
            
            # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–∞–ª–∏–¥–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            try:
                fallback_result = _merge_segment_results_fallback(segment_results, template_variables)
                logger.info("Fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
                return fallback_result
            except Exception as fallback_error:
                logger.error(f"–û—à–∏–±–∫–∞ –¥–∞–∂–µ –≤ fallback-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: {fallback_error}")
                # –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑–µ—Ä–≤ - —Å–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                emergency_result = {key: "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏" for key in template_variables.keys()}
                logger.warning("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç")
                return emergency_result
    
    else:
        # –î–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥
        logger.warning(
            f"Chain-of-Thought –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è {provider_name}, "
            f"–∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥"
        )
        # –ü–µ—Ä–µ–¥–∞–µ–º meeting_structure —á–µ—Ä–µ–∑ kwargs
        if meeting_structure:
            kwargs['meeting_structure'] = meeting_structure
        return await manager.generate_protocol(
            provider_name, transcription, template_variables, diarization_data, **kwargs
        )


# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞ LLM
llm_manager = LLMManager()
