# üèóÔ∏è –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—Å—Ç—Ä–µ—á–∏ (Speaker Mapping)

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 8 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ)  
**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏**: `src/services/optimized_processing_service.py`, `src/services/speaker_mapping_service.py`, `src/services/participants_service.py`, `src/utils/text_processing.py`

## üìå –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–µ–π—á–∞—Å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —É –∑–∞–ø—Ä–æ—Å–∞ –µ—Å—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ —Ä–∞–∑–º–µ—Ç–∫—É —Å–ø–∏–∫–µ—Ä–æ–≤.
- `SpeakerMappingService` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ OpenAI Chat Completion (JSON-—Ä–µ–∂–∏–º) –∏ –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.
- –û—Ç–≤–µ—Ç LLM –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ –Ω–∞–±–æ—Ä—É –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–º–µ–Ω –∏ –ø–æ –¥–≤—É–º –ø–æ—Ä–æ–≥–∞–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (0.7 –∏ 0.5).
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `ProcessingRequest`, –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –∏—Ç–æ–≥–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã –≤–º–µ—Å—Ç–æ `SPEAKER_N`/`–°–ø–∏–∫–µ—Ä N`.

## üîÑ –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç–µ–∫—Å—Ç–æ–º, —Ñ–∞–π–ª–æ–º –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —à–∞–≥. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `src/handlers/participants_handlers.py` –≤—ã–∑—ã–≤–∞—é—Ç `ParticipantsService`.
2. `ParticipantsService` –ø–∞—Ä—Å–∏—Ç –≤—Ö–æ–¥, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –µ–≥–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ `MeetingInfoService.extract_meeting_info` (–µ—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–∏—Å—å –ø–æ–ª—è –ø–∏—Å—å–º–∞) –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é (`validate_participants`).
3. –ü–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ `OptimizedProcessingService._optimized_transcription` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `diarization`. –ï—Å–ª–∏ –∏ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∏ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `speaker_mapping_service.map_speakers_to_participants`.
4. `SpeakerMappingService` –≥–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–∞–∂–¥–æ–º —Å–ø–∏–∫–µ—Ä–µ, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –∏ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ LLM.
5. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `speaker_mapping` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç—á–µ—Ç–∞.
6. `replace_speakers_in_text` –∑–∞–º–µ–Ω—è–µ—Ç –º–∞—Ä–∫–µ—Ä—ã —Å–ø–∏–∫–µ—Ä–æ–≤ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ, –∞ `message_builder` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π.

## üë• –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

- **–¢–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥**: `parse_participants_text` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã `–ò–º—è –§–∞–º–∏–ª–∏—è`, `–ò–º—è –§–∞–º–∏–ª–∏—è, —Ä–æ–ª—å`, `–ò–º—è –§–∞–º–∏–ª–∏—è - —Ä–æ–ª—å`, `–ò–º—è –§–∞–º–∏–ª–∏—è (—Ä–æ–ª—å)` –∏ –æ—á–∏—â–∞–µ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å–ø–∏—Å–∫–æ–≤.
- **–§–∞–π–ª—ã**: –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è `.txt` –∏ `.csv` (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è `,` –∏–ª–∏ `;`). –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —á–∏—Ç–∞—é—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç.
- **–ê–≤—Ç–æ–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞**: `extract_from_meeting_text` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `MeetingInfoService` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ email-—à–∞–ø–æ–∫ (`–û—Ç`, `–ö–æ–º—É`, `–ö–æ–ø–∏—è`, `–¢–µ–º–∞`, `–ö–æ–≥–¥–∞`) –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –§–ò–û —Å —Ä—É—á–Ω—ã–º —Å–ø–∏—Å–∫–æ–º.
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–µ–ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ, –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –ª–∏–º–∏—Ç `max_participants = 20`, –∑–∞–ø—Ä–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–º–µ–Ω –∏ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –≤–≤–æ–¥.
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω**: `convert_full_name_to_short` –ø—Ä–∏–≤–æ–¥–∏—Ç `–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ` –∫ `–ò–º—è –§–∞–º–∏–ª–∏—è`, `generate_name_variants` —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–±–æ—Ä –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–∏–º—è, —Ñ–∞–º–∏–ª–∏—è, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏, —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é `—ë ‚Üí –µ` –∏ –æ—á–∏—Å—Ç–∫—É –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏).

## üéß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏

- –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `transcription_result.diarization` —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - `speakers` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ (`SPEAKER_1`, `SPEAKER_2`, ...),
  - `segments` ‚Äî —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Å `speaker`, `start`, `end`, `text`,
  - `formatted_transcript` ‚Äî —Ç–µ–∫—Å—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ `SPEAKER_N:`.
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (`None` –∏–ª–∏ –ø—É—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏) –ª–æ–≥ `"‚ö†Ô∏è Speaker mapping –ø—Ä–æ–ø—É—â–µ–Ω: –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞"` –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –æ—Å—Ç–∞–µ—Ç—Å—è —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å–ø–∏–∫–µ—Ä–æ–≤.

## ü§ñ –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ LLM

- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è —Å–ø–∏—Å–∫–æ–º `- –ò–º—è –§–∞–º–∏–ª–∏—è (—Ä–æ–ª—å)`; –¥–ª—è —Ä–æ–ª–∏ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è (`_get_role_behavior_hint`).
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏–∫–µ—Ä–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è:
  - —á–∏—Å–ª–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤,
  - —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ—á–∏,
  - –¥–æ –ø—è—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ –∑–∞–ø–∏—Å–∏ (–∫–∞–∂–¥—ã–π ‚â§300 —Å–∏–º–≤–æ–ª–æ–≤). –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω `full_text_matching`, –æ–±—Ä–∞–∑—Ü—ã –Ω–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç.
- –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ª–∏–±–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é (–¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π), –ª–∏–±–æ –∫–∞–∫ –ø—Ä–µ–≤—å—é –Ω–∞—á–∞–ª–æ/—Å–µ—Ä–µ–¥–∏–Ω–∞/–∫–æ–Ω–µ—Ü (`_get_transcript_preview`).
- –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç LLM –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å **—Å—Ç—Ä–æ–≥–æ JSON** —Å –ø–æ–ª—è–º–∏ `SPEAKER_X`, `confidence`, `reasoning` –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω—ã–µ, —Ñ–∞–º–∏–ª–∏–∏, —Å—Ç–∏–ª—å —Ä–µ—á–∏).
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä `openai`: –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º –≤ –ª–æ–≥–∞—Ö.

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞

1. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `participants_service.build_name_lookup`, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–æ–∏—Ç —Å–ª–æ–≤–∞—Ä—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ -> {index, display_name, original_name} –∏ –ø–æ–º–µ—á–∞–µ—Ç –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–∫–æ–≥–¥–∞ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–∞–∑–Ω—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º).
2. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ `SPEAKER_X`:
   - –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è `confidence` –∏ `reasoning`;
   - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏–∑ `generate_name_variants` + –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞ LLM.
3. –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–ø–∞–ª –≤ —Å–ø–∏—Å–æ–∫ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö, –æ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.
4. –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –µ—â–µ –Ω–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –ø—Ä–∏ `confidence ‚â• 0.7`.
5. –ó–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ `[0.5, 0.7)` –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Å –∑–∞–ø–∏—Å—å—é –≤ –ª–æ–≥ –æ –ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏; –Ω–∏–∂–µ 0.5 ‚Äî –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è.
6. –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ –æ–¥–∏–Ω —É—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–ø–∏–∫–µ—Ä–∞–º. –ü—Ä–∏–Ω—è—Ç—ã–µ –º–∞–ø–ø–∏–Ω–≥–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º –∏–∑ `reasoning`.

> ‚ö†Ô∏è –ü–æ—Ä–æ–≥ `0.5` –∑–∞—à–∏—Ç –≤ `SpeakerMappingService` –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –∏ –ø–æ–∫–∞ –Ω–µ –≤—ã–Ω–µ—Å–µ–Ω –≤ `config.py`.

## üìù –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª

- `replace_speakers_in_text` –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (`SPEAKER_X`, `–°–ø–∏–∫–µ—Ä X`, —Å –¥–≤–æ–µ—Ç–æ—á–∏–µ–º –∏ –±–µ–∑) –Ω–∞ `–ò–º—è –§–∞–º–∏–ª–∏—è`.
- –ò—Ç–æ–≥–æ–≤—ã–π `speaker_mapping` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `ProcessingRequest` –∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤:
  - –±–ª–æ–∫ `üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏` —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (`src/ux/message_builder.py`),
  - —à–∞–±–ª–æ–Ω –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–µ—Å–ª–∏ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Ä–∫–µ—Ä—ã `{{ participants }}`),
  - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª—é–±–æ–π —Ç–µ–∫—Å—Ç, –≥–¥–µ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–ø–∏–∫–µ—Ä–æ–≤.
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–∫–µ—Ä–æ–≤, –µ—Å–ª–∏ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è —Å—Ä–∞–±–æ—Ç–∞–ª–∞.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
ENABLE_SPEAKER_MAPPING=true                  # –≤–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
SPEAKER_MAPPING_CONFIDENCE_THRESHOLD=0.7     # –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
MAX_PARTICIPANTS=20                          # –ª–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
LLM_DEBUG_LOG=false                          # –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã/–æ—Ç–≤–µ—Ç—ã LLM
FULL_TEXT_MATCHING=false                     # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –≤–º–µ—Å—Ç–æ —Å—ç–º–ø–ª–æ–≤
```

- `FULL_TEXT_MATCHING=true` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞, –Ω–æ –¥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ `speaker_mapping_secondary_confidence_threshold` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∫–æ–π `SpeakerMappingService` (—Å–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤—ã—à–µ).

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞

- `OptimizedProcessingService` –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏: —Å—Ç–∞—Ä—Ç/–ø—Ä–æ–ø—É—Å–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –ø–µ—Ä–≤—ã–µ –ø—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä `speaker_mapping` –∏–ª–∏ –ø—Ä–∏—á–∏–Ω—É —Å–±–æ—è.
- `llm_debug_log=true` –≤–∫–ª—é—á–∞–µ—Ç dump –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –≤ DEBUG-–ª–æ–≥ (`loguru`), –ø–æ–º–æ–≥–∞–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ JSON.
- –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ ERROR –∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É: –ø—Ä–æ—Ç–æ–∫–æ–ª —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
- –î–ª—è –ø—Ä–æ–±–ª–µ–º —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤ `cache/` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM.

## üö´ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç

- –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∫—Ä–æ–º–µ OpenAI.
- –ë–µ–∑ –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å `speaker_mapping`.
- –ï—Å–ª–∏ –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ—Ñ–∞–º–∏–ª—å—Ü–µ–≤/–æ–¥–Ω–æ–∏–º–µ–Ω—Ü–µ–≤ –±–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–æ–ª–µ–π, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ.
- –ü—Ä–∏ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è—Ö (>> 5000 —Å–∏–º–≤–æ–ª–æ–≤) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∂–∞—Ç–æ–µ –ø—Ä–µ–≤—å—é; –¥–µ—Ç–∞–ª—å–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Ç–µ—Ä—è–Ω—ã –±–µ–∑ `FULL_TEXT_MATCHING=true`.

## üìÑ –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ LLM

```json
{
  "SPEAKER_1": "–ê–ª–µ–∫—Å–µ–π –¢–∏–º—á–µ–Ω–∫–æ",
  "SPEAKER_2": "–°–æ—Ñ—å—è –û—Å–∏–ø–æ–≤–∞",
  "confidence": {
    "SPEAKER_1": 0.92,
    "SPEAKER_2": 0.78
  },
  "reasoning": {
    "SPEAKER_1": "–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º, –≤–µ–¥–µ—Ç –≤—Å—Ç—Ä–µ—á—É, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–æ–ª–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –ø—Ä–æ–µ–∫—Ç–∞",
    "SPEAKER_2": "–ö –Ω–µ–π –æ–±—Ä–∞—â–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏, –¥–æ–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ –∑–∞–¥–∞—á–∞—Ö –ø–æ—Å—Ç–∞–≤–∫–∏ ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–æ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Ü–µ–ø–∏ –ø–æ—Å—Ç–∞–≤–æ–∫"
  }
}
```

–ï—Å–ª–∏ `confidence` —É–π–¥–µ—Ç –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–æ–≤, `SpeakerMappingService` –æ—Ç–±—Ä–æ—Å–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–∞—Ä—É, –∞ –º–µ—Ç–∫–∞ `SPEAKER_X` –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ.
